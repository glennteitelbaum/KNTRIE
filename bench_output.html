<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0082,kntrie_int32_erase:0.0029,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0100,kntrie_uint64_erase:0.0040,kntrie_uint64_mem:2056,map_int32_find:0.0036,map_int32_insert:0.0094,map_int32_erase:0.0053,map_int32_mem:4800,map_uint64_find:0.0030,map_uint64_insert:0.0106,map_uint64_erase:0.0060,map_uint64_mem:4800,umap_int32_find:0.0011,umap_int32_insert:0.0030,umap_int32_erase:0.0016,umap_int32_mem:3224,umap_uint64_find:0.0011,umap_uint64_insert:0.0037,umap_uint64_erase:0.0020,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0011,kntrie_int32_insert:0.0121,kntrie_int32_erase:0.0049,kntrie_int32_mem:3080,kntrie_uint64_find:0.0011,kntrie_uint64_insert:0.0118,kntrie_uint64_erase:0.0055,kntrie_uint64_mem:4104,map_int32_find:0.0059,map_int32_insert:0.0147,map_int32_erase:0.0088,map_int32_mem:7200,map_uint64_find:0.0053,map_uint64_insert:0.0161,map_uint64_erase:0.0097,map_uint64_mem:7200,umap_int32_find:0.0019,umap_int32_insert:0.0061,umap_int32_erase:0.0026,umap_int32_mem:4856,umap_uint64_find:0.0017,umap_uint64_insert:0.0059,umap_uint64_erase:0.0034,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0139,kntrie_int32_erase:0.0048,kntrie_int32_mem:3080,kntrie_uint64_find:0.0016,kntrie_uint64_insert:0.0140,kntrie_uint64_erase:0.0057,kntrie_uint64_mem:4104,map_int32_find:0.0097,map_int32_insert:0.0211,map_int32_erase:0.0107,map_int32_mem:10800,map_uint64_find:0.0086,map_uint64_insert:0.0225,map_uint64_erase:0.0109,map_uint64_mem:10800,umap_int32_find:0.0032,umap_int32_insert:0.0080,umap_int32_erase:0.0036,umap_int32_mem:7216,umap_uint64_find:0.0028,umap_uint64_insert:0.0073,umap_uint64_erase:0.0032,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0028,kntrie_int32_insert:0.0224,kntrie_int32_erase:0.0075,kntrie_int32_mem:6152,kntrie_uint64_find:0.0027,kntrie_uint64_insert:0.0234,kntrie_uint64_erase:0.0092,kntrie_uint64_mem:8200,map_int32_find:0.0153,map_int32_insert:0.0334,map_int32_erase:0.0155,map_int32_mem:16176,map_uint64_find:0.0140,map_uint64_insert:0.0347,map_uint64_erase:0.0165,map_uint64_mem:16176,umap_int32_find:0.0041,umap_int32_insert:0.0108,umap_int32_erase:0.0042,umap_int32_mem:10784,umap_uint64_find:0.0039,umap_uint64_insert:0.0110,umap_uint64_erase:0.0048,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0042,kntrie_int32_insert:0.0380,kntrie_int32_erase:0.0108,kntrie_int32_mem:6152,kntrie_uint64_find:0.0042,kntrie_uint64_insert:0.0349,kntrie_uint64_erase:0.0147,kntrie_uint64_mem:8200,map_int32_find:0.0251,map_int32_insert:0.0513,map_int32_erase:0.0254,map_int32_mem:24288,map_uint64_find:0.0238,map_uint64_insert:0.0547,map_uint64_erase:0.0282,map_uint64_mem:24288,umap_int32_find:0.0055,umap_int32_insert:0.0150,umap_int32_erase:0.0062,umap_int32_mem:16472,umap_uint64_find:0.0056,umap_uint64_insert:0.0159,umap_uint64_erase:0.0069,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0072,kntrie_int32_insert:0.0469,kntrie_int32_erase:0.0184,kntrie_int32_mem:12296,kntrie_uint64_find:0.0067,kntrie_uint64_insert:0.0490,kntrie_uint64_erase:0.0216,kntrie_uint64_mem:16392,map_int32_find:0.0400,map_int32_insert:0.0778,map_int32_erase:0.0383,map_int32_mem:36432,map_uint64_find:0.0391,map_uint64_insert:0.0817,map_uint64_erase:0.0417,map_uint64_mem:36432,umap_int32_find:0.0088,umap_int32_insert:0.0220,umap_int32_erase:0.0100,umap_int32_mem:24304,umap_uint64_find:0.0090,umap_uint64_insert:0.0229,umap_uint64_erase:0.0110,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0120,kntrie_int32_insert:0.0744,kntrie_int32_erase:0.0204,kntrie_int32_mem:24584,kntrie_uint64_find:0.0116,kntrie_uint64_insert:0.0770,kntrie_uint64_erase:0.0271,kntrie_uint64_mem:32776,map_int32_find:0.0674,map_int32_insert:0.1168,map_int32_erase:0.0575,map_int32_mem:54672,map_uint64_find:0.0659,map_uint64_insert:0.1201,map_uint64_erase:0.0663,map_uint64_mem:54672,umap_int32_find:0.0129,umap_int32_insert:0.0301,umap_int32_erase:0.0142,umap_int32_mem:36880,umap_uint64_find:0.0132,umap_uint64_insert:0.0305,umap_uint64_erase:0.0142,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0178,kntrie_int32_insert:0.1061,kntrie_int32_erase:0.0349,kntrie_int32_mem:24584,kntrie_uint64_find:0.0173,kntrie_uint64_insert:0.1079,kntrie_uint64_erase:0.0444,kntrie_uint64_mem:32776,map_int32_find:0.1111,map_int32_insert:0.1813,map_int32_erase:0.0902,map_int32_mem:81984,map_uint64_find:0.1101,map_uint64_insert:0.1917,map_uint64_erase:0.1011,map_uint64_mem:81984,umap_int32_find:0.0223,umap_int32_insert:0.0450,umap_int32_erase:0.0217,umap_int32_mem:54920,umap_uint64_find:0.0212,umap_uint64_insert:0.0437,umap_uint64_erase:0.0224,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0310,kntrie_int32_insert:0.1840,kntrie_int32_erase:0.0527,kntrie_int32_mem:49160,kntrie_uint64_find:0.0319,kntrie_uint64_insert:0.1804,kntrie_uint64_erase:0.0688,kntrie_uint64_mem:65544,map_int32_find:0.1871,map_int32_insert:0.2893,map_int32_erase:0.1444,map_int32_mem:122976,map_uint64_find:0.1809,map_uint64_insert:0.2946,map_uint64_erase:0.1575,map_uint64_mem:122976,umap_int32_find:0.0318,umap_int32_insert:0.0648,umap_int32_erase:0.0337,umap_int32_mem:83512,umap_uint64_find:0.0334,umap_uint64_insert:0.0673,umap_uint64_erase:0.0338,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0464,kntrie_int32_insert:0.2741,kntrie_int32_erase:0.0800,kntrie_int32_mem:49160,kntrie_uint64_find:0.0466,kntrie_uint64_insert:0.2868,kntrie_uint64_erase:0.1064,kntrie_uint64_mem:65544,map_int32_find:0.3555,map_int32_insert:0.4640,map_int32_erase:0.2905,map_int32_mem:184512,map_uint64_find:0.2986,map_uint64_insert:0.4624,map_uint64_erase:0.2475,map_uint64_mem:184512,umap_int32_find:0.0559,umap_int32_insert:0.1334,umap_int32_erase:0.0708,umap_int32_mem:124472,umap_uint64_find:0.0519,umap_uint64_insert:0.1022,umap_uint64_erase:0.0539,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0601,kntrie_int32_insert:0.4619,kntrie_int32_erase:1.4685,kntrie_int32_mem:100560,kntrie_uint64_find:0.0938,kntrie_uint64_insert:0.7153,kntrie_uint64_erase:1.7169,kntrie_uint64_mem:131600,map_int32_find:0.4678,map_int32_insert:0.6758,map_int32_erase:0.3613,map_int32_mem:276768,map_uint64_find:0.5687,map_uint64_insert:0.8825,map_uint64_erase:0.4296,map_uint64_mem:276768,umap_int32_find:0.0764,umap_int32_insert:0.1460,umap_int32_erase:0.0785,umap_int32_mem:186008,umap_uint64_find:0.0820,umap_uint64_insert:0.1790,umap_uint64_erase:0.0788,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1266,kntrie_int32_insert:0.6332,kntrie_int32_erase:2.8758,kntrie_int32_mem:157968,kntrie_uint64_find:0.1260,kntrie_uint64_insert:0.6446,kntrie_uint64_erase:2.9488,kntrie_uint64_mem:214544,map_int32_find:0.7827,map_int32_insert:1.0788,map_int32_erase:0.5865,map_int32_mem:415152,map_uint64_find:0.7803,map_uint64_insert:1.1232,map_uint64_erase:0.6117,map_uint64_mem:415152,umap_int32_find:0.1177,umap_int32_insert:0.2258,umap_int32_erase:0.1216,umap_int32_mem:277840,umap_uint64_find:0.1184,umap_uint64_insert:0.2370,umap_uint64_erase:0.1246,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.1567,kntrie_int32_insert:0.8558,kntrie_int32_erase:2.8892,kntrie_int32_mem:207888,kntrie_uint64_find:0.1642,kntrie_uint64_insert:0.8592,kntrie_uint64_erase:2.9771,kntrie_uint64_mem:274960,map_int32_find:1.2978,map_int32_insert:1.7042,map_int32_erase:0.9250,map_int32_mem:622752,map_uint64_find:1.2773,map_uint64_insert:1.7841,map_uint64_erase:0.9674,map_uint64_mem:622752,umap_int32_find:0.1892,umap_int32_insert:0.3603,umap_int32_erase:0.1910,umap_int32_mem:415240,umap_uint64_find:0.1828,umap_uint64_insert:0.3298,umap_uint64_erase:0.1807,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.2859,kntrie_int32_insert:1.2652,kntrie_int32_erase:3.0346,kntrie_int32_mem:380688,kntrie_uint64_find:0.2938,kntrie_uint64_insert:1.2923,kntrie_uint64_erase:3.0894,kntrie_uint64_mem:503824,map_int32_find:2.2553,map_int32_insert:2.7625,map_int32_erase:1.5363,map_int32_mem:934128,map_uint64_find:2.1885,map_uint64_insert:2.8577,map_uint64_erase:1.5622,map_uint64_mem:934128,umap_int32_find:0.2795,umap_int32_insert:0.5069,umap_int32_erase:0.2847,umap_int32_mem:633088,umap_uint64_find:0.2768,umap_uint64_insert:0.5126,umap_uint64_erase:0.2744,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.4493,kntrie_int32_insert:1.9096,kntrie_int32_erase:3.1373,kntrie_int32_mem:444432,kntrie_uint64_find:0.4586,kntrie_uint64_insert:1.9625,kntrie_uint64_erase:3.2114,kntrie_uint64_mem:568336,map_int32_find:3.9692,map_int32_insert:4.4852,map_int32_erase:2.5522,map_int32_mem:1401216,map_uint64_find:4.1604,map_uint64_insert:4.6768,map_uint64_erase:2.7688,map_uint64_mem:1401216,umap_int32_find:0.4230,umap_int32_insert:0.7817,umap_int32_erase:0.4209,umap_int32_mem:946424,umap_uint64_find:0.4389,umap_uint64_insert:0.7644,umap_uint64_erase:0.4349,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:0.7422,kntrie_int32_insert:2.8402,kntrie_int32_erase:3.4672,kntrie_int32_mem:791568,kntrie_uint64_find:0.8094,kntrie_uint64_insert:2.9060,kntrie_uint64_erase:3.5962,kntrie_uint64_mem:1053712,map_int32_find:7.9317,map_int32_insert:7.6415,map_int32_erase:5.0611,map_int32_mem:2101872,map_uint64_find:8.0863,map_uint64_insert:8.0583,map_uint64_erase:5.1701,map_uint64_mem:2101872,umap_int32_find:0.7356,umap_int32_insert:1.2379,umap_int32_erase:0.7933,umap_int32_mem:1414784,umap_uint64_find:0.7337,umap_uint64_insert:1.2593,umap_uint64_erase:0.7628,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.4271,kntrie_int32_insert:4.8182,kntrie_int32_erase:3.8733,kntrie_int32_mem:1163280,kntrie_uint64_find:1.7282,kntrie_uint64_insert:5.0737,kntrie_uint64_erase:4.1515,kntrie_uint64_mem:1573904,map_int32_find:15.7399,map_int32_insert:13.7348,map_int32_erase:8.9942,map_int32_mem:3152832,map_uint64_find:16.3270,map_uint64_insert:13.9718,map_uint64_erase:9.6039,map_uint64_mem:3152832,umap_int32_find:1.3177,umap_int32_insert:2.2959,umap_int32_erase:1.6041,umap_int32_mem:2114872,umap_uint64_find:1.2955,umap_uint64_insert:2.3108,umap_uint64_erase:1.6269,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.1181,kntrie_int32_insert:6.9731,kntrie_int32_erase:5.3202,kntrie_int32_mem:1578000,map_int32_find:27.2115,map_int32_insert:24.6256,map_int32_erase:15.9110,map_int32_mem:4729104,umap_int32_find:2.2506,umap_int32_insert:4.2773,umap_int32_erase:2.9043,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:3.0796,kntrie_uint64_insert:7.3650,kntrie_uint64_erase:6.2844,kntrie_uint64_mem:2102288,map_uint64_find:28.0515,map_uint64_insert:24.1641,map_uint64_erase:16.0189,map_uint64_mem:4729248,umap_uint64_find:2.1639,umap_uint64_insert:4.0598,umap_uint64_erase:2.8640,umap_uint64_mem:3162488},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0080,kntrie_int32_erase:0.0024,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0087,kntrie_uint64_erase:0.0034,kntrie_uint64_mem:2056,map_int32_find:0.0034,map_int32_insert:0.0098,map_int32_erase:0.0047,map_int32_mem:4800,map_uint64_find:0.0030,map_uint64_insert:0.0106,map_uint64_erase:0.0052,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0018,umap_int32_erase:0.0007,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0031,umap_uint64_erase:0.0010,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0010,kntrie_int32_insert:0.0104,kntrie_int32_erase:0.0039,kntrie_int32_mem:3080,kntrie_uint64_find:0.0010,kntrie_uint64_insert:0.0094,kntrie_uint64_erase:0.0046,kntrie_uint64_mem:4104,map_int32_find:0.0057,map_int32_insert:0.0151,map_int32_erase:0.0080,map_int32_mem:7200,map_uint64_find:0.0050,map_uint64_insert:0.0154,map_uint64_erase:0.0077,map_uint64_mem:7200,umap_int32_find:0.0004,umap_int32_insert:0.0048,umap_int32_erase:0.0014,umap_int32_mem:4856,umap_uint64_find:0.0004,umap_uint64_insert:0.0037,umap_uint64_erase:0.0018,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0134,kntrie_int32_erase:0.0055,kntrie_int32_mem:3080,kntrie_uint64_find:0.0015,kntrie_uint64_insert:0.0122,kntrie_uint64_erase:0.0053,kntrie_uint64_mem:4104,map_int32_find:0.0096,map_int32_insert:0.0237,map_int32_erase:0.0106,map_int32_mem:10800,map_uint64_find:0.0082,map_uint64_insert:0.0215,map_uint64_erase:0.0101,map_uint64_mem:10800,umap_int32_find:0.0006,umap_int32_insert:0.0052,umap_int32_erase:0.0013,umap_int32_mem:7216,umap_uint64_find:0.0006,umap_uint64_insert:0.0047,umap_uint64_erase:0.0014,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0026,kntrie_int32_insert:0.0172,kntrie_int32_erase:0.0071,kntrie_int32_mem:6152,kntrie_uint64_find:0.0026,kntrie_uint64_insert:0.0184,kntrie_uint64_erase:0.0082,kntrie_uint64_mem:8200,map_int32_find:0.0144,map_int32_insert:0.0318,map_int32_erase:0.0150,map_int32_mem:16176,map_uint64_find:0.0137,map_uint64_insert:0.0314,map_uint64_erase:0.0155,map_uint64_mem:16176,umap_int32_find:0.0010,umap_int32_insert:0.0069,umap_int32_erase:0.0018,umap_int32_mem:10784,umap_uint64_find:0.0010,umap_uint64_insert:0.0071,umap_uint64_erase:0.0020,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0039,kntrie_int32_insert:0.0305,kntrie_int32_erase:0.0095,kntrie_int32_mem:6152,kntrie_uint64_find:0.0038,kntrie_uint64_insert:0.0312,kntrie_uint64_erase:0.0123,kntrie_uint64_mem:8200,map_int32_find:0.0232,map_int32_insert:0.0507,map_int32_erase:0.0225,map_int32_mem:24288,map_uint64_find:0.0219,map_uint64_insert:0.0499,map_uint64_erase:0.0247,map_uint64_mem:24288,umap_int32_find:0.0015,umap_int32_insert:0.0099,umap_int32_erase:0.0025,umap_int32_mem:16472,umap_uint64_find:0.0014,umap_uint64_insert:0.0098,umap_uint64_erase:0.0032,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0068,kntrie_int32_insert:0.0407,kntrie_int32_erase:0.0171,kntrie_int32_mem:12296,kntrie_uint64_find:0.0064,kntrie_uint64_insert:0.0421,kntrie_uint64_erase:0.0206,kntrie_uint64_mem:16392,map_int32_find:0.0383,map_int32_insert:0.0757,map_int32_erase:0.0358,map_int32_mem:36432,map_uint64_find:0.0366,map_uint64_insert:0.0754,map_uint64_erase:0.0385,map_uint64_mem:36432,umap_int32_find:0.0022,umap_int32_insert:0.0144,umap_int32_erase:0.0039,umap_int32_mem:24304,umap_uint64_find:0.0022,umap_uint64_insert:0.0138,umap_uint64_erase:0.0047,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0114,kntrie_int32_insert:0.0858,kntrie_int32_erase:0.0179,kntrie_int32_mem:24584,kntrie_uint64_find:0.0112,kntrie_uint64_insert:0.0728,kntrie_uint64_erase:0.0242,kntrie_uint64_mem:32776,map_int32_find:0.0636,map_int32_insert:0.1108,map_int32_erase:0.0545,map_int32_mem:54672,map_uint64_find:0.0625,map_uint64_insert:0.1163,map_uint64_erase:0.0596,map_uint64_mem:54672,umap_int32_find:0.0032,umap_int32_insert:0.0202,umap_int32_erase:0.0058,umap_int32_mem:36880,umap_uint64_find:0.0032,umap_uint64_insert:0.0193,umap_uint64_erase:0.0057,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0171,kntrie_int32_insert:0.0909,kntrie_int32_erase:0.0330,kntrie_int32_mem:24584,kntrie_uint64_find:0.0169,kntrie_uint64_insert:0.0914,kntrie_uint64_erase:0.0412,kntrie_uint64_mem:32776,map_int32_find:0.1060,map_int32_insert:0.1791,map_int32_erase:0.0861,map_int32_mem:81984,map_uint64_find:0.1038,map_uint64_insert:0.1821,map_uint64_erase:0.0885,map_uint64_mem:81984,umap_int32_find:0.0047,umap_int32_insert:0.0286,umap_int32_erase:0.0093,umap_int32_mem:54920,umap_uint64_find:0.0047,umap_uint64_insert:0.0282,umap_uint64_erase:0.0093,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0290,kntrie_int32_insert:0.1591,kntrie_int32_erase:0.0468,kntrie_int32_mem:49160,kntrie_uint64_find:0.0297,kntrie_uint64_insert:0.1691,kntrie_uint64_erase:0.0628,kntrie_uint64_mem:65544,map_int32_find:0.1705,map_int32_insert:0.2656,map_int32_erase:0.1357,map_int32_mem:122976,map_uint64_find:0.1692,map_uint64_insert:0.2856,map_uint64_erase:0.1446,map_uint64_mem:122976,umap_int32_find:0.0071,umap_int32_insert:0.0411,umap_int32_erase:0.0147,umap_int32_mem:83512,umap_uint64_find:0.0072,umap_uint64_insert:0.0401,umap_uint64_erase:0.0142,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0429,kntrie_int32_insert:0.2423,kntrie_int32_erase:0.0751,kntrie_int32_mem:49160,kntrie_uint64_find:0.0456,kntrie_uint64_insert:0.2480,kntrie_uint64_erase:0.1003,kntrie_uint64_mem:65544,map_int32_find:0.2804,map_int32_insert:0.4381,map_int32_erase:0.2106,map_int32_mem:184512,map_uint64_find:0.2776,map_uint64_insert:0.4393,map_uint64_erase:0.2301,map_uint64_mem:184512,umap_int32_find:0.0110,umap_int32_insert:0.0610,umap_int32_erase:0.0221,umap_int32_mem:124472,umap_uint64_find:0.0110,umap_uint64_insert:0.0608,umap_uint64_erase:0.0230,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0718,kntrie_int32_insert:0.4787,kntrie_int32_erase:0.2086,kntrie_int32_mem:69888,kntrie_uint64_find:0.1751,kntrie_uint64_insert:0.4746,kntrie_uint64_erase:0.2309,kntrie_uint64_mem:70272,map_int32_find:0.4705,map_int32_insert:0.6965,map_int32_erase:0.3440,map_int32_mem:276768,map_uint64_find:0.4635,map_uint64_insert:0.7078,map_uint64_erase:0.3855,map_uint64_mem:276768,umap_int32_find:0.0168,umap_int32_insert:0.0853,umap_int32_erase:0.0347,umap_int32_mem:186008,umap_uint64_find:0.0168,umap_uint64_insert:0.0836,umap_uint64_erase:0.0365,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.1092,kntrie_int32_insert:0.5301,kntrie_int32_erase:0.4554,kntrie_int32_mem:104464,kntrie_uint64_find:0.2670,kntrie_uint64_insert:0.5481,kntrie_uint64_erase:0.4823,kntrie_uint64_mem:104736,map_int32_find:0.7914,map_int32_insert:1.0707,map_int32_erase:0.5935,map_int32_mem:415152,map_uint64_find:0.7884,map_uint64_insert:1.1307,map_uint64_erase:0.6052,map_uint64_mem:415152,umap_int32_find:0.0247,umap_int32_insert:0.1298,umap_int32_erase:0.0552,umap_int32_mem:277840,umap_uint64_find:0.0253,umap_uint64_insert:0.1271,umap_uint64_erase:0.0547,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.1588,kntrie_int32_insert:0.7249,kntrie_int32_erase:0.6943,kntrie_int32_mem:156736,kntrie_uint64_find:0.3961,kntrie_uint64_insert:0.7584,kntrie_uint64_erase:0.7394,kntrie_uint64_mem:156736,map_int32_find:1.3112,map_int32_insert:1.7051,map_int32_erase:0.9555,map_int32_mem:622752,map_uint64_find:1.2878,map_uint64_insert:1.7550,map_uint64_erase:0.9629,map_uint64_mem:622752,umap_int32_find:0.0376,umap_int32_insert:0.1831,umap_int32_erase:0.0859,umap_int32_mem:415240,umap_uint64_find:0.0366,umap_uint64_insert:0.1868,umap_uint64_erase:0.0818,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.2484,kntrie_int32_insert:1.0060,kntrie_int32_erase:1.0359,kntrie_int32_mem:235568,kntrie_uint64_find:0.6101,kntrie_uint64_insert:1.0137,kntrie_uint64_erase:1.1212,kntrie_uint64_mem:235808,map_int32_find:2.1730,map_int32_insert:2.7416,map_int32_erase:1.4835,map_int32_mem:934128,map_uint64_find:2.1670,map_uint64_insert:2.8906,map_uint64_erase:1.5425,map_uint64_mem:934128,umap_int32_find:0.0547,umap_int32_insert:0.2765,umap_int32_erase:0.1340,umap_int32_mem:633088,umap_uint64_find:0.0550,umap_uint64_insert:0.2793,umap_uint64_erase:0.1246,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.3891,kntrie_int32_insert:1.4471,kntrie_int32_erase:1.6089,kntrie_int32_mem:353696,kntrie_uint64_find:0.9298,kntrie_uint64_insert:1.5351,kntrie_uint64_erase:1.7028,kntrie_uint64_mem:353696,map_int32_find:4.0736,map_int32_insert:4.4095,map_int32_erase:2.6044,map_int32_mem:1401216,map_uint64_find:4.1552,map_uint64_insert:4.6832,map_uint64_erase:2.7409,map_uint64_mem:1401216,umap_int32_find:0.0875,umap_int32_insert:0.4244,umap_int32_erase:0.1962,umap_int32_mem:946424,umap_uint64_find:0.0891,umap_uint64_insert:0.4129,umap_uint64_erase:0.1987,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.6149,kntrie_int32_insert:2.1122,kntrie_int32_erase:2.4701,kntrie_int32_mem:529808,kntrie_uint64_find:1.4350,kntrie_uint64_insert:2.2057,kntrie_uint64_erase:2.6097,kntrie_uint64_mem:530304,map_int32_find:7.9850,map_int32_insert:7.5943,map_int32_erase:4.9414,map_int32_mem:2101872,map_uint64_find:7.9572,map_uint64_insert:7.9565,map_uint64_erase:5.0814,map_uint64_mem:2101872,umap_int32_find:0.1996,umap_int32_insert:0.6309,umap_int32_erase:0.4177,umap_int32_mem:1414784,umap_uint64_find:0.1968,umap_uint64_insert:0.6184,umap_uint64_erase:0.4415,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:0.9530,kntrie_int32_insert:3.6686,kntrie_int32_erase:4.0062,kntrie_int32_mem:796296,kntrie_uint64_find:2.2515,kntrie_uint64_insert:3.8693,kntrie_uint64_erase:4.2026,kntrie_uint64_mem:796584,map_int32_find:15.6914,map_int32_insert:13.4283,map_int32_erase:9.0690,map_int32_mem:3152832,map_uint64_find:14.8782,map_uint64_insert:13.9060,map_uint64_erase:9.2795,map_uint64_mem:3152832,umap_int32_find:0.5042,umap_int32_insert:1.0322,umap_int32_erase:1.0560,umap_int32_mem:2114872,umap_uint64_find:0.4850,umap_uint64_insert:0.9509,umap_uint64_erase:1.0909,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.4594,kntrie_int32_insert:5.5795,kntrie_int32_erase:5.8985,kntrie_int32_mem:1192592,kntrie_uint64_find:3.5204,kntrie_uint64_insert:6.0564,kntrie_uint64_erase:6.2662,kntrie_uint64_mem:1192880,map_int32_find:31.0920,map_int32_insert:25.0986,map_int32_erase:15.9763,map_int32_mem:4729248,map_uint64_find:30.7521,map_uint64_insert:26.0137,map_uint64_erase:17.6729,map_uint64_mem:4729248,umap_int32_find:1.1067,umap_int32_insert:1.9555,umap_int32_erase:2.1280,umap_int32_mem:3162488,umap_uint64_find:1.0866,umap_uint64_insert:1.9021,umap_uint64_erase:2.1350,umap_uint64_mem:3162488},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
