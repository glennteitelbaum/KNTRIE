<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0075,kntrie_int32_erase:0.0028,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0099,kntrie_uint64_erase:0.0047,kntrie_uint64_mem:2056,map_int32_find:0.0033,map_int32_insert:0.0091,map_int32_erase:0.0053,map_int32_mem:4800,map_uint64_find:0.0033,map_uint64_insert:0.0105,map_uint64_erase:0.0060,map_uint64_mem:4800,umap_int32_find:0.0010,umap_int32_insert:0.0030,umap_int32_erase:0.0016,umap_int32_mem:3224,umap_uint64_find:0.0011,umap_uint64_insert:0.0034,umap_uint64_erase:0.0020,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0011,kntrie_int32_insert:0.0125,kntrie_int32_erase:0.0055,kntrie_int32_mem:3080,kntrie_uint64_find:0.0011,kntrie_uint64_insert:0.0110,kntrie_uint64_erase:0.0064,kntrie_uint64_mem:4104,map_int32_find:0.0052,map_int32_insert:0.0149,map_int32_erase:0.0079,map_int32_mem:7200,map_uint64_find:0.0053,map_uint64_insert:0.0167,map_uint64_erase:0.0088,map_uint64_mem:7200,umap_int32_find:0.0018,umap_int32_insert:0.0057,umap_int32_erase:0.0024,umap_int32_mem:4856,umap_uint64_find:0.0016,umap_uint64_insert:0.0057,umap_uint64_erase:0.0030,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0157,kntrie_int32_erase:0.0058,kntrie_int32_mem:3080,kntrie_uint64_find:0.0015,kntrie_uint64_insert:0.0132,kntrie_uint64_erase:0.0054,kntrie_uint64_mem:4104,map_int32_find:0.0087,map_int32_insert:0.0206,map_int32_erase:0.0105,map_int32_mem:10800,map_uint64_find:0.0083,map_uint64_insert:0.0207,map_uint64_erase:0.0102,map_uint64_mem:10800,umap_int32_find:0.0030,umap_int32_insert:0.0076,umap_int32_erase:0.0032,umap_int32_mem:7216,umap_uint64_find:0.0026,umap_uint64_insert:0.0072,umap_uint64_erase:0.0032,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0027,kntrie_int32_insert:0.0224,kntrie_int32_erase:0.0075,kntrie_int32_mem:6152,kntrie_uint64_find:0.0025,kntrie_uint64_insert:0.0226,kntrie_uint64_erase:0.0093,kntrie_uint64_mem:8200,map_int32_find:0.0142,map_int32_insert:0.0310,map_int32_erase:0.0153,map_int32_mem:16176,map_uint64_find:0.0135,map_uint64_insert:0.0311,map_uint64_erase:0.0150,map_uint64_mem:16176,umap_int32_find:0.0039,umap_int32_insert:0.0101,umap_int32_erase:0.0040,umap_int32_mem:10784,umap_uint64_find:0.0036,umap_uint64_insert:0.0107,umap_uint64_erase:0.0045,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0041,kntrie_int32_insert:0.0352,kntrie_int32_erase:0.0127,kntrie_int32_mem:6152,kntrie_uint64_find:0.0038,kntrie_uint64_insert:0.0323,kntrie_uint64_erase:0.0135,kntrie_uint64_mem:8200,map_int32_find:0.0232,map_int32_insert:0.0485,map_int32_erase:0.0253,map_int32_mem:24288,map_uint64_find:0.0229,map_uint64_insert:0.0499,map_uint64_erase:0.0250,map_uint64_mem:24288,umap_int32_find:0.0053,umap_int32_insert:0.0141,umap_int32_erase:0.0063,umap_int32_mem:16472,umap_uint64_find:0.0052,umap_uint64_insert:0.0147,umap_uint64_erase:0.0072,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0068,kntrie_int32_insert:0.0456,kntrie_int32_erase:0.0185,kntrie_int32_mem:12296,kntrie_uint64_find:0.0064,kntrie_uint64_insert:0.0483,kntrie_uint64_erase:0.0217,kntrie_uint64_mem:16392,map_int32_find:0.0364,map_int32_insert:0.0715,map_int32_erase:0.0386,map_int32_mem:36432,map_uint64_find:0.0365,map_uint64_insert:0.0781,map_uint64_erase:0.0375,map_uint64_mem:36432,umap_int32_find:0.0085,umap_int32_insert:0.0209,umap_int32_erase:0.0098,umap_int32_mem:24304,umap_uint64_find:0.0082,umap_uint64_insert:0.0209,umap_uint64_erase:0.0097,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0115,kntrie_int32_insert:0.0709,kntrie_int32_erase:0.0182,kntrie_int32_mem:24584,kntrie_uint64_find:0.0105,kntrie_uint64_insert:0.0721,kntrie_uint64_erase:0.0243,kntrie_uint64_mem:32776,map_int32_find:0.0619,map_int32_insert:0.1109,map_int32_erase:0.0537,map_int32_mem:54672,map_uint64_find:0.0621,map_uint64_insert:0.1116,map_uint64_erase:0.0579,map_uint64_mem:54672,umap_int32_find:0.0121,umap_int32_insert:0.0283,umap_int32_erase:0.0133,umap_int32_mem:36880,umap_uint64_find:0.0123,umap_uint64_insert:0.0277,umap_uint64_erase:0.0129,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0174,kntrie_int32_insert:0.1013,kntrie_int32_erase:0.0329,kntrie_int32_mem:24584,kntrie_uint64_find:0.0163,kntrie_uint64_insert:0.1004,kntrie_uint64_erase:0.0421,kntrie_uint64_mem:32776,map_int32_find:0.1030,map_int32_insert:0.1704,map_int32_erase:0.0877,map_int32_mem:81984,map_uint64_find:0.1042,map_uint64_insert:0.1685,map_uint64_erase:0.0872,map_uint64_mem:81984,umap_int32_find:0.0209,umap_int32_insert:0.0425,umap_int32_erase:0.0211,umap_int32_mem:54920,umap_uint64_find:0.0202,umap_uint64_insert:0.0406,umap_uint64_erase:0.0211,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0292,kntrie_int32_insert:0.1829,kntrie_int32_erase:0.0474,kntrie_int32_mem:49160,kntrie_uint64_find:0.0299,kntrie_uint64_insert:0.1882,kntrie_uint64_erase:0.0651,kntrie_uint64_mem:65544,map_int32_find:0.1711,map_int32_insert:0.2726,map_int32_erase:0.1359,map_int32_mem:122976,map_uint64_find:0.1684,map_uint64_insert:0.2675,map_uint64_erase:0.1367,map_uint64_mem:122976,umap_int32_find:0.0307,umap_int32_insert:0.0604,umap_int32_erase:0.0308,umap_int32_mem:83512,umap_uint64_find:0.0305,umap_uint64_insert:0.0617,umap_uint64_erase:0.0315,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0432,kntrie_int32_insert:0.2916,kntrie_int32_erase:0.0710,kntrie_int32_mem:49160,kntrie_uint64_find:0.0448,kntrie_uint64_insert:0.2746,kntrie_uint64_erase:0.0998,kntrie_uint64_mem:65544,map_int32_find:0.2728,map_int32_insert:0.4118,map_int32_erase:0.2144,map_int32_mem:184512,map_uint64_find:0.2963,map_uint64_insert:0.4326,map_uint64_erase:0.2229,map_uint64_mem:184512,umap_int32_find:0.0486,umap_int32_insert:0.0917,umap_int32_erase:0.0486,umap_int32_mem:124472,umap_uint64_find:0.0496,umap_uint64_insert:0.0928,umap_uint64_erase:0.0504,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0588,kntrie_int32_insert:0.4480,kntrie_int32_erase:1.4754,kntrie_int32_mem:100560,kntrie_uint64_find:0.0617,kntrie_uint64_insert:0.5431,kntrie_uint64_erase:1.4995,kntrie_uint64_mem:131600,map_int32_find:0.4529,map_int32_insert:0.6522,map_int32_erase:0.3561,map_int32_mem:276768,map_uint64_find:0.4491,map_uint64_insert:0.6621,map_uint64_erase:0.3521,map_uint64_mem:276768,umap_int32_find:0.0759,umap_int32_insert:0.1485,umap_int32_erase:0.0757,umap_int32_mem:186008,umap_uint64_find:0.0766,umap_uint64_insert:0.1472,umap_uint64_erase:0.0762,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1278,kntrie_int32_insert:0.6205,kntrie_int32_erase:2.8540,kntrie_int32_mem:157968,kntrie_uint64_find:0.1224,kntrie_uint64_insert:0.6561,kntrie_uint64_erase:2.8916,kntrie_uint64_mem:214544,map_int32_find:0.7785,map_int32_insert:1.0605,map_int32_erase:0.5928,map_int32_mem:415152,map_uint64_find:0.7659,map_uint64_insert:1.0620,map_uint64_erase:0.5607,map_uint64_mem:415152,umap_int32_find:0.1222,umap_int32_insert:0.2316,umap_int32_erase:0.1251,umap_int32_mem:277840,umap_uint64_find:0.1163,umap_uint64_insert:0.2195,umap_uint64_erase:0.1207,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.1631,kntrie_int32_insert:0.9293,kntrie_int32_erase:2.9945,kntrie_int32_mem:207888,kntrie_uint64_find:0.1714,kntrie_uint64_insert:0.9595,kntrie_uint64_erase:3.0981,kntrie_uint64_mem:274960,map_int32_find:1.3427,map_int32_insert:1.7586,map_int32_erase:0.9829,map_int32_mem:622752,map_uint64_find:1.3497,map_uint64_insert:1.7868,map_uint64_erase:0.9835,map_uint64_mem:622752,umap_int32_find:0.2036,umap_int32_insert:0.3660,umap_int32_erase:0.1955,umap_int32_mem:415240,umap_uint64_find:0.1926,umap_uint64_insert:0.3506,umap_uint64_erase:0.1927,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.2917,kntrie_int32_insert:1.2665,kntrie_int32_erase:2.9821,kntrie_int32_mem:380688,kntrie_uint64_find:0.3024,kntrie_uint64_insert:1.3784,kntrie_uint64_erase:3.0332,kntrie_uint64_mem:503824,map_int32_find:2.2461,map_int32_insert:2.7416,map_int32_erase:1.5702,map_int32_mem:934128,map_uint64_find:2.3229,map_uint64_insert:2.8376,map_uint64_erase:1.5826,map_uint64_mem:934128,umap_int32_find:0.2827,umap_int32_insert:0.5320,umap_int32_erase:0.2785,umap_int32_mem:633088,umap_uint64_find:0.2809,umap_uint64_insert:0.5315,umap_uint64_erase:0.2880,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.4302,kntrie_int32_insert:1.8909,kntrie_int32_erase:2.9530,kntrie_int32_mem:444432,kntrie_uint64_find:0.4486,kntrie_uint64_insert:1.9521,kntrie_uint64_erase:3.0202,kntrie_uint64_mem:568336,map_int32_find:4.2997,map_int32_insert:4.4295,map_int32_erase:2.7827,map_int32_mem:1401216,map_uint64_find:4.1176,map_uint64_insert:4.4169,map_uint64_erase:2.5895,map_uint64_mem:1401216,umap_int32_find:0.4311,umap_int32_insert:0.7662,umap_int32_erase:0.4295,umap_int32_mem:946424,umap_uint64_find:0.4256,umap_uint64_insert:0.7742,umap_uint64_erase:0.4197,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:0.7233,kntrie_int32_insert:2.9224,kntrie_int32_erase:3.3353,kntrie_int32_mem:791568,kntrie_uint64_find:0.7784,kntrie_uint64_insert:2.9262,kntrie_uint64_erase:3.3784,kntrie_uint64_mem:1053712,map_int32_find:8.3694,map_int32_insert:8.2992,map_int32_erase:5.1723,map_int32_mem:2101872,map_uint64_find:8.3820,map_uint64_insert:7.6628,map_uint64_erase:5.3109,map_uint64_mem:2101872,umap_int32_find:0.7207,umap_int32_insert:1.3423,umap_int32_erase:0.7770,umap_int32_mem:1414784,umap_uint64_find:0.7251,umap_uint64_insert:1.2853,umap_uint64_erase:0.8808,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.3910,kntrie_int32_insert:4.8354,kntrie_int32_erase:3.6873,kntrie_int32_mem:1163280,kntrie_uint64_find:1.6576,kntrie_uint64_insert:5.0736,kntrie_uint64_erase:3.8968,kntrie_uint64_mem:1573904,map_int32_find:16.9978,map_int32_insert:14.1917,map_int32_erase:9.3465,map_int32_mem:3152832,map_uint64_find:16.8827,map_uint64_insert:13.7720,map_uint64_erase:9.4038,map_uint64_mem:3152832,umap_int32_find:1.3489,umap_int32_insert:2.3140,umap_int32_erase:1.6426,umap_int32_mem:2114872,umap_uint64_find:1.3405,umap_uint64_insert:2.3150,umap_uint64_erase:1.6111,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.1061,kntrie_int32_insert:6.9589,kntrie_int32_erase:5.0840,kntrie_int32_mem:1578000,map_int32_find:29.8678,map_int32_insert:24.7726,map_int32_erase:17.5666,map_int32_mem:4729104,umap_int32_find:2.2873,umap_int32_insert:4.5090,umap_int32_erase:2.9900,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:3.3628,kntrie_uint64_insert:7.8530,kntrie_uint64_erase:6.5173,kntrie_uint64_mem:2102288,map_uint64_find:32.2933,map_uint64_insert:25.3143,map_uint64_erase:18.0115,map_uint64_mem:4729248,umap_uint64_find:2.2576,umap_uint64_insert:4.3106,umap_uint64_erase:2.9837,umap_uint64_mem:3162488},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0080,kntrie_int32_erase:0.0024,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0089,kntrie_uint64_erase:0.0034,kntrie_uint64_mem:2056,map_int32_find:0.0032,map_int32_insert:0.0090,map_int32_erase:0.0048,map_int32_mem:4800,map_uint64_find:0.0032,map_uint64_insert:0.0094,map_uint64_erase:0.0051,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0022,umap_int32_erase:0.0007,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0020,umap_uint64_erase:0.0010,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0011,kntrie_int32_insert:0.0111,kntrie_int32_erase:0.0040,kntrie_int32_mem:3080,kntrie_uint64_find:0.0010,kntrie_uint64_insert:0.0111,kntrie_uint64_erase:0.0048,kntrie_uint64_mem:4104,map_int32_find:0.0055,map_int32_insert:0.0140,map_int32_erase:0.0084,map_int32_mem:7200,map_uint64_find:0.0052,map_uint64_insert:0.0155,map_uint64_erase:0.0072,map_uint64_mem:7200,umap_int32_find:0.0004,umap_int32_insert:0.0039,umap_int32_erase:0.0016,umap_int32_mem:4856,umap_uint64_find:0.0004,umap_uint64_insert:0.0039,umap_uint64_erase:0.0018,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0142,kntrie_int32_erase:0.0045,kntrie_int32_mem:3080,kntrie_uint64_find:0.0015,kntrie_uint64_insert:0.0124,kntrie_uint64_erase:0.0056,kntrie_uint64_mem:4104,map_int32_find:0.0089,map_int32_insert:0.0219,map_int32_erase:0.0104,map_int32_mem:10800,map_uint64_find:0.0086,map_uint64_insert:0.0226,map_uint64_erase:0.0100,map_uint64_mem:10800,umap_int32_find:0.0007,umap_int32_insert:0.0050,umap_int32_erase:0.0013,umap_int32_mem:7216,umap_uint64_find:0.0006,umap_uint64_insert:0.0050,umap_uint64_erase:0.0014,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0027,kntrie_int32_insert:0.0182,kntrie_int32_erase:0.0076,kntrie_int32_mem:6152,kntrie_uint64_find:0.0026,kntrie_uint64_insert:0.0202,kntrie_uint64_erase:0.0092,kntrie_uint64_mem:8200,map_int32_find:0.0142,map_int32_insert:0.0321,map_int32_erase:0.0146,map_int32_mem:16176,map_uint64_find:0.0139,map_uint64_insert:0.0334,map_uint64_erase:0.0155,map_uint64_mem:16176,umap_int32_find:0.0010,umap_int32_insert:0.0070,umap_int32_erase:0.0019,umap_int32_mem:10784,umap_uint64_find:0.0010,umap_uint64_insert:0.0075,umap_uint64_erase:0.0020,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0040,kntrie_int32_insert:0.0317,kntrie_int32_erase:0.0093,kntrie_int32_mem:6152,kntrie_uint64_find:0.0038,kntrie_uint64_insert:0.0324,kntrie_uint64_erase:0.0134,kntrie_uint64_mem:8200,map_int32_find:0.0231,map_int32_insert:0.0492,map_int32_erase:0.0229,map_int32_mem:24288,map_uint64_find:0.0224,map_uint64_insert:0.0512,map_uint64_erase:0.0242,map_uint64_mem:24288,umap_int32_find:0.0015,umap_int32_insert:0.0104,umap_int32_erase:0.0026,umap_int32_mem:16472,umap_uint64_find:0.0015,umap_uint64_insert:0.0100,umap_uint64_erase:0.0033,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0069,kntrie_int32_insert:0.0425,kntrie_int32_erase:0.0177,kntrie_int32_mem:12296,kntrie_uint64_find:0.0065,kntrie_uint64_insert:0.0445,kntrie_uint64_erase:0.0212,kntrie_uint64_mem:16392,map_int32_find:0.0375,map_int32_insert:0.0758,map_int32_erase:0.0373,map_int32_mem:36432,map_uint64_find:0.0374,map_uint64_insert:0.0847,map_uint64_erase:0.0370,map_uint64_mem:36432,umap_int32_find:0.0022,umap_int32_insert:0.0148,umap_int32_erase:0.0042,umap_int32_mem:24304,umap_uint64_find:0.0022,umap_uint64_insert:0.0150,umap_uint64_erase:0.0047,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0118,kntrie_int32_insert:0.0790,kntrie_int32_erase:0.0187,kntrie_int32_mem:24584,kntrie_uint64_find:0.0107,kntrie_uint64_insert:0.0742,kntrie_uint64_erase:0.0256,kntrie_uint64_mem:32776,map_int32_find:0.0636,map_int32_insert:0.1146,map_int32_erase:0.0557,map_int32_mem:54672,map_uint64_find:0.0631,map_uint64_insert:0.1138,map_uint64_erase:0.0559,map_uint64_mem:54672,umap_int32_find:0.0033,umap_int32_insert:0.0208,umap_int32_erase:0.0059,umap_int32_mem:36880,umap_uint64_find:0.0033,umap_uint64_insert:0.0198,umap_uint64_erase:0.0059,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0177,kntrie_int32_insert:0.1007,kntrie_int32_erase:0.0348,kntrie_int32_mem:24584,kntrie_uint64_find:0.0169,kntrie_uint64_insert:0.0943,kntrie_uint64_erase:0.0420,kntrie_uint64_mem:32776,map_int32_find:0.1039,map_int32_insert:0.1775,map_int32_erase:0.0875,map_int32_mem:81984,map_uint64_find:0.1056,map_uint64_insert:0.1787,map_uint64_erase:0.0853,map_uint64_mem:81984,umap_int32_find:0.0049,umap_int32_insert:0.0292,umap_int32_erase:0.0098,umap_int32_mem:54920,umap_uint64_find:0.0049,umap_uint64_insert:0.0292,umap_uint64_erase:0.0097,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0295,kntrie_int32_insert:0.1594,kntrie_int32_erase:0.0487,kntrie_int32_mem:49160,kntrie_uint64_find:0.0304,kntrie_uint64_insert:0.1661,kntrie_uint64_erase:0.0645,kntrie_uint64_mem:65544,map_int32_find:0.1713,map_int32_insert:0.2793,map_int32_erase:0.1396,map_int32_mem:122976,map_uint64_find:0.1708,map_uint64_insert:0.2846,map_uint64_erase:0.1368,map_uint64_mem:122976,umap_int32_find:0.0073,umap_int32_insert:0.0424,umap_int32_erase:0.0147,umap_int32_mem:83512,umap_uint64_find:0.0074,umap_uint64_insert:0.0412,umap_uint64_erase:0.0150,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0442,kntrie_int32_insert:0.2439,kntrie_int32_erase:0.0721,kntrie_int32_mem:49160,kntrie_uint64_find:0.0454,kntrie_uint64_insert:0.2518,kntrie_uint64_erase:0.1022,kntrie_uint64_mem:65544,map_int32_find:0.2773,map_int32_insert:0.4397,map_int32_erase:0.2285,map_int32_mem:184512,map_uint64_find:0.2800,map_uint64_insert:0.4265,map_uint64_erase:0.2225,map_uint64_mem:184512,umap_int32_find:0.0111,umap_int32_insert:0.0617,umap_int32_erase:0.0230,umap_int32_mem:124472,umap_uint64_find:0.0113,umap_uint64_insert:0.0601,umap_uint64_erase:0.0235,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0720,kntrie_int32_insert:0.4679,kntrie_int32_erase:0.2138,kntrie_int32_mem:69888,kntrie_uint64_find:0.1754,kntrie_uint64_insert:0.5164,kntrie_uint64_erase:0.2295,kntrie_uint64_mem:70272,map_int32_find:0.4759,map_int32_insert:0.6799,map_int32_erase:0.3698,map_int32_mem:276768,map_uint64_find:0.4698,map_uint64_insert:0.6872,map_uint64_erase:0.3565,map_uint64_mem:276768,umap_int32_find:0.0171,umap_int32_insert:0.0883,umap_int32_erase:0.0492,umap_int32_mem:186008,umap_uint64_find:0.0171,umap_uint64_insert:0.0881,umap_uint64_erase:0.0363,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.1128,kntrie_int32_insert:0.5231,kntrie_int32_erase:0.4593,kntrie_int32_mem:104464,kntrie_uint64_find:0.2727,kntrie_uint64_insert:0.5895,kntrie_uint64_erase:0.4723,kntrie_uint64_mem:104736,map_int32_find:0.8115,map_int32_insert:1.1058,map_int32_erase:0.6272,map_int32_mem:415152,map_uint64_find:0.8018,map_uint64_insert:1.1042,map_uint64_erase:0.6014,map_uint64_mem:415152,umap_int32_find:0.0256,umap_int32_insert:0.1379,umap_int32_erase:0.0572,umap_int32_mem:277840,umap_uint64_find:0.0270,umap_uint64_insert:0.1319,umap_uint64_erase:0.0561,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.1621,kntrie_int32_insert:0.7326,kntrie_int32_erase:0.6663,kntrie_int32_mem:156736,kntrie_uint64_find:0.4212,kntrie_uint64_insert:0.8163,kntrie_uint64_erase:0.7208,kntrie_uint64_mem:156736,map_int32_find:1.3048,map_int32_insert:1.7441,map_int32_erase:0.9576,map_int32_mem:622752,map_uint64_find:1.3525,map_uint64_insert:1.7641,map_uint64_erase:0.9749,map_uint64_mem:622752,umap_int32_find:0.0371,umap_int32_insert:0.1886,umap_int32_erase:0.0847,umap_int32_mem:415240,umap_uint64_find:0.0377,umap_uint64_insert:0.1830,umap_uint64_erase:0.0862,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.2497,kntrie_int32_insert:0.9922,kntrie_int32_erase:1.0146,kntrie_int32_mem:235568,kntrie_uint64_find:0.6098,kntrie_uint64_insert:1.0473,kntrie_uint64_erase:1.0635,kntrie_uint64_mem:235808,map_int32_find:2.1777,map_int32_insert:2.7963,map_int32_erase:1.5422,map_int32_mem:934128,map_uint64_find:2.1786,map_uint64_insert:2.7895,map_uint64_erase:1.5280,map_uint64_mem:934128,umap_int32_find:0.0558,umap_int32_insert:0.3002,umap_int32_erase:0.1314,umap_int32_mem:633088,umap_uint64_find:0.0567,umap_uint64_insert:0.2817,umap_uint64_erase:0.1276,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.3885,kntrie_int32_insert:1.4488,kntrie_int32_erase:1.5443,kntrie_int32_mem:353696,kntrie_uint64_find:0.9370,kntrie_uint64_insert:1.5350,kntrie_uint64_erase:1.6219,kntrie_uint64_mem:353696,map_int32_find:3.9535,map_int32_insert:4.4395,map_int32_erase:2.6418,map_int32_mem:1401216,map_uint64_find:4.0575,map_uint64_insert:4.4827,map_uint64_erase:2.6276,map_uint64_mem:1401216,umap_int32_find:0.0884,umap_int32_insert:0.4206,umap_int32_erase:0.2029,umap_int32_mem:946424,umap_uint64_find:0.0939,umap_uint64_insert:0.4293,umap_uint64_erase:0.2039,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.6134,kntrie_int32_insert:2.1148,kntrie_int32_erase:2.3232,kntrie_int32_mem:529808,kntrie_uint64_find:1.4333,kntrie_uint64_insert:2.2327,kntrie_uint64_erase:2.4260,kntrie_uint64_mem:530304,map_int32_find:8.0030,map_int32_insert:7.6515,map_int32_erase:5.0554,map_int32_mem:2101872,map_uint64_find:8.1244,map_uint64_insert:7.7069,map_uint64_erase:4.9564,map_uint64_mem:2101872,umap_int32_find:0.1964,umap_int32_insert:0.6346,umap_int32_erase:0.4156,umap_int32_mem:1414784,umap_uint64_find:0.2165,umap_uint64_insert:0.6286,umap_uint64_erase:0.4444,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:0.9717,kntrie_int32_insert:3.6075,kntrie_int32_erase:3.7196,kntrie_int32_mem:796296,kntrie_uint64_find:2.2204,kntrie_uint64_insert:3.8726,kntrie_uint64_erase:3.8655,kntrie_uint64_mem:796584,map_int32_find:15.1292,map_int32_insert:13.2294,map_int32_erase:8.9536,map_int32_mem:3152832,map_uint64_find:15.2613,map_uint64_insert:13.8090,map_uint64_erase:9.0520,map_uint64_mem:3152832,umap_int32_find:0.4961,umap_int32_insert:0.9803,umap_int32_erase:0.9716,umap_int32_mem:2114872,umap_uint64_find:0.4668,umap_uint64_insert:0.9543,umap_uint64_erase:0.8966,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.4465,kntrie_int32_insert:5.6241,kntrie_int32_erase:5.5575,kntrie_int32_mem:1192592,kntrie_uint64_find:3.4546,kntrie_uint64_insert:5.9922,kntrie_uint64_erase:5.9510,kntrie_uint64_mem:1192880,map_int32_find:29.9664,map_int32_insert:23.4962,map_int32_erase:16.6199,map_int32_mem:4729248,map_uint64_find:32.3405,map_uint64_insert:24.3546,map_uint64_erase:16.6756,map_uint64_mem:4729248,umap_int32_find:0.9509,umap_int32_insert:1.9763,umap_int32_erase:1.9248,umap_int32_mem:3162488,umap_uint64_find:1.0255,umap_uint64_insert:1.7672,umap_uint64_erase:1.9842,umap_uint64_mem:3162488},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
