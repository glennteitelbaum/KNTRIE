<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0008,kntrie_int32_insert:0.0069,kntrie_int32_erase:0.0024,kntrie_int32_mem:1552,kntrie_uint64_find:0.0008,kntrie_uint64_insert:0.0079,kntrie_uint64_erase:0.0046,kntrie_uint64_mem:2064,map_int32_find:0.0012,map_int32_insert:0.0072,map_int32_erase:0.0043,map_int32_mem:4800,map_uint64_find:0.0012,map_uint64_insert:0.0081,map_uint64_erase:0.0053,map_uint64_mem:4800,umap_int32_find:0.0010,umap_int32_insert:0.0020,umap_int32_erase:0.0013,umap_int32_mem:3224,umap_uint64_find:0.0011,umap_uint64_insert:0.0026,umap_uint64_erase:0.0021,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0013,kntrie_int32_insert:0.0101,kntrie_int32_erase:0.0036,kntrie_int32_mem:2320,kntrie_uint64_find:0.0013,kntrie_uint64_insert:0.0101,kntrie_uint64_erase:0.0056,kntrie_uint64_mem:3088,map_int32_find:0.0020,map_int32_insert:0.0109,map_int32_erase:0.0073,map_int32_mem:7200,map_uint64_find:0.0021,map_uint64_insert:0.0117,map_uint64_erase:0.0078,map_uint64_mem:7200,umap_int32_find:0.0018,umap_int32_insert:0.0051,umap_int32_erase:0.0022,umap_int32_mem:4856,umap_uint64_find:0.0015,umap_uint64_insert:0.0048,umap_uint64_erase:0.0030,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0019,kntrie_int32_insert:0.0155,kntrie_int32_erase:0.0050,kntrie_int32_mem:3088,kntrie_uint64_find:0.0019,kntrie_uint64_insert:0.0159,kntrie_uint64_erase:0.0060,kntrie_uint64_mem:4112,map_int32_find:0.0035,map_int32_insert:0.0187,map_int32_erase:0.0113,map_int32_mem:10800,map_uint64_find:0.0034,map_uint64_insert:0.0171,map_uint64_erase:0.0095,map_uint64_mem:10800,umap_int32_find:0.0029,umap_int32_insert:0.0075,umap_int32_erase:0.0031,umap_int32_mem:7216,umap_uint64_find:0.0026,umap_uint64_insert:0.0063,umap_uint64_erase:0.0030,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0033,kntrie_int32_insert:0.0234,kntrie_int32_erase:0.0069,kntrie_int32_mem:4624,kntrie_uint64_find:0.0033,kntrie_uint64_insert:0.0239,kntrie_uint64_erase:0.0090,kntrie_uint64_mem:6160,map_int32_find:0.0050,map_int32_insert:0.0252,map_int32_erase:0.0143,map_int32_mem:16176,map_uint64_find:0.0055,map_uint64_insert:0.0274,map_uint64_erase:0.0144,map_uint64_mem:16176,umap_int32_find:0.0037,umap_int32_insert:0.0099,umap_int32_erase:0.0039,umap_int32_mem:10784,umap_uint64_find:0.0035,umap_uint64_insert:0.0096,umap_uint64_erase:0.0044,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0048,kntrie_int32_insert:0.0379,kntrie_int32_erase:0.0101,kntrie_int32_mem:6160,kntrie_uint64_find:0.0047,kntrie_uint64_insert:0.0377,kntrie_uint64_erase:0.0127,kntrie_uint64_mem:8208,map_int32_find:0.0082,map_int32_insert:0.0384,map_int32_erase:0.0218,map_int32_mem:24288,map_uint64_find:0.0088,map_uint64_insert:0.0423,map_uint64_erase:0.0228,map_uint64_mem:24288,umap_int32_find:0.0051,umap_int32_insert:0.0138,umap_int32_erase:0.0057,umap_int32_mem:16472,umap_uint64_find:0.0051,umap_uint64_insert:0.0132,umap_uint64_erase:0.0065,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0083,kntrie_int32_insert:0.0603,kntrie_int32_erase:0.0162,kntrie_int32_mem:9232,kntrie_uint64_find:0.0081,kntrie_uint64_insert:0.0576,kntrie_uint64_erase:0.0181,kntrie_uint64_mem:12304,map_int32_find:0.0149,map_int32_insert:0.0629,map_int32_erase:0.0350,map_int32_mem:36432,map_uint64_find:0.0149,map_uint64_insert:0.0640,map_uint64_erase:0.0349,map_uint64_mem:36432,umap_int32_find:0.0088,umap_int32_insert:0.0250,umap_int32_erase:0.0099,umap_int32_mem:24304,umap_uint64_find:0.0082,umap_uint64_insert:0.0189,umap_uint64_erase:0.0097,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0135,kntrie_int32_insert:0.0847,kntrie_int32_erase:0.0212,kntrie_int32_mem:18448,kntrie_uint64_find:0.0128,kntrie_uint64_insert:0.0884,kntrie_uint64_erase:0.0206,kntrie_uint64_mem:24592,map_int32_find:0.0241,map_int32_insert:0.0951,map_int32_erase:0.0525,map_int32_mem:54672,map_uint64_find:0.0246,map_uint64_insert:0.0963,map_uint64_erase:0.0532,map_uint64_mem:54672,umap_int32_find:0.0145,umap_int32_insert:0.0366,umap_int32_erase:0.0195,umap_int32_mem:36880,umap_uint64_find:0.0120,umap_uint64_insert:0.0270,umap_uint64_erase:0.0130,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0209,kntrie_int32_insert:0.1346,kntrie_int32_erase:0.0327,kntrie_int32_mem:24592,kntrie_uint64_find:0.0189,kntrie_uint64_insert:0.1272,kntrie_uint64_erase:0.0332,kntrie_uint64_mem:32784,map_int32_find:0.0383,map_int32_insert:0.1483,map_int32_erase:0.0845,map_int32_mem:81984,map_uint64_find:0.0407,map_uint64_insert:0.1528,map_uint64_erase:0.0844,map_uint64_mem:81984,umap_int32_find:0.0219,umap_int32_insert:0.0478,umap_int32_erase:0.0237,umap_int32_mem:54920,umap_uint64_find:0.0198,umap_uint64_insert:0.0405,umap_uint64_erase:0.0207,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0402,kntrie_int32_insert:0.2102,kntrie_int32_erase:0.0503,kntrie_int32_mem:36880,kntrie_uint64_find:0.0324,kntrie_uint64_insert:0.2017,kntrie_uint64_erase:0.0519,kntrie_uint64_mem:49168,map_int32_find:0.0636,map_int32_insert:0.2498,map_int32_erase:0.1312,map_int32_mem:122976,map_uint64_find:0.0635,map_uint64_insert:0.2492,map_uint64_erase:0.1322,map_uint64_mem:122976,umap_int32_find:0.0297,umap_int32_insert:0.0614,umap_int32_erase:0.0302,umap_int32_mem:83512,umap_uint64_find:0.0298,umap_uint64_insert:0.0588,umap_uint64_erase:0.0311,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0482,kntrie_int32_insert:0.3122,kntrie_int32_erase:0.0727,kntrie_int32_mem:49168,kntrie_uint64_find:0.0501,kntrie_uint64_insert:0.3337,kntrie_uint64_erase:0.4156,kntrie_uint64_mem:65552,map_int32_find:0.1152,map_int32_insert:0.3832,map_int32_erase:0.2210,map_int32_mem:184512,map_uint64_find:0.1132,map_uint64_insert:0.3978,map_uint64_erase:0.2184,map_uint64_mem:184512,umap_int32_find:0.0486,umap_int32_insert:0.0944,umap_int32_erase:0.0475,umap_int32_mem:124472,umap_uint64_find:0.0515,umap_uint64_insert:0.0905,umap_uint64_erase:0.0508,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0835,kntrie_int32_insert:0.4878,kntrie_int32_erase:0.1200,kntrie_int32_mem:73744,kntrie_uint64_find:0.1102,kntrie_uint64_insert:0.6616,kntrie_uint64_erase:0.2890,kntrie_uint64_mem:98320,map_int32_find:0.1827,map_int32_insert:0.6699,map_int32_erase:0.3625,map_int32_mem:276768,map_uint64_find:0.2021,map_uint64_insert:0.6378,map_uint64_erase:0.3500,map_uint64_mem:276768,umap_int32_find:0.0756,umap_int32_insert:0.1438,umap_int32_erase:0.0752,umap_int32_mem:186008,umap_uint64_find:0.0804,umap_uint64_insert:0.1414,umap_uint64_erase:0.0756,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1997,kntrie_int32_insert:0.9678,kntrie_int32_erase:0.2398,kntrie_int32_mem:131096,kntrie_uint64_find:0.2860,kntrie_uint64_insert:1.1192,kntrie_uint64_erase:0.2904,kntrie_uint64_mem:174360,map_int32_find:0.2997,map_int32_insert:1.0204,map_int32_erase:0.5659,map_int32_mem:415152,map_uint64_find:0.3272,map_uint64_insert:1.1715,map_uint64_erase:0.5759,map_uint64_mem:415152,umap_int32_find:0.1185,umap_int32_insert:0.2228,umap_int32_erase:0.1170,umap_int32_mem:277840,umap_uint64_find:0.1229,umap_uint64_insert:0.2189,umap_uint64_erase:0.1190,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.3007,kntrie_int32_insert:1.2512,kntrie_int32_erase:0.3241,kntrie_int32_mem:184472,kntrie_uint64_find:0.4520,kntrie_uint64_insert:1.5078,kntrie_uint64_erase:0.3535,kntrie_uint64_mem:247576,map_int32_find:0.4975,map_int32_insert:1.6210,map_int32_erase:0.9383,map_int32_mem:622752,map_uint64_find:0.6415,map_uint64_insert:1.9115,map_uint64_erase:1.0654,map_uint64_mem:622752,umap_int32_find:0.1866,umap_int32_insert:0.3443,umap_int32_erase:0.1828,umap_int32_mem:415240,umap_uint64_find:0.2165,umap_uint64_insert:0.4084,umap_uint64_erase:0.2307,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.4124,kntrie_int32_insert:1.8671,kntrie_int32_erase:0.4735,kntrie_int32_mem:292376,kntrie_uint64_find:0.7392,kntrie_uint64_insert:2.0411,kntrie_uint64_erase:0.5736,kntrie_uint64_mem:386072,map_int32_find:0.8241,map_int32_insert:2.5483,map_int32_erase:1.5107,map_int32_mem:934128,map_uint64_find:0.9568,map_uint64_insert:2.9237,map_uint64_erase:1.6931,map_uint64_mem:934128,umap_int32_find:0.2729,umap_int32_insert:0.5105,umap_int32_erase:0.2703,umap_int32_mem:633088,umap_uint64_find:0.2745,umap_uint64_insert:0.5450,umap_uint64_erase:0.2968,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.6574,kntrie_int32_insert:2.5629,kntrie_int32_erase:0.6961,kntrie_int32_mem:415256,kntrie_uint64_find:1.1729,kntrie_uint64_insert:2.9216,kntrie_uint64_erase:0.8536,kntrie_uint64_mem:541720,map_int32_find:1.4998,map_int32_insert:4.0828,map_int32_erase:2.5900,map_int32_mem:1401216,map_uint64_find:1.8997,map_uint64_insert:5.6219,map_uint64_erase:3.3709,map_uint64_mem:1401216,umap_int32_find:0.4192,umap_int32_insert:0.7563,umap_int32_erase:0.4447,umap_int32_mem:946424,umap_uint64_find:0.4418,umap_uint64_insert:0.7958,umap_uint64_erase:0.5291,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:1.0045,kntrie_int32_insert:3.7839,kntrie_int32_erase:1.0590,kntrie_int32_mem:605720,kntrie_uint64_find:2.1010,kntrie_uint64_insert:4.0641,kntrie_uint64_erase:1.3268,kntrie_uint64_mem:803864,map_int32_find:2.9721,map_int32_insert:7.1892,map_int32_erase:4.9253,map_int32_mem:2101872,map_uint64_find:3.5506,map_uint64_insert:11.6519,map_uint64_erase:5.4458,map_uint64_mem:2101872,umap_int32_find:0.7283,umap_int32_insert:1.2057,umap_int32_erase:0.7599,umap_int32_mem:1414784,umap_uint64_find:0.7683,umap_uint64_insert:1.3133,umap_uint64_erase:0.8697,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.7855,kntrie_int32_insert:5.8660,kntrie_int32_erase:1.5746,kntrie_int32_mem:977432,kntrie_uint64_find:3.8072,kntrie_uint64_insert:6.3951,kntrie_uint64_erase:1.9473,kntrie_uint64_mem:1313816,map_int32_find:5.9137,map_int32_insert:12.9731,map_int32_erase:9.1813,map_int32_mem:3152832,map_uint64_find:6.6166,map_uint64_insert:17.2842,map_uint64_erase:9.4186,map_uint64_mem:3152832,umap_int32_find:1.3348,umap_int32_insert:2.3044,umap_int32_erase:1.6751,umap_int32_mem:2114872,umap_uint64_find:1.3124,umap_uint64_insert:2.3062,umap_uint64_erase:1.6526,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.9354,kntrie_int32_insert:9.1681,kntrie_int32_erase:2.5335,kntrie_int32_mem:1372184,map_int32_find:10.9825,map_int32_insert:24.0081,map_int32_erase:17.3561,map_int32_mem:4729104,umap_int32_find:2.3400,umap_int32_insert:4.5482,umap_int32_erase:3.2796,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:5.8360,kntrie_uint64_insert:9.7432,kntrie_uint64_erase:3.2075,kntrie_uint64_mem:1838104,map_uint64_find:10.8390,map_uint64_insert:30.8913,map_uint64_erase:16.8728,map_uint64_mem:4729248,umap_uint64_find:2.2874,umap_uint64_insert:4.4364,umap_uint64_erase:3.2127,umap_uint64_mem:3162488},
  {pattern:"random",N:147785,kntrie_int32_find:5.8806,kntrie_int32_insert:14.3719,kntrie_int32_erase:4.5370,kntrie_int32_mem:2364440,map_int32_find:22.0387,map_int32_insert:45.9104,map_int32_erase:32.7505,map_int32_mem:7093680,umap_int32_find:3.9114,umap_int32_insert:8.8748,umap_int32_erase:5.6571,umap_int32_mem:4729184},
  {pattern:"random",N:147789,kntrie_uint64_find:13.1268,kntrie_uint64_insert:16.3799,kntrie_uint64_erase:6.4236,kntrie_uint64_mem:3142680,map_uint64_find:19.4827,map_uint64_insert:51.7519,map_uint64_erase:29.3157,map_uint64_mem:7093872,umap_uint64_find:3.4695,umap_uint64_insert:7.3895,umap_uint64_erase:4.8932,umap_uint64_mem:4729280},
  {pattern:"random",N:221675,kntrie_int32_find:10.0467,kntrie_int32_insert:23.5813,kntrie_int32_erase:8.0285,kntrie_int32_mem:3150872,map_int32_find:40.9557,map_int32_insert:85.9433,map_int32_erase:59.8161,map_int32_mem:10640400,umap_int32_find:6.2265,umap_int32_insert:14.6010,umap_int32_erase:9.5758,umap_int32_mem:7215376},
  {pattern:"random",N:221683,kntrie_uint64_find:23.2309,kntrie_uint64_insert:26.8658,kntrie_uint64_erase:10.9066,kntrie_uint64_mem:4199448,map_uint64_find:38.1619,map_uint64_insert:88.2238,map_uint64_erase:57.2561,map_uint64_mem:10640784,umap_uint64_find:5.8192,umap_uint64_insert:13.8073,umap_uint64_erase:8.6759,umap_uint64_mem:7215568},
  {pattern:"random",N:332509,kntrie_int32_find:20.8690,kntrie_int32_insert:38.6950,kntrie_int32_erase:15.4880,kntrie_int32_mem:4723736,map_int32_find:75.0612,map_int32_insert:153.2801,map_int32_erase:108.1898,map_int32_mem:15960432,umap_int32_find:10.0193,umap_int32_insert:27.9508,umap_int32_erase:15.7790,umap_int32_mem:10788704},
  {pattern:"random",N:332525,kntrie_uint64_find:50.4573,kntrie_uint64_insert:49.0793,kntrie_uint64_erase:21.0778,kntrie_uint64_mem:6296600,map_uint64_find:69.3351,map_uint64_insert:166.7925,map_uint64_erase:94.3577,map_uint64_mem:15961200,umap_uint64_find:9.1688,umap_uint64_insert:21.6531,umap_uint64_erase:13.5854,umap_uint64_mem:10789088},
  {pattern:"random",N:498753,kntrie_int32_find:38.6121,kntrie_int32_insert:71.4986,kntrie_int32_erase:27.7363,kntrie_int32_mem:6370328,map_int32_find:120.0306,map_int32_insert:276.0245,map_int32_erase:176.5085,map_int32_mem:23940144,umap_int32_find:14.8373,umap_int32_insert:36.4087,umap_int32_erase:22.3909,umap_int32_mem:16132000},
  {pattern:"random",N:498788,kntrie_uint64_find:86.4822,kntrie_uint64_insert:88.7494,kntrie_uint64_erase:35.4348,kntrie_uint64_mem:8459288,map_uint64_find:114.6081,map_uint64_insert:312.3006,map_uint64_erase:172.9725,map_uint64_mem:23941824,umap_uint64_find:16.1388,umap_uint64_insert:40.0092,umap_uint64_erase:25.9946,umap_uint64_mem:16132840},
  {pattern:"random",N:748117,kntrie_int32_find:76.3352,kntrie_int32_insert:129.4931,kntrie_int32_erase:51.5315,kntrie_int32_mem:9454616,map_int32_find:201.2911,map_int32_insert:443.6093,map_int32_erase:311.6579,map_int32_mem:35909616,umap_int32_find:26.0307,umap_int32_insert:66.1747,umap_int32_erase:43.0267,umap_int32_mem:24123200},
  {pattern:"random",N:748182,kntrie_uint64_find:193.5029,kntrie_uint64_insert:185.8556,kntrie_uint64_erase:79.0629,kntrie_uint64_mem:12588056,map_uint64_find:217.3965,map_uint64_insert:535.0799,map_uint64_erase:312.7559,map_uint64_mem:35912736,umap_uint64_find:25.8702,umap_uint64_insert:65.5409,umap_uint64_erase:42.3603,umap_uint64_mem:24124760},
  {pattern:"random",N:1122145,kntrie_int32_find:154.0842,kntrie_int32_insert:253.5501,kntrie_int32_erase:91.0975,kntrie_int32_mem:18879512,umap_int32_find:37.9293,umap_int32_insert:95.2662,umap_int32_erase:57.4222,umap_int32_mem:36074048},
  {pattern:"random",N:1122274,kntrie_uint64_find:374.2088,kntrie_uint64_insert:369.1083,kntrie_uint64_erase:123.4633,kntrie_uint64_mem:25170968,umap_uint64_find:36.6985,umap_uint64_insert:94.3619,umap_uint64_erase:55.5320,umap_uint64_mem:36077144},
  {pattern:"random",N:1683111,kntrie_int32_find:244.1674,kntrie_int32_insert:468.5303,kntrie_int32_erase:161.0676,kntrie_int32_mem:25170968,umap_int32_find:66.5317,umap_int32_insert:173.4235,umap_int32_erase:113.6662,umap_int32_mem:53945536},
  {pattern:"random",N:1683411,kntrie_uint64_find:579.0534,kntrie_uint64_insert:595.4099,kntrie_uint64_erase:208.9946,kntrie_uint64_mem:33559576,umap_uint64_find:63.5558,umap_uint64_insert:171.4392,umap_uint64_erase:110.6541,umap_uint64_mem:53952736},
  {pattern:"random",N:2524384,kntrie_int32_find:494.5839,kntrie_int32_insert:920.5856,kntrie_int32_erase:205.3116,kntrie_int32_mem:31598392,umap_int32_find:106.8206,umap_int32_insert:282.9324,umap_int32_erase:183.6622,umap_int32_mem:82315208},
  {pattern:"random",N:2525116,kntrie_uint64_find:561.5325,kntrie_uint64_insert:1118.7224,kntrie_uint64_erase:275.4245,kntrie_uint64_mem:49807896,umap_uint64_find:108.0548,umap_uint64_insert:282.3629,umap_uint64_erase:190.0454,umap_uint64_mem:82332776},
  {pattern:"random",N:3786033,kntrie_int32_find:759.5508,kntrie_int32_insert:1208.9874,kntrie_int32_erase:330.7081,kntrie_int32_mem:46037272,umap_int32_find:175.6579,umap_int32_insert:447.7254,umap_int32_erase:272.5689,umap_int32_mem:123073040},
  {pattern:"random",N:3787675,kntrie_uint64_find:990.0915,kntrie_uint64_insert:1592.9906,kntrie_uint64_erase:403.6466,kntrie_uint64_mem:72923416,umap_uint64_find:164.8333,umap_uint64_insert:421.8398,umap_uint64_erase:263.3961,umap_uint64_mem:123112448},
  {pattern:"random",N:5677748,kntrie_int32_find:1283.5650,kntrie_int32_insert:1716.1667,kntrie_int32_erase:581.5821,kntrie_int32_mem:67093432,umap_int32_find:308.1591,umap_int32_insert:793.7414,umap_int32_erase:495.2963,umap_int32_mem:184004728},
  {pattern:"random",N:5681512,kntrie_uint64_find:1621.2336,kntrie_uint64_insert:2073.9682,kntrie_uint64_erase:713.0092,kntrie_uint64_mem:106642968,umap_uint64_find:306.3285,umap_uint64_insert:783.7470,umap_uint64_erase:483.4739,umap_uint64_mem:184095064},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0008,kntrie_int32_insert:0.0070,kntrie_int32_erase:0.0022,kntrie_int32_mem:1552,kntrie_uint64_find:0.0009,kntrie_uint64_insert:0.0087,kntrie_uint64_erase:0.0040,kntrie_uint64_mem:2064,map_int32_find:0.0011,map_int32_insert:0.0074,map_int32_erase:0.0042,map_int32_mem:4800,map_uint64_find:0.0012,map_uint64_insert:0.0075,map_uint64_erase:0.0049,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0010,umap_int32_erase:0.0007,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0013,umap_uint64_erase:0.0010,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0013,kntrie_int32_insert:0.0100,kntrie_int32_erase:0.0034,kntrie_int32_mem:2320,kntrie_uint64_find:0.0013,kntrie_uint64_insert:0.0101,kntrie_uint64_erase:0.0058,kntrie_uint64_mem:3088,map_int32_find:0.0020,map_int32_insert:0.0107,map_int32_erase:0.0066,map_int32_mem:7200,map_uint64_find:0.0021,map_uint64_insert:0.0122,map_uint64_erase:0.0071,map_uint64_mem:7200,umap_int32_find:0.0004,umap_int32_insert:0.0030,umap_int32_erase:0.0010,umap_int32_mem:4856,umap_uint64_find:0.0004,umap_uint64_insert:0.0034,umap_uint64_erase:0.0020,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0019,kntrie_int32_insert:0.0154,kntrie_int32_erase:0.0045,kntrie_int32_mem:3088,kntrie_uint64_find:0.0018,kntrie_uint64_insert:0.0155,kntrie_uint64_erase:0.0047,kntrie_uint64_mem:4112,map_int32_find:0.0029,map_int32_insert:0.0159,map_int32_erase:0.0095,map_int32_mem:10800,map_uint64_find:0.0033,map_uint64_insert:0.0189,map_uint64_erase:0.0094,map_uint64_mem:10800,umap_int32_find:0.0006,umap_int32_insert:0.0044,umap_int32_erase:0.0012,umap_int32_mem:7216,umap_uint64_find:0.0006,umap_uint64_insert:0.0042,umap_uint64_erase:0.0012,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0033,kntrie_int32_insert:0.0231,kntrie_int32_erase:0.0068,kntrie_int32_mem:4624,kntrie_uint64_find:0.0033,kntrie_uint64_insert:0.0237,kntrie_uint64_erase:0.0083,kntrie_uint64_mem:6160,map_int32_find:0.0051,map_int32_insert:0.0254,map_int32_erase:0.0141,map_int32_mem:16176,map_uint64_find:0.0058,map_uint64_insert:0.0263,map_uint64_erase:0.0143,map_uint64_mem:16176,umap_int32_find:0.0009,umap_int32_insert:0.0062,umap_int32_erase:0.0019,umap_int32_mem:10784,umap_uint64_find:0.0009,umap_uint64_insert:0.0064,umap_uint64_erase:0.0016,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0047,kntrie_int32_insert:0.0363,kntrie_int32_erase:0.0102,kntrie_int32_mem:6160,kntrie_uint64_find:0.0049,kntrie_uint64_insert:0.0385,kntrie_uint64_erase:0.0124,kntrie_uint64_mem:8208,map_int32_find:0.0085,map_int32_insert:0.0388,map_int32_erase:0.0217,map_int32_mem:24288,map_uint64_find:0.0091,map_uint64_insert:0.0415,map_uint64_erase:0.0231,map_uint64_mem:24288,umap_int32_find:0.0014,umap_int32_insert:0.0094,umap_int32_erase:0.0028,umap_int32_mem:16472,umap_uint64_find:0.0015,umap_uint64_insert:0.0093,umap_uint64_erase:0.0036,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0082,kntrie_int32_insert:0.0537,kntrie_int32_erase:0.0142,kntrie_int32_mem:9232,kntrie_uint64_find:0.0081,kntrie_uint64_insert:0.0569,kntrie_uint64_erase:0.0176,kntrie_uint64_mem:12304,map_int32_find:0.0138,map_int32_insert:0.0608,map_int32_erase:0.0338,map_int32_mem:36432,map_uint64_find:0.0151,map_uint64_insert:0.0634,map_uint64_erase:0.0358,map_uint64_mem:36432,umap_int32_find:0.0021,umap_int32_insert:0.0143,umap_int32_erase:0.0045,umap_int32_mem:24304,umap_uint64_find:0.0022,umap_uint64_insert:0.0133,umap_uint64_erase:0.0048,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0133,kntrie_int32_insert:0.0828,kntrie_int32_erase:0.0215,kntrie_int32_mem:18448,kntrie_uint64_find:0.0128,kntrie_uint64_insert:0.0888,kntrie_uint64_erase:0.0215,kntrie_uint64_mem:24592,map_int32_find:0.0242,map_int32_insert:0.0965,map_int32_erase:0.0524,map_int32_mem:54672,map_uint64_find:0.0251,map_uint64_insert:0.0983,map_uint64_erase:0.0553,map_uint64_mem:54672,umap_int32_find:0.0032,umap_int32_insert:0.0207,umap_int32_erase:0.0062,umap_int32_mem:36880,umap_uint64_find:0.0032,umap_uint64_insert:0.0193,umap_uint64_erase:0.0056,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0193,kntrie_int32_insert:0.1274,kntrie_int32_erase:0.0318,kntrie_int32_mem:24592,kntrie_uint64_find:0.0196,kntrie_uint64_insert:0.1298,kntrie_uint64_erase:0.0355,kntrie_uint64_mem:32784,map_int32_find:0.0384,map_int32_insert:0.1478,map_int32_erase:0.0832,map_int32_mem:81984,map_uint64_find:0.0422,map_uint64_insert:0.1586,map_uint64_erase:0.0845,map_uint64_mem:81984,umap_int32_find:0.0050,umap_int32_insert:0.0295,umap_int32_erase:0.0092,umap_int32_mem:54920,umap_uint64_find:0.0048,umap_uint64_insert:0.0278,umap_uint64_erase:0.0089,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0331,kntrie_int32_insert:0.1981,kntrie_int32_erase:0.0499,kntrie_int32_mem:36880,kntrie_uint64_find:0.0340,kntrie_uint64_insert:0.2029,kntrie_uint64_erase:0.0528,kntrie_uint64_mem:49168,map_int32_find:0.0630,map_int32_insert:0.2410,map_int32_erase:0.1326,map_int32_mem:122976,map_uint64_find:0.0662,map_uint64_insert:0.2471,map_uint64_erase:0.1372,map_uint64_mem:122976,umap_int32_find:0.0072,umap_int32_insert:0.0416,umap_int32_erase:0.0142,umap_int32_mem:83512,umap_uint64_find:0.0071,umap_uint64_insert:0.0403,umap_uint64_erase:0.0141,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0478,kntrie_int32_insert:0.3086,kntrie_int32_erase:0.0725,kntrie_int32_mem:49168,kntrie_uint64_find:0.0498,kntrie_uint64_insert:0.3228,kntrie_uint64_erase:0.0777,kntrie_uint64_mem:65552,map_int32_find:0.1133,map_int32_insert:0.3983,map_int32_erase:0.2131,map_int32_mem:184512,map_uint64_find:0.1178,map_uint64_insert:0.4253,map_uint64_erase:0.2283,map_uint64_mem:184512,umap_int32_find:0.0108,umap_int32_insert:0.0589,umap_int32_erase:0.0229,umap_int32_mem:124472,umap_uint64_find:0.0109,umap_uint64_insert:0.0585,umap_uint64_erase:0.0231,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0834,kntrie_int32_insert:0.4574,kntrie_int32_erase:0.1164,kntrie_int32_mem:73744,kntrie_uint64_find:0.0933,kntrie_uint64_insert:0.5129,kntrie_uint64_erase:0.1254,kntrie_uint64_mem:98320,map_int32_find:0.1856,map_int32_insert:0.6495,map_int32_erase:0.3665,map_int32_mem:276768,map_uint64_find:0.1938,map_uint64_insert:0.6611,map_uint64_erase:0.3652,map_uint64_mem:276768,umap_int32_find:0.0169,umap_int32_insert:0.0865,umap_int32_erase:0.0342,umap_int32_mem:186008,umap_uint64_find:0.0167,umap_uint64_insert:0.0833,umap_uint64_erase:0.0359,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.0724,kntrie_int32_insert:1.0503,kntrie_int32_erase:0.1637,kntrie_int32_mem:104368,kntrie_uint64_find:0.0873,kntrie_uint64_insert:1.1213,kntrie_uint64_erase:0.1638,kntrie_uint64_mem:104368,map_int32_find:0.3181,map_int32_insert:1.0520,map_int32_erase:0.6522,map_int32_mem:415152,map_uint64_find:0.3127,map_uint64_insert:1.0820,map_uint64_erase:0.5928,map_uint64_mem:415152,umap_int32_find:0.0247,umap_int32_insert:0.1247,umap_int32_erase:0.0539,umap_int32_mem:277840,umap_uint64_find:0.0252,umap_uint64_insert:0.1248,umap_uint64_erase:0.0552,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.1041,kntrie_int32_insert:1.1261,kntrie_int32_erase:0.2368,kntrie_int32_mem:156480,kntrie_uint64_find:0.1318,kntrie_uint64_insert:1.2055,kntrie_uint64_erase:0.2466,kntrie_uint64_mem:156480,map_int32_find:0.5201,map_int32_insert:1.7231,map_int32_erase:0.9395,map_int32_mem:622752,map_uint64_find:0.5302,map_uint64_insert:1.7420,map_uint64_erase:0.9538,map_uint64_mem:622752,umap_int32_find:0.0387,umap_int32_insert:0.1855,umap_int32_erase:0.0839,umap_int32_mem:415240,umap_uint64_find:0.0362,umap_uint64_insert:0.1825,umap_uint64_erase:0.0825,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.1627,kntrie_int32_insert:1.4109,kntrie_int32_erase:0.3472,kntrie_int32_mem:235584,kntrie_uint64_find:0.1982,kntrie_uint64_insert:1.4390,kntrie_uint64_erase:0.3802,kntrie_uint64_mem:235584,map_int32_find:0.8847,map_int32_insert:2.5873,map_int32_erase:1.5076,map_int32_mem:934128,map_uint64_find:0.8855,map_uint64_insert:2.7453,map_uint64_erase:1.5956,map_uint64_mem:934128,umap_int32_find:0.0574,umap_int32_insert:0.2861,umap_int32_erase:0.1254,umap_int32_mem:633088,umap_uint64_find:0.0559,umap_uint64_insert:0.2737,umap_uint64_erase:0.1325,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.2627,kntrie_int32_insert:1.8886,kntrie_int32_erase:0.5259,kntrie_int32_mem:353184,kntrie_uint64_find:0.3158,kntrie_uint64_insert:1.9445,kntrie_uint64_erase:0.5965,kntrie_uint64_mem:353184,map_int32_find:1.7029,map_int32_insert:4.4824,map_int32_erase:2.9560,map_int32_mem:1401216,map_uint64_find:1.6401,map_uint64_insert:4.9788,map_uint64_erase:2.6696,map_uint64_mem:1401216,umap_int32_find:0.0904,umap_int32_insert:0.4096,umap_int32_erase:0.2400,umap_int32_mem:946424,umap_uint64_find:0.1189,umap_uint64_insert:0.4142,umap_uint64_erase:0.2355,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.4113,kntrie_int32_insert:2.4582,kntrie_int32_erase:0.8533,kntrie_int32_mem:529824,kntrie_uint64_find:0.4791,kntrie_uint64_insert:2.5296,kntrie_uint64_erase:0.9306,kntrie_uint64_mem:529824,map_int32_find:3.0100,map_int32_insert:7.4541,map_int32_erase:4.9133,map_int32_mem:2101872,map_uint64_find:3.1272,map_uint64_insert:8.1193,map_uint64_erase:5.1047,map_uint64_mem:2101872,umap_int32_find:0.2495,umap_int32_insert:0.6021,umap_int32_erase:0.4598,umap_int32_mem:1414784,umap_uint64_find:0.2878,umap_uint64_insert:0.6653,umap_uint64_erase:0.6711,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:0.9942,kntrie_int32_insert:3.8556,kntrie_int32_erase:1.5281,kntrie_int32_mem:795624,kntrie_uint64_find:1.1007,kntrie_uint64_insert:4.0860,kntrie_uint64_erase:1.6626,kntrie_uint64_mem:795624,map_int32_find:6.0396,map_int32_insert:12.8652,map_int32_erase:11.0226,map_int32_mem:3152832,map_uint64_find:6.2143,map_uint64_insert:15.9643,map_uint64_erase:9.4783,map_uint64_mem:3152832,umap_int32_find:0.5487,umap_int32_insert:0.9679,umap_int32_erase:1.1701,umap_int32_mem:2114872,umap_uint64_find:0.5720,umap_uint64_insert:1.0391,umap_uint64_erase:1.2817,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.5635,kntrie_int32_insert:6.3828,kntrie_int32_erase:2.3237,kntrie_int32_mem:1192560,kntrie_uint64_find:1.7260,kntrie_uint64_insert:6.6188,kntrie_uint64_erase:2.5981,kntrie_uint64_mem:1192560,map_int32_find:12.8993,map_int32_insert:30.3717,map_int32_erase:18.6743,map_int32_mem:4729248,map_uint64_find:11.1556,map_uint64_insert:26.3152,map_uint64_erase:17.1732,map_uint64_mem:4729248,umap_int32_find:1.1118,umap_int32_insert:1.9443,umap_int32_erase:2.2915,umap_int32_mem:3162488,umap_uint64_find:1.0340,umap_uint64_insert:1.8543,umap_uint64_erase:2.2944,umap_uint64_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_int32_find:2.7920,kntrie_int32_insert:9.9216,kntrie_int32_erase:3.6787,kntrie_int32_mem:1789632,kntrie_uint64_find:2.8753,kntrie_uint64_insert:10.1068,kntrie_uint64_erase:3.9646,kntrie_uint64_mem:1789632,map_int32_find:24.1419,map_int32_insert:49.4551,map_int32_erase:34.0295,map_int32_mem:7093872,map_uint64_find:21.3485,map_uint64_insert:47.4280,map_uint64_erase:32.5727,map_uint64_mem:7093872,umap_int32_find:2.0496,umap_int32_insert:3.6561,umap_int32_erase:3.9362,umap_int32_mem:4729280,umap_uint64_find:1.7539,umap_uint64_insert:3.4832,umap_uint64_erase:3.5628,umap_uint64_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_int32_find:5.8221,kntrie_int32_insert:15.4606,kntrie_int32_erase:6.3158,kntrie_int32_mem:2683568,kntrie_uint64_find:5.8892,kntrie_uint64_insert:15.3189,kntrie_uint64_erase:6.4745,kntrie_uint64_mem:2683568,map_int32_find:42.5059,map_int32_insert:88.3908,map_int32_erase:60.6097,map_int32_mem:10640784,map_uint64_find:40.7767,map_uint64_insert:87.4387,map_uint64_erase:58.5005,map_uint64_mem:10640784,umap_int32_find:3.0933,umap_int32_insert:6.7358,umap_int32_erase:6.6425,umap_int32_mem:7215568,umap_uint64_find:2.9293,umap_uint64_insert:6.6659,umap_uint64_erase:6.7418,umap_uint64_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_int32_find:10.2588,kntrie_int32_insert:23.7324,kntrie_int32_erase:10.9748,kntrie_int32_mem:4029656,kntrie_uint64_find:12.0486,kntrie_uint64_insert:25.1486,kntrie_uint64_erase:12.3532,kntrie_uint64_mem:4029656,map_int32_find:67.9497,map_int32_insert:151.1287,map_int32_erase:103.0709,map_int32_mem:15961200,map_uint64_find:76.8805,map_uint64_insert:156.6777,map_uint64_erase:102.9985,map_uint64_mem:15961200,umap_int32_find:4.9552,umap_int32_insert:11.0190,umap_int32_erase:10.8836,umap_int32_mem:10789088,umap_uint64_find:5.1441,umap_uint64_insert:11.3480,umap_uint64_erase:11.4131,umap_uint64_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_int32_find:19.1248,kntrie_int32_insert:43.9370,kntrie_int32_erase:23.6873,kntrie_int32_mem:6039744,kntrie_uint64_find:20.4944,kntrie_uint64_insert:43.3122,kntrie_uint64_erase:24.1900,kntrie_uint64_mem:6039744,map_int32_find:135.4944,map_int32_insert:292.0003,map_int32_erase:187.6903,map_int32_mem:23941824,map_uint64_find:121.2164,map_uint64_insert:271.8559,map_uint64_erase:177.5067,map_uint64_mem:23941824,umap_int32_find:7.8757,umap_int32_insert:16.9784,umap_int32_erase:18.0418,umap_int32_mem:16132840,umap_uint64_find:8.4242,umap_uint64_insert:19.2040,umap_uint64_erase:19.8834,umap_uint64_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_int32_find:29.5969,kntrie_int32_insert:72.2468,kntrie_int32_erase:46.1211,kntrie_int32_mem:9059904,kntrie_uint64_find:34.2407,kntrie_uint64_insert:75.2994,kntrie_uint64_erase:48.9650,kntrie_uint64_mem:9059904,map_int32_find:224.2060,map_int32_insert:501.1149,map_int32_erase:297.8346,map_int32_mem:35912736,map_uint64_find:224.0499,map_uint64_insert:503.4047,map_uint64_erase:309.8460,map_uint64_mem:35912736,umap_int32_find:11.1135,umap_int32_insert:27.0920,umap_int32_erase:25.8782,umap_int32_mem:24124760,umap_uint64_find:10.5322,umap_uint64_insert:23.4698,umap_uint64_erase:25.2910,umap_uint64_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_int32_find:42.9504,kntrie_int32_insert:117.5032,kntrie_int32_erase:73.4749,kntrie_int32_mem:13573624,kntrie_uint64_find:56.8359,kntrie_uint64_insert:138.2348,kntrie_uint64_erase:88.6936,kntrie_uint64_mem:13573624,umap_int32_find:17.3424,umap_int32_insert:38.9623,umap_int32_erase:39.7526,umap_int32_mem:36077144,umap_uint64_find:22.5708,umap_uint64_insert:46.2804,umap_uint64_erase:46.6284,umap_uint64_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_int32_find:72.0060,kntrie_int32_insert:204.1480,kntrie_int32_erase:125.1200,kntrie_int32_mem:20384672,kntrie_uint64_find:99.2150,kntrie_uint64_insert:230.7028,kntrie_uint64_erase:147.1799,kntrie_uint64_mem:20384672,umap_int32_find:28.3043,umap_int32_insert:63.7234,umap_int32_erase:67.5238,umap_int32_mem:53952736,umap_uint64_find:30.3458,umap_uint64_insert:67.1914,umap_uint64_erase:67.9508,umap_uint64_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_int32_find:142.7757,kntrie_int32_insert:385.6500,kntrie_int32_erase:222.2192,kntrie_int32_mem:30577808,kntrie_uint64_find:156.5285,kntrie_uint64_insert:364.4884,kntrie_uint64_erase:223.7623,kntrie_uint64_mem:30577808,umap_int32_find:56.6121,umap_int32_insert:115.8520,umap_int32_erase:114.4294,umap_int32_mem:82332776,umap_uint64_find:56.9240,umap_uint64_insert:117.9736,umap_uint64_erase:119.6143,umap_uint64_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_int32_find:225.8793,kntrie_int32_insert:617.1402,kntrie_int32_erase:370.1472,kntrie_int32_mem:45867104,kntrie_uint64_find:341.5153,kntrie_uint64_insert:741.6494,kntrie_uint64_erase:448.9801,kntrie_uint64_mem:45867104,umap_int32_find:89.6458,umap_int32_insert:171.7141,umap_int32_erase:167.2780,umap_int32_mem:123112448,umap_uint64_find:98.7014,umap_uint64_insert:213.9715,umap_uint64_erase:198.3026,umap_uint64_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_int32_find:379.5707,kntrie_int32_insert:1051.6529,kntrie_int32_erase:624.2979,kntrie_int32_mem:68800928,kntrie_uint64_find:581.4962,kntrie_uint64_insert:1214.8607,kntrie_uint64_erase:738.2011,kntrie_uint64_mem:68800928,umap_int32_find:176.6197,umap_int32_insert:297.5166,umap_int32_erase:425.5882,umap_int32_mem:184095064,umap_uint64_find:175.9855,umap_uint64_insert:323.1923,umap_uint64_erase:338.5471,umap_uint64_mem:184095064},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
