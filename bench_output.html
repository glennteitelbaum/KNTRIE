<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0069,kntrie_int32_erase:0.0025,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0099,kntrie_uint64_erase:0.0039,kntrie_uint64_mem:2056,map_int32_find:0.0033,map_int32_insert:0.0089,map_int32_erase:0.0046,map_int32_mem:4800,map_uint64_find:0.0029,map_uint64_insert:0.0103,map_uint64_erase:0.0056,map_uint64_mem:4800,umap_int32_find:0.0010,umap_int32_insert:0.0029,umap_int32_erase:0.0014,umap_int32_mem:3224,umap_uint64_find:0.0011,umap_uint64_insert:0.0034,umap_uint64_erase:0.0020,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0010,kntrie_int32_insert:0.0103,kntrie_int32_erase:0.0037,kntrie_int32_mem:3080,kntrie_uint64_find:0.0010,kntrie_uint64_insert:0.0100,kntrie_uint64_erase:0.0049,kntrie_uint64_mem:4104,map_int32_find:0.0054,map_int32_insert:0.0139,map_int32_erase:0.0073,map_int32_mem:7200,map_uint64_find:0.0049,map_uint64_insert:0.0146,map_uint64_erase:0.0080,map_uint64_mem:7200,umap_int32_find:0.0018,umap_int32_insert:0.0050,umap_int32_erase:0.0023,umap_int32_mem:4856,umap_uint64_find:0.0016,umap_uint64_insert:0.0053,umap_uint64_erase:0.0025,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0015,kntrie_int32_insert:0.0126,kntrie_int32_erase:0.0044,kntrie_int32_mem:3080,kntrie_uint64_find:0.0015,kntrie_uint64_insert:0.0125,kntrie_uint64_erase:0.0049,kntrie_uint64_mem:4104,map_int32_find:0.0085,map_int32_insert:0.0189,map_int32_erase:0.0096,map_int32_mem:10800,map_uint64_find:0.0079,map_uint64_insert:0.0204,map_uint64_erase:0.0102,map_uint64_mem:10800,umap_int32_find:0.0029,umap_int32_insert:0.0075,umap_int32_erase:0.0030,umap_int32_mem:7216,umap_uint64_find:0.0027,umap_uint64_insert:0.0069,umap_uint64_erase:0.0029,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0026,kntrie_int32_insert:0.0206,kntrie_int32_erase:0.0073,kntrie_int32_mem:6152,kntrie_uint64_find:0.0025,kntrie_uint64_insert:0.0202,kntrie_uint64_erase:0.0085,kntrie_uint64_mem:8200,map_int32_find:0.0140,map_int32_insert:0.0309,map_int32_erase:0.0143,map_int32_mem:16176,map_uint64_find:0.0130,map_uint64_insert:0.0317,map_uint64_erase:0.0165,map_uint64_mem:16176,umap_int32_find:0.0038,umap_int32_insert:0.0099,umap_int32_erase:0.0039,umap_int32_mem:10784,umap_uint64_find:0.0037,umap_uint64_insert:0.0102,umap_uint64_erase:0.0043,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0038,kntrie_int32_insert:0.0333,kntrie_int32_erase:0.0086,kntrie_int32_mem:6152,kntrie_uint64_find:0.0037,kntrie_uint64_insert:0.0325,kntrie_uint64_erase:0.0128,kntrie_uint64_mem:8200,map_int32_find:0.0224,map_int32_insert:0.0475,map_int32_erase:0.0230,map_int32_mem:24288,map_uint64_find:0.0215,map_uint64_insert:0.0500,map_uint64_erase:0.0256,map_uint64_mem:24288,umap_int32_find:0.0051,umap_int32_insert:0.0139,umap_int32_erase:0.0058,umap_int32_mem:16472,umap_uint64_find:0.0051,umap_uint64_insert:0.0144,umap_uint64_erase:0.0065,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0066,kntrie_int32_insert:0.0436,kntrie_int32_erase:0.0168,kntrie_int32_mem:12296,kntrie_uint64_find:0.0063,kntrie_uint64_insert:0.0461,kntrie_uint64_erase:0.0212,kntrie_uint64_mem:16392,map_int32_find:0.0370,map_int32_insert:0.0722,map_int32_erase:0.0364,map_int32_mem:36432,map_uint64_find:0.0361,map_uint64_insert:0.0757,map_uint64_erase:0.0398,map_uint64_mem:36432,umap_int32_find:0.0083,umap_int32_insert:0.0205,umap_int32_erase:0.0093,umap_int32_mem:24304,umap_uint64_find:0.0085,umap_uint64_insert:0.0203,umap_uint64_erase:0.0093,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0111,kntrie_int32_insert:0.0690,kntrie_int32_erase:0.0178,kntrie_int32_mem:24584,kntrie_uint64_find:0.0105,kntrie_uint64_insert:0.0799,kntrie_uint64_erase:0.0246,kntrie_uint64_mem:32776,map_int32_find:0.0616,map_int32_insert:0.1096,map_int32_erase:0.0535,map_int32_mem:54672,map_uint64_find:0.0615,map_uint64_insert:0.1119,map_uint64_erase:0.0579,map_uint64_mem:54672,umap_int32_find:0.0119,umap_int32_insert:0.0281,umap_int32_erase:0.0129,umap_int32_mem:36880,umap_uint64_find:0.0127,umap_uint64_insert:0.0279,umap_uint64_erase:0.0128,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0165,kntrie_int32_insert:0.1169,kntrie_int32_erase:0.0313,kntrie_int32_mem:24584,kntrie_uint64_find:0.0161,kntrie_uint64_insert:0.0986,kntrie_uint64_erase:0.0412,kntrie_uint64_mem:32776,map_int32_find:0.1006,map_int32_insert:0.1699,map_int32_erase:0.0858,map_int32_mem:81984,map_uint64_find:0.1015,map_uint64_insert:0.1709,map_uint64_erase:0.0948,map_uint64_mem:81984,umap_int32_find:0.0203,umap_int32_insert:0.0421,umap_int32_erase:0.0203,umap_int32_mem:54920,umap_uint64_find:0.0209,umap_uint64_insert:0.0416,umap_uint64_erase:0.0208,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0281,kntrie_int32_insert:0.1589,kntrie_int32_erase:0.0479,kntrie_int32_mem:49160,kntrie_uint64_find:0.0292,kntrie_uint64_insert:0.1678,kntrie_uint64_erase:0.0629,kntrie_uint64_mem:65544,map_int32_find:0.1737,map_int32_insert:0.2670,map_int32_erase:0.1481,map_int32_mem:122976,map_uint64_find:0.1657,map_uint64_insert:0.2701,map_uint64_erase:0.1421,map_uint64_mem:122976,umap_int32_find:0.0314,umap_int32_insert:0.0657,umap_int32_erase:0.0336,umap_int32_mem:83512,umap_uint64_find:0.0310,umap_uint64_insert:0.0605,umap_uint64_erase:0.0311,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0461,kntrie_int32_insert:0.2807,kntrie_int32_erase:0.0791,kntrie_int32_mem:49160,kntrie_uint64_find:0.0471,kntrie_uint64_insert:0.2674,kntrie_uint64_erase:0.1077,kntrie_uint64_mem:65544,map_int32_find:0.2914,map_int32_insert:0.4590,map_int32_erase:0.2449,map_int32_mem:184512,map_uint64_find:0.2955,map_uint64_insert:0.4798,map_uint64_erase:0.2501,map_uint64_mem:184512,umap_int32_find:0.0503,umap_int32_insert:0.0975,umap_int32_erase:0.0556,umap_int32_mem:124472,umap_uint64_find:0.0543,umap_uint64_insert:0.1025,umap_uint64_erase:0.0535,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0652,kntrie_int32_insert:0.5673,kntrie_int32_erase:0.1473,kntrie_int32_mem:100560,kntrie_uint64_find:0.0663,kntrie_uint64_insert:0.4998,kntrie_uint64_erase:0.1561,kntrie_uint64_mem:131600,map_int32_find:0.5006,map_int32_insert:0.7244,map_int32_erase:0.3837,map_int32_mem:276768,map_uint64_find:0.4803,map_uint64_insert:0.7184,map_uint64_erase:0.4068,map_uint64_mem:276768,umap_int32_find:0.0815,umap_int32_insert:0.1632,umap_int32_erase:0.0817,umap_int32_mem:186008,umap_uint64_find:0.0839,umap_uint64_insert:0.1555,umap_uint64_erase:0.0796,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1316,kntrie_int32_insert:0.6538,kntrie_int32_erase:0.2008,kntrie_int32_mem:157968,kntrie_uint64_find:0.1348,kntrie_uint64_insert:0.6827,kntrie_uint64_erase:0.2307,kntrie_uint64_mem:214544,map_int32_find:0.8139,map_int32_insert:1.0939,map_int32_erase:0.6301,map_int32_mem:415152,map_uint64_find:0.8143,map_uint64_insert:1.1657,map_uint64_erase:0.6383,map_uint64_mem:415152,umap_int32_find:0.1226,umap_int32_insert:0.2384,umap_int32_erase:0.1306,umap_int32_mem:277840,umap_uint64_find:0.1283,umap_uint64_insert:0.2441,umap_uint64_erase:0.1351,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.1658,kntrie_int32_insert:0.9218,kntrie_int32_erase:0.3039,kntrie_int32_mem:207888,kntrie_uint64_find:0.1712,kntrie_uint64_insert:0.8914,kntrie_uint64_erase:0.3475,kntrie_uint64_mem:274960,map_int32_find:1.3609,map_int32_insert:1.7746,map_int32_erase:0.9783,map_int32_mem:622752,map_uint64_find:1.3400,map_uint64_insert:1.8470,map_uint64_erase:1.0040,map_uint64_mem:622752,umap_int32_find:0.1936,umap_int32_insert:0.3588,umap_int32_erase:0.2064,umap_int32_mem:415240,umap_uint64_find:0.1966,umap_uint64_insert:0.3535,umap_uint64_erase:0.1926,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.2778,kntrie_int32_insert:1.2406,kntrie_int32_erase:0.4367,kntrie_int32_mem:380688,kntrie_uint64_find:0.3187,kntrie_uint64_insert:1.3737,kntrie_uint64_erase:0.5160,kntrie_uint64_mem:503824,map_int32_find:2.1892,map_int32_insert:2.8134,map_int32_erase:1.5256,map_int32_mem:934128,map_uint64_find:2.4027,map_uint64_insert:2.9842,map_uint64_erase:1.6625,map_uint64_mem:934128,umap_int32_find:0.2749,umap_int32_insert:0.5114,umap_int32_erase:0.2726,umap_int32_mem:633088,umap_uint64_find:0.3012,umap_uint64_insert:0.5256,umap_uint64_erase:0.2886,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.4404,kntrie_int32_insert:1.9248,kntrie_int32_erase:0.6341,kntrie_int32_mem:444432,kntrie_uint64_find:0.4495,kntrie_uint64_insert:1.9496,kntrie_uint64_erase:0.7617,kntrie_uint64_mem:568336,map_int32_find:4.3080,map_int32_insert:4.3535,map_int32_erase:2.7115,map_int32_mem:1401216,map_uint64_find:4.3198,map_uint64_insert:4.5090,map_uint64_erase:2.6719,map_uint64_mem:1401216,umap_int32_find:0.4170,umap_int32_insert:0.7548,umap_int32_erase:0.4162,umap_int32_mem:946424,umap_uint64_find:0.4387,umap_uint64_insert:0.7648,umap_uint64_erase:0.4540,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:0.7187,kntrie_int32_insert:2.7998,kntrie_int32_erase:1.0397,kntrie_int32_mem:791568,kntrie_uint64_find:0.7743,kntrie_uint64_insert:2.8565,kntrie_uint64_erase:1.2872,kntrie_uint64_mem:1053712,map_int32_find:8.9648,map_int32_insert:8.0339,map_int32_erase:5.4100,map_int32_mem:2101872,map_uint64_find:9.3407,map_uint64_insert:7.7908,map_uint64_erase:5.3744,map_uint64_mem:2101872,umap_int32_find:0.7257,umap_int32_insert:1.2574,umap_int32_erase:0.8227,umap_int32_mem:1414784,umap_uint64_find:0.7349,umap_uint64_insert:1.2109,umap_uint64_erase:0.8327,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.4039,kntrie_int32_insert:4.8320,kntrie_int32_erase:1.5000,kntrie_int32_mem:1163280,kntrie_uint64_find:1.8512,kntrie_uint64_insert:5.1544,kntrie_uint64_erase:2.1101,kntrie_uint64_mem:1573904,map_int32_find:16.3209,map_int32_insert:13.6247,map_int32_erase:9.7993,map_int32_mem:3152832,map_uint64_find:17.0618,map_uint64_insert:15.0233,map_uint64_erase:10.1263,map_uint64_mem:3152832,umap_int32_find:1.3754,umap_int32_insert:2.3820,umap_int32_erase:1.7988,umap_int32_mem:2114872,umap_uint64_find:1.3842,umap_uint64_insert:2.3942,umap_uint64_erase:1.7300,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.0688,kntrie_int32_insert:6.8334,kntrie_int32_erase:2.6487,kntrie_int32_mem:1578000,map_int32_find:29.4106,map_int32_insert:24.3905,map_int32_erase:16.7289,map_int32_mem:4729104,umap_int32_find:2.3453,umap_int32_insert:4.4739,umap_int32_erase:3.1320,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:3.3060,kntrie_uint64_insert:7.3027,kntrie_uint64_erase:3.8972,kntrie_uint64_mem:2102288,map_uint64_find:32.4808,map_uint64_insert:26.5241,map_uint64_erase:18.3637,map_uint64_mem:4729248,umap_uint64_find:2.3278,umap_uint64_insert:4.8156,umap_uint64_erase:3.2781,umap_uint64_mem:3162488},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0077,kntrie_int32_erase:0.0023,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0099,kntrie_uint64_erase:0.0034,kntrie_uint64_mem:2056,map_int32_find:0.0032,map_int32_insert:0.0092,map_int32_erase:0.0047,map_int32_mem:4800,map_uint64_find:0.0029,map_uint64_insert:0.0109,map_uint64_erase:0.0056,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0020,umap_int32_erase:0.0007,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0025,umap_uint64_erase:0.0007,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0010,kntrie_int32_insert:0.0103,kntrie_int32_erase:0.0037,kntrie_int32_mem:3080,kntrie_uint64_find:0.0010,kntrie_uint64_insert:0.0094,kntrie_uint64_erase:0.0047,kntrie_uint64_mem:4104,map_int32_find:0.0055,map_int32_insert:0.0138,map_int32_erase:0.0072,map_int32_mem:7200,map_uint64_find:0.0048,map_uint64_insert:0.0159,map_uint64_erase:0.0080,map_uint64_mem:7200,umap_int32_find:0.0004,umap_int32_insert:0.0037,umap_int32_erase:0.0013,umap_int32_mem:4856,umap_uint64_find:0.0004,umap_uint64_insert:0.0037,umap_uint64_erase:0.0019,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0015,kntrie_int32_insert:0.0144,kntrie_int32_erase:0.0045,kntrie_int32_mem:3080,kntrie_uint64_find:0.0015,kntrie_uint64_insert:0.0128,kntrie_uint64_erase:0.0053,kntrie_uint64_mem:4104,map_int32_find:0.0086,map_int32_insert:0.0201,map_int32_erase:0.0097,map_int32_mem:10800,map_uint64_find:0.0080,map_uint64_insert:0.0212,map_uint64_erase:0.0104,map_uint64_mem:10800,umap_int32_find:0.0006,umap_int32_insert:0.0046,umap_int32_erase:0.0013,umap_int32_mem:7216,umap_uint64_find:0.0006,umap_uint64_insert:0.0048,umap_uint64_erase:0.0013,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0026,kntrie_int32_insert:0.0186,kntrie_int32_erase:0.0071,kntrie_int32_mem:6152,kntrie_uint64_find:0.0024,kntrie_uint64_insert:0.0182,kntrie_uint64_erase:0.0080,kntrie_uint64_mem:8200,map_int32_find:0.0143,map_int32_insert:0.0317,map_int32_erase:0.0157,map_int32_mem:16176,map_uint64_find:0.0133,map_uint64_insert:0.0326,map_uint64_erase:0.0158,map_uint64_mem:16176,umap_int32_find:0.0010,umap_int32_insert:0.0069,umap_int32_erase:0.0020,umap_int32_mem:10784,umap_uint64_find:0.0009,umap_uint64_insert:0.0068,umap_uint64_erase:0.0018,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0038,kntrie_int32_insert:0.0314,kntrie_int32_erase:0.0099,kntrie_int32_mem:6152,kntrie_uint64_find:0.0037,kntrie_uint64_insert:0.0308,kntrie_uint64_erase:0.0128,kntrie_uint64_mem:8200,map_int32_find:0.0225,map_int32_insert:0.0494,map_int32_erase:0.0233,map_int32_mem:24288,map_uint64_find:0.0217,map_uint64_insert:0.0501,map_uint64_erase:0.0251,map_uint64_mem:24288,umap_int32_find:0.0014,umap_int32_insert:0.0098,umap_int32_erase:0.0031,umap_int32_mem:16472,umap_uint64_find:0.0014,umap_uint64_insert:0.0098,umap_uint64_erase:0.0031,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0066,kntrie_int32_insert:0.0424,kntrie_int32_erase:0.0168,kntrie_int32_mem:12296,kntrie_uint64_find:0.0063,kntrie_uint64_insert:0.0420,kntrie_uint64_erase:0.0208,kntrie_uint64_mem:16392,map_int32_find:0.0364,map_int32_insert:0.0744,map_int32_erase:0.0357,map_int32_mem:36432,map_uint64_find:0.0360,map_uint64_insert:0.0773,map_uint64_erase:0.0387,map_uint64_mem:36432,umap_int32_find:0.0021,umap_int32_insert:0.0135,umap_int32_erase:0.0043,umap_int32_mem:24304,umap_uint64_find:0.0021,umap_uint64_insert:0.0140,umap_uint64_erase:0.0049,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0109,kntrie_int32_insert:0.0744,kntrie_int32_erase:0.0177,kntrie_int32_mem:24584,kntrie_uint64_find:0.0105,kntrie_uint64_insert:0.0811,kntrie_uint64_erase:0.0242,kntrie_uint64_mem:32776,map_int32_find:0.0608,map_int32_insert:0.1124,map_int32_erase:0.0554,map_int32_mem:54672,map_uint64_find:0.0613,map_uint64_insert:0.1138,map_uint64_erase:0.0595,map_uint64_mem:54672,umap_int32_find:0.0032,umap_int32_insert:0.0189,umap_int32_erase:0.0059,umap_int32_mem:36880,umap_uint64_find:0.0032,umap_uint64_insert:0.0194,umap_uint64_erase:0.0060,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0169,kntrie_int32_insert:0.0920,kntrie_int32_erase:0.0325,kntrie_int32_mem:24584,kntrie_uint64_find:0.0163,kntrie_uint64_insert:0.0925,kntrie_uint64_erase:0.0410,kntrie_uint64_mem:32776,map_int32_find:0.1026,map_int32_insert:0.1728,map_int32_erase:0.0834,map_int32_mem:81984,map_uint64_find:0.1016,map_uint64_insert:0.1764,map_uint64_erase:0.0946,map_uint64_mem:81984,umap_int32_find:0.0049,umap_int32_insert:0.0271,umap_int32_erase:0.0093,umap_int32_mem:54920,umap_uint64_find:0.0048,umap_uint64_insert:0.0284,umap_uint64_erase:0.0091,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0283,kntrie_int32_insert:0.1688,kntrie_int32_erase:0.0454,kntrie_int32_mem:49160,kntrie_uint64_find:0.0293,kntrie_uint64_insert:0.1551,kntrie_uint64_erase:0.0627,kntrie_uint64_mem:65544,map_int32_find:0.1673,map_int32_insert:0.2845,map_int32_erase:0.1366,map_int32_mem:122976,map_uint64_find:0.1694,map_uint64_insert:0.2821,map_uint64_erase:0.1452,map_uint64_mem:122976,umap_int32_find:0.0071,umap_int32_insert:0.0393,umap_int32_erase:0.0140,umap_int32_mem:83512,umap_uint64_find:0.0071,umap_uint64_insert:0.0408,umap_uint64_erase:0.0145,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0432,kntrie_int32_insert:0.2586,kntrie_int32_erase:0.0707,kntrie_int32_mem:49160,kntrie_uint64_find:0.0445,kntrie_uint64_insert:0.2400,kntrie_uint64_erase:0.1019,kntrie_uint64_mem:65544,map_int32_find:0.2810,map_int32_insert:0.4330,map_int32_erase:0.2167,map_int32_mem:184512,map_uint64_find:0.2739,map_uint64_insert:0.4330,map_uint64_erase:0.2291,map_uint64_mem:184512,umap_int32_find:0.0111,umap_int32_insert:0.0567,umap_int32_erase:0.0225,umap_int32_mem:124472,umap_uint64_find:0.0109,umap_uint64_insert:0.0587,umap_uint64_erase:0.0239,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0712,kntrie_int32_insert:0.4594,kntrie_int32_erase:0.1003,kntrie_int32_mem:69888,kntrie_uint64_find:0.1724,kntrie_uint64_insert:0.4105,kntrie_uint64_erase:0.1400,kntrie_uint64_mem:70272,map_int32_find:0.4630,map_int32_insert:0.6747,map_int32_erase:0.3592,map_int32_mem:276768,map_uint64_find:0.4737,map_uint64_insert:0.7067,map_uint64_erase:0.3760,map_uint64_mem:276768,umap_int32_find:0.0162,umap_int32_insert:0.0813,umap_int32_erase:0.0350,umap_int32_mem:186008,umap_uint64_find:0.0173,umap_uint64_insert:0.0869,umap_uint64_erase:0.0345,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.1054,kntrie_int32_insert:0.5254,kntrie_int32_erase:0.1554,kntrie_int32_mem:104464,kntrie_uint64_find:0.2603,kntrie_uint64_insert:0.5454,kntrie_uint64_erase:0.1781,kntrie_uint64_mem:104736,map_int32_find:0.7818,map_int32_insert:1.0762,map_int32_erase:0.5847,map_int32_mem:415152,map_uint64_find:0.7639,map_uint64_insert:1.0807,map_uint64_erase:0.5903,map_uint64_mem:415152,umap_int32_find:0.0251,umap_int32_insert:0.1203,umap_int32_erase:0.0546,umap_int32_mem:277840,umap_uint64_find:0.0248,umap_uint64_insert:0.1234,umap_uint64_erase:0.0618,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.1606,kntrie_int32_insert:0.7107,kntrie_int32_erase:0.2401,kntrie_int32_mem:156736,kntrie_uint64_find:0.3972,kntrie_uint64_insert:0.7531,kntrie_uint64_erase:0.2695,kntrie_uint64_mem:156736,map_int32_find:1.3227,map_int32_insert:1.6746,map_int32_erase:0.9356,map_int32_mem:622752,map_uint64_find:1.2819,map_uint64_insert:1.7468,map_uint64_erase:0.9660,map_uint64_mem:622752,umap_int32_find:0.0362,umap_int32_insert:0.1887,umap_int32_erase:0.0819,umap_int32_mem:415240,umap_uint64_find:0.0363,umap_uint64_insert:0.1821,umap_uint64_erase:0.0815,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.2484,kntrie_int32_insert:0.9849,kntrie_int32_erase:0.3722,kntrie_int32_mem:235568,kntrie_uint64_find:0.5974,kntrie_uint64_insert:1.0354,kntrie_uint64_erase:0.4151,kntrie_uint64_mem:235808,map_int32_find:2.2205,map_int32_insert:2.6958,map_int32_erase:1.5233,map_int32_mem:934128,map_uint64_find:2.2702,map_uint64_insert:2.7915,map_uint64_erase:1.5898,map_uint64_mem:934128,umap_int32_find:0.0556,umap_int32_insert:0.2666,umap_int32_erase:0.1257,umap_int32_mem:633088,umap_uint64_find:0.0571,umap_uint64_insert:0.2750,umap_uint64_erase:0.1254,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.3806,kntrie_int32_insert:1.4719,kntrie_int32_erase:0.6014,kntrie_int32_mem:353696,kntrie_uint64_find:0.9295,kntrie_uint64_insert:1.5187,kntrie_uint64_erase:0.6686,kntrie_uint64_mem:353696,map_int32_find:4.0500,map_int32_insert:4.3350,map_int32_erase:2.5721,map_int32_mem:1401216,map_uint64_find:4.4971,map_uint64_insert:4.8801,map_uint64_erase:2.8341,map_uint64_mem:1401216,umap_int32_find:0.0897,umap_int32_insert:0.4152,umap_int32_erase:0.1938,umap_int32_mem:946424,umap_uint64_find:0.1080,umap_uint64_insert:0.4092,umap_uint64_erase:0.2341,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.5898,kntrie_int32_insert:2.0719,kntrie_int32_erase:0.9133,kntrie_int32_mem:529808,kntrie_uint64_find:1.4373,kntrie_uint64_insert:2.2198,kntrie_uint64_erase:1.0549,kntrie_uint64_mem:530304,map_int32_find:8.0356,map_int32_insert:7.3704,map_int32_erase:5.0188,map_int32_mem:2101872,map_uint64_find:9.6952,map_uint64_insert:8.7377,map_uint64_erase:6.1141,map_uint64_mem:2101872,umap_int32_find:0.2118,umap_int32_insert:0.5803,umap_int32_erase:0.4165,umap_int32_mem:1414784,umap_uint64_find:0.3399,umap_uint64_insert:0.6629,umap_uint64_erase:0.5638,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:0.9337,kntrie_int32_insert:3.6010,kntrie_int32_erase:1.6874,kntrie_int32_mem:796296,kntrie_uint64_find:2.1543,kntrie_uint64_insert:3.6997,kntrie_uint64_erase:1.8147,kntrie_uint64_mem:796584,map_int32_find:15.5552,map_int32_insert:13.3417,map_int32_erase:9.6510,map_int32_mem:3152832,map_uint64_find:15.7325,map_uint64_insert:13.7417,map_uint64_erase:9.2060,map_uint64_mem:3152832,umap_int32_find:0.5316,umap_int32_insert:0.9704,umap_int32_erase:1.0999,umap_int32_mem:2114872,umap_uint64_find:0.5617,umap_uint64_insert:0.9739,umap_uint64_erase:1.1333,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.6135,kntrie_int32_insert:6.0994,kntrie_int32_erase:2.8301,kntrie_int32_mem:1192592,kntrie_uint64_find:3.3116,kntrie_uint64_insert:5.8079,kntrie_uint64_erase:2.7795,kntrie_uint64_mem:1192880,map_int32_find:32.6573,map_int32_insert:27.4838,map_int32_erase:18.7569,map_int32_mem:4729248,map_uint64_find:29.9271,map_uint64_insert:27.0888,map_uint64_erase:17.9196,map_uint64_mem:4729248,umap_int32_find:1.0953,umap_int32_insert:2.0984,umap_int32_erase:1.9981,umap_int32_mem:3162488,umap_uint64_find:1.0609,umap_uint64_insert:1.7275,umap_uint64_erase:2.2810,umap_uint64_mem:3162488},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
