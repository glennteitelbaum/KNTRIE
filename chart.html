<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64)</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0008,kntrie_nf:0.0007,kntrie_insert:0.0126,kntrie_erase:0.0045,kntrie_iter:0.0027,kntrie_mem:2056,map_fnd:0.0038,map_nf:0.0027,map_insert:0.0122,map_erase:0.0071,map_iter:0.0016,map_mem:4800,umap_fnd:0.0014,umap_nf:0.0020,umap_insert:0.0047,umap_erase:0.0026,umap_iter:0.0003,umap_mem:3224},
  {pattern:"random",N:150,kntrie_fnd:0.0014,kntrie_nf:0.0013,kntrie_insert:0.0138,kntrie_erase:0.0057,kntrie_iter:0.0045,kntrie_mem:4104,map_fnd:0.0063,map_nf:0.0046,map_insert:0.0184,map_erase:0.0102,map_iter:0.0021,map_mem:7200,umap_fnd:0.0020,umap_nf:0.0024,umap_insert:0.0068,umap_erase:0.0031,umap_iter:0.0003,umap_mem:4856},
  {pattern:"random",N:225,kntrie_fnd:0.0020,kntrie_nf:0.0018,kntrie_insert:0.0175,kntrie_erase:0.0068,kntrie_iter:0.0065,kntrie_mem:4104,map_fnd:0.0102,map_nf:0.0077,map_insert:0.0275,map_erase:0.0139,map_iter:0.0027,map_mem:10800,umap_fnd:0.0034,umap_nf:0.0045,umap_insert:0.0091,umap_erase:0.0041,umap_iter:0.0004,umap_mem:7216},
  {pattern:"random",N:337,kntrie_fnd:0.0036,kntrie_nf:0.0030,kntrie_insert:0.0262,kntrie_erase:0.0106,kntrie_iter:0.0106,kntrie_mem:8200,map_fnd:0.0167,map_nf:0.0131,map_insert:0.0421,map_erase:0.0230,map_iter:0.0046,map_mem:16176,umap_fnd:0.0046,umap_nf:0.0071,umap_insert:0.0134,umap_erase:0.0060,umap_iter:0.0007,umap_mem:10784},
  {pattern:"random",N:506,kntrie_fnd:0.0048,kntrie_nf:0.0045,kntrie_insert:0.0448,kntrie_erase:0.0124,kntrie_iter:0.0159,kntrie_mem:8200,map_fnd:0.0272,map_nf:0.0211,map_insert:0.0590,map_erase:0.0330,map_iter:0.0060,map_mem:24288,umap_fnd:0.0066,umap_nf:0.0100,umap_insert:0.0182,umap_erase:0.0078,umap_iter:0.0009,umap_mem:16472},
  {pattern:"random",N:759,kntrie_fnd:0.0090,kntrie_nf:0.0083,kntrie_insert:0.0549,kntrie_erase:0.0216,kntrie_iter:0.0258,kntrie_mem:16392,map_fnd:0.0461,map_nf:0.0354,map_insert:0.0884,map_erase:0.0491,map_iter:0.0091,map_mem:36432,umap_fnd:0.0106,umap_nf:0.0161,umap_insert:0.0267,umap_erase:0.0120,umap_iter:0.0015,umap_mem:24304},
  {pattern:"random",N:1139,kntrie_fnd:0.0144,kntrie_nf:0.0136,kntrie_insert:0.0794,kntrie_erase:0.0228,kntrie_iter:0.0419,kntrie_mem:32776,map_fnd:0.0776,map_nf:0.0664,map_insert:0.1357,map_erase:0.0707,map_iter:0.0138,map_mem:54672,umap_fnd:0.0160,umap_nf:0.0224,umap_insert:0.0356,umap_erase:0.0169,umap_iter:0.0026,umap_mem:36880},
  {pattern:"random",N:1708,kntrie_fnd:0.0210,kntrie_nf:0.0196,kntrie_insert:0.1266,kntrie_erase:0.0411,kntrie_iter:0.0629,kntrie_mem:32776,map_fnd:0.1284,map_nf:0.1126,map_insert:0.2072,map_erase:0.1140,map_iter:0.0220,map_mem:81984,umap_fnd:0.0257,umap_nf:0.0374,umap_insert:0.0530,umap_erase:0.0268,umap_iter:0.0049,umap_mem:54920},
  {pattern:"random",N:2562,kntrie_fnd:0.0391,kntrie_nf:0.0342,kntrie_insert:0.2059,kntrie_erase:0.0646,kntrie_iter:0.1028,kntrie_mem:65544,map_fnd:0.2114,map_nf:0.1923,map_insert:0.3265,map_erase:0.1833,map_iter:0.0330,map_mem:122976,umap_fnd:0.0381,umap_nf:0.0551,umap_insert:0.0802,umap_erase:0.0404,umap_iter:0.0085,umap_mem:83512},
  {pattern:"random",N:3844,kntrie_fnd:0.0572,kntrie_nf:0.0515,kntrie_insert:0.3718,kntrie_erase:0.0984,kntrie_iter:0.1537,kntrie_mem:65544,map_fnd:0.3473,map_nf:0.3281,map_insert:0.5069,map_erase:0.2793,map_iter:0.0500,map_mem:184512,umap_fnd:0.0618,umap_nf:0.0848,umap_insert:0.1209,umap_erase:0.0618,umap_iter:0.0144,umap_mem:124472},
  {pattern:"random",N:5766,kntrie_fnd:0.0790,kntrie_nf:0.0725,kntrie_insert:0.6072,kntrie_erase:0.4040,kntrie_iter:0.2526,kntrie_mem:131600,map_fnd:0.5728,map_nf:0.5437,map_insert:0.7981,map_erase:0.4397,map_iter:0.0761,map_mem:276768,umap_fnd:0.0961,umap_nf:0.1362,umap_insert:0.1872,umap_erase:0.0965,umap_iter:0.0235,umap_mem:186008},
  {pattern:"random",N:8649,kntrie_fnd:0.1546,kntrie_nf:0.1512,kntrie_insert:0.7783,kntrie_erase:0.7334,kntrie_iter:0.4002,kntrie_mem:214544,map_fnd:0.9426,map_nf:0.9132,map_insert:1.2369,map_erase:0.7036,map_iter:0.1188,map_mem:415152,umap_fnd:0.1433,umap_nf:0.2020,umap_insert:0.2822,umap_erase:0.1494,umap_iter:0.0364,umap_mem:277840},
  {pattern:"random",N:12974,kntrie_fnd:0.2126,kntrie_nf:0.1884,kntrie_insert:1.1626,kntrie_erase:0.8824,kntrie_iter:0.6178,kntrie_mem:274960,map_fnd:1.5661,map_nf:1.5479,map_insert:1.9650,map_erase:1.1318,map_iter:0.1848,map_mem:622752,umap_fnd:0.2339,umap_nf:0.3163,umap_insert:0.4244,umap_erase:0.2345,umap_iter:0.0590,umap_mem:415240},
  {pattern:"random",N:19461,kntrie_fnd:0.3898,kntrie_nf:0.3462,kntrie_insert:1.7596,kntrie_erase:1.1228,kntrie_iter:0.9760,kntrie_mem:503824,map_fnd:2.6807,map_nf:2.6197,map_insert:3.2793,map_erase:1.9240,map_iter:0.3776,map_mem:934128,umap_fnd:0.3388,umap_nf:0.4823,umap_insert:0.6357,umap_erase:0.3748,umap_iter:0.0935,umap_mem:633088},
  {pattern:"random",N:29192,kntrie_fnd:0.5624,kntrie_nf:0.4980,kntrie_insert:2.4499,kntrie_erase:1.4508,kntrie_iter:1.4606,kntrie_mem:568336,map_fnd:4.7192,map_nf:4.4114,map_insert:5.1610,map_erase:3.1164,map_iter:0.6474,map_mem:1401216,umap_fnd:0.5265,umap_nf:0.7292,umap_insert:0.9721,umap_erase:0.5564,umap_iter:0.1541,umap_mem:946424},
  {pattern:"random",N:43789,kntrie_fnd:1.0461,kntrie_nf:0.8773,kntrie_insert:3.7651,kntrie_erase:2.2653,kntrie_iter:2.3149,kntrie_mem:1053712,map_fnd:8.5899,map_nf:7.9317,map_insert:8.6546,map_erase:5.3718,map_iter:1.3489,map_mem:2101872,umap_fnd:0.8625,umap_nf:1.1957,umap_insert:1.6208,umap_erase:0.9445,umap_iter:0.2550,umap_mem:1414784},
  {pattern:"random",N:65684,kntrie_fnd:2.0710,kntrie_nf:1.7054,kntrie_insert:6.3972,kntrie_erase:2.9782,kntrie_iter:3.5873,kntrie_mem:1573904,map_fnd:14.8580,map_nf:13.7494,map_insert:14.6223,map_erase:9.1720,map_iter:2.5355,map_mem:3152832,umap_fnd:1.4370,umap_nf:1.9808,umap_insert:2.5682,umap_erase:1.7273,umap_iter:0.4595,umap_mem:2114872},
  {pattern:"random",N:98526,kntrie_fnd:3.2336,kntrie_nf:2.2116,kntrie_insert:9.2331,kntrie_erase:4.3432,kntrie_iter:5.5197,kntrie_mem:2102288,map_fnd:25.5282,map_nf:24.3446,map_insert:24.2849,map_erase:15.0387,map_iter:4.0616,map_mem:4729248,umap_fnd:2.3071,umap_nf:3.1457,umap_insert:4.1146,umap_erase:2.6778,umap_iter:0.9331,umap_mem:3162488},
  {pattern:"random",N:147789,kntrie_fnd:7.3850,kntrie_nf:4.7885,kntrie_insert:16.1531,kntrie_erase:6.6192,kntrie_iter:8.8123,kntrie_mem:4183056,map_fnd:46.0263,map_nf:43.0528,map_insert:42.1132,map_erase:27.6233,map_iter:6.9352,map_mem:7093872,umap_fnd:3.6801,umap_nf:5.1739,umap_insert:7.0698,umap_erase:4.5441,umap_iter:1.8321,umap_mem:4729280},
  {pattern:"random",N:221683,kntrie_fnd:10.8256,kntrie_nf:7.2491,kntrie_insert:25.0606,kntrie_erase:11.5929,kntrie_iter:13.1765,kntrie_mem:4199440,map_fnd:80.3757,map_nf:80.4191,map_insert:73.5218,map_erase:48.5728,map_iter:11.6737,map_mem:10640784,umap_fnd:5.8829,umap_nf:7.9011,umap_insert:11.8576,umap_erase:7.8378,umap_iter:3.0899,umap_mem:7215568},
  {pattern:"random",N:332525,kntrie_fnd:24.2081,kntrie_nf:16.9754,kntrie_insert:46.4554,kntrie_erase:20.1638,kntrie_iter:20.8978,kntrie_mem:8393744,map_fnd:138.5056,map_nf:139.9565,map_insert:123.3981,map_erase:83.1211,map_iter:18.5948,map_mem:15961200,umap_fnd:9.5746,umap_nf:12.5032,umap_insert:19.2183,umap_erase:12.2983,umap_iter:5.2723,umap_mem:10789088},
  {pattern:"random",N:498788,kntrie_fnd:35.6978,kntrie_nf:25.2908,kntrie_insert:79.3624,kntrie_erase:32.5825,kntrie_iter:31.1637,kntrie_mem:8524816,map_fnd:241.8679,map_nf:237.6378,map_insert:216.6386,map_erase:138.4790,map_iter:31.2417,map_mem:23941824,umap_fnd:15.6488,umap_nf:19.7058,umap_insert:30.9153,umap_erase:19.9658,umap_iter:9.0852,umap_mem:16132840},
  {pattern:"random",N:748182,kntrie_fnd:75.7118,kntrie_nf:55.4115,kntrie_insert:135.5967,kntrie_erase:61.0291,kntrie_iter:49.5662,kntrie_mem:16782352,map_fnd:431.0361,map_nf:431.9610,map_insert:366.5577,map_erase:240.4459,map_iter:52.7069,map_mem:35912736,umap_fnd:24.9768,umap_nf:30.8815,umap_insert:50.7568,umap_erase:32.0214,umap_iter:15.1877,umap_mem:24124760},
  {pattern:"random",N:1122274,kntrie_fnd:85.6406,kntrie_nf:71.6291,kntrie_insert:289.5935,kntrie_erase:129.7461,kntrie_iter:62.6421,kntrie_mem:27146000,umap_fnd:41.3278,umap_nf:49.3633,umap_insert:91.4356,umap_erase:51.1850,umap_iter:25.5331,umap_mem:36077144},
  {pattern:"random",N:1683411,kntrie_fnd:136.6288,kntrie_nf:113.8627,kntrie_insert:390.1439,kntrie_erase:295.7445,kntrie_iter:101.3478,kntrie_mem:37514256,umap_fnd:65.9274,umap_nf:76.0386,umap_insert:148.0565,umap_erase:85.4292,umap_iter:41.0958,umap_mem:53952736},
  {pattern:"random",N:2525116,kntrie_fnd:240.1567,kntrie_nf:198.5780,kntrie_insert:560.3511,kntrie_erase:482.0640,kntrie_iter:160.4668,kntrie_mem:62881040,umap_fnd:100.3515,umap_nf:114.7306,umap_insert:228.5662,umap_erase:130.5170,umap_iter:67.0583,umap_mem:82332776},
  {pattern:"sequential",N:100,kntrie_fnd:0.0007,kntrie_nf:0.0006,kntrie_insert:0.0099,kntrie_erase:0.0040,kntrie_iter:0.0027,kntrie_mem:2056,map_fnd:0.0037,map_nf:0.0037,map_insert:0.0109,map_erase:0.0068,map_iter:0.0014,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0007,umap_insert:0.0027,umap_erase:0.0014,umap_iter:0.0002,umap_mem:3224},
  {pattern:"sequential",N:150,kntrie_fnd:0.0013,kntrie_nf:0.0012,kntrie_insert:0.0127,kntrie_erase:0.0050,kntrie_iter:0.0044,kntrie_mem:4104,map_fnd:0.0062,map_nf:0.0058,map_insert:0.0188,map_erase:0.0103,map_iter:0.0018,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0011,umap_insert:0.0048,umap_erase:0.0019,umap_iter:0.0003,umap_mem:4856},
  {pattern:"sequential",N:225,kntrie_fnd:0.0018,kntrie_nf:0.0017,kntrie_insert:0.0164,kntrie_erase:0.0058,kntrie_iter:0.0063,kntrie_mem:4104,map_fnd:0.0100,map_nf:0.0097,map_insert:0.0257,map_erase:0.0134,map_iter:0.0025,map_mem:10800,umap_fnd:0.0008,umap_nf:0.0016,umap_insert:0.0062,umap_erase:0.0019,umap_iter:0.0004,umap_mem:7216},
  {pattern:"sequential",N:337,kntrie_fnd:0.0031,kntrie_nf:0.0029,kntrie_insert:0.0301,kntrie_erase:0.0100,kntrie_iter:0.0106,kntrie_mem:8200,map_fnd:0.0169,map_nf:0.0157,map_insert:0.0386,map_erase:0.0208,map_iter:0.0040,map_mem:16176,umap_fnd:0.0012,umap_nf:0.0024,umap_insert:0.0086,umap_erase:0.0027,umap_iter:0.0006,umap_mem:10784},
  {pattern:"sequential",N:506,kntrie_fnd:0.0049,kntrie_nf:0.0045,kntrie_insert:0.0409,kntrie_erase:0.0131,kntrie_iter:0.0157,kntrie_mem:8200,map_fnd:0.0272,map_nf:0.0251,map_insert:0.0583,map_erase:0.0312,map_iter:0.0059,map_mem:24288,umap_fnd:0.0018,umap_nf:0.0038,umap_insert:0.0123,umap_erase:0.0038,umap_iter:0.0010,umap_mem:16472},
  {pattern:"sequential",N:759,kntrie_fnd:0.0084,kntrie_nf:0.0072,kntrie_insert:0.0538,kntrie_erase:0.0205,kntrie_iter:0.0258,kntrie_mem:16392,map_fnd:0.0457,map_nf:0.0409,map_insert:0.0878,map_erase:0.0492,map_iter:0.0089,map_mem:36432,umap_fnd:0.0027,umap_nf:0.0053,umap_insert:0.0175,umap_erase:0.0051,umap_iter:0.0015,umap_mem:24304},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0144,kntrie_nf:0.0137,kntrie_insert:0.0936,kntrie_erase:0.0229,kntrie_iter:0.0419,kntrie_mem:32776,map_fnd:0.0778,map_nf:0.0720,map_insert:0.1321,map_erase:0.0742,map_iter:0.0146,map_mem:54672,umap_fnd:0.0039,umap_nf:0.0086,umap_insert:0.0239,umap_erase:0.0075,umap_iter:0.0023,umap_mem:36880},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0221,kntrie_nf:0.0206,kntrie_insert:0.1339,kntrie_erase:0.0409,kntrie_iter:0.0627,kntrie_mem:32776,map_fnd:0.1288,map_nf:0.1239,map_insert:0.2107,map_erase:0.1144,map_iter:0.0221,map_mem:81984,umap_fnd:0.0059,umap_nf:0.0128,umap_insert:0.0350,umap_erase:0.0121,umap_iter:0.0035,umap_mem:54920},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0386,kntrie_nf:0.0344,kntrie_insert:0.2055,kntrie_erase:0.0613,kntrie_iter:0.1024,kntrie_mem:65544,map_fnd:0.2103,map_nf:0.2085,map_insert:0.3222,map_erase:0.1797,map_iter:0.0341,map_mem:122976,umap_fnd:0.0089,umap_nf:0.0208,umap_insert:0.0502,umap_erase:0.0198,umap_iter:0.0050,umap_mem:83512},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0576,kntrie_nf:0.0487,kntrie_insert:0.2993,kntrie_erase:0.0972,kntrie_iter:0.1533,kntrie_mem:65544,map_fnd:0.3429,map_nf:0.3377,map_insert:0.5018,map_erase:0.2825,map_iter:0.0486,map_mem:184512,umap_fnd:0.0138,umap_nf:0.0302,umap_insert:0.0719,umap_erase:0.0282,umap_iter:0.0072,umap_mem:124472},
  {pattern:"sequential",N:5766,kntrie_fnd:0.2148,kntrie_nf:0.1928,kntrie_insert:0.5877,kntrie_erase:0.1813,kntrie_iter:0.4989,kntrie_mem:70960,map_fnd:0.5650,map_nf:0.5702,map_insert:0.7931,map_erase:0.4658,map_iter:0.0786,map_mem:276768,umap_fnd:0.0206,umap_nf:0.0454,umap_insert:0.1078,umap_erase:0.0471,umap_iter:0.0112,umap_mem:186008},
  {pattern:"sequential",N:8649,kntrie_fnd:0.3498,kntrie_nf:0.3061,kntrie_insert:0.6821,kntrie_erase:0.3136,kntrie_iter:0.7566,kntrie_mem:105792,map_fnd:0.9627,map_nf:0.9556,map_insert:1.2887,map_erase:0.7349,map_iter:0.1225,map_mem:415152,umap_fnd:0.0313,umap_nf:0.0674,umap_insert:0.1577,umap_erase:0.0826,umap_iter:0.0159,umap_mem:277840},
  {pattern:"sequential",N:12974,kntrie_fnd:0.5216,kntrie_nf:0.4566,kntrie_insert:0.9165,kntrie_erase:0.4697,kntrie_iter:1.1342,kntrie_mem:158816,map_fnd:1.5999,map_nf:1.5886,map_insert:2.0463,map_erase:1.1748,map_iter:0.1902,map_mem:622752,umap_fnd:0.0451,umap_nf:0.0987,umap_insert:0.2462,umap_erase:0.1128,umap_iter:0.0235,umap_mem:415240},
  {pattern:"sequential",N:19461,kntrie_fnd:0.7655,kntrie_nf:0.6657,kntrie_insert:1.2344,kntrie_erase:0.7121,kntrie_iter:1.6964,kntrie_mem:238048,map_fnd:2.6623,map_nf:2.6694,map_insert:3.2472,map_erase:1.8945,map_iter:0.3048,map_mem:934128,umap_fnd:0.0702,umap_nf:0.1567,umap_insert:0.3468,umap_erase:0.1695,umap_iter:0.0349,umap_mem:633088},
  {pattern:"sequential",N:29192,kntrie_fnd:1.1596,kntrie_nf:1.0131,kntrie_insert:1.7352,kntrie_erase:1.0695,kntrie_iter:2.5327,kntrie_mem:357056,map_fnd:4.7386,map_nf:4.7252,map_insert:5.2869,map_erase:3.1717,map_iter:0.6381,map_mem:1401216,umap_fnd:0.1170,umap_nf:0.2367,umap_insert:0.5235,umap_erase:0.2711,umap_iter:0.0538,umap_mem:946424},
  {pattern:"sequential",N:43789,kntrie_fnd:1.8447,kntrie_nf:1.5841,kntrie_insert:3.1805,kntrie_erase:1.9636,kntrie_iter:3.8126,kntrie_mem:535504,map_fnd:8.3590,map_nf:8.3572,map_insert:8.6402,map_erase:5.1702,map_iter:1.3991,map_mem:2101872,umap_fnd:0.2224,umap_nf:0.3736,umap_insert:0.7893,umap_erase:0.4734,umap_iter:0.0851,umap_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_fnd:2.7369,kntrie_nf:2.3559,kntrie_insert:4.5781,kntrie_erase:2.8927,kntrie_iter:5.7102,kntrie_mem:803768,map_fnd:14.7194,map_nf:14.8818,map_insert:14.8650,map_erase:9.2894,map_iter:2.5378,map_mem:3152832,umap_fnd:0.4733,umap_nf:0.6710,umap_insert:1.2190,umap_erase:0.9392,umap_iter:0.1273,umap_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_fnd:4.2900,kntrie_nf:3.5658,kntrie_insert:7.1082,kntrie_erase:4.4596,kntrie_iter:8.5926,kntrie_mem:1204168,map_fnd:26.6443,map_nf:25.7633,map_insert:25.3109,map_erase:15.7793,map_iter:4.0861,map_mem:4729248,umap_fnd:0.8276,umap_nf:1.1546,umap_insert:1.8802,umap_erase:1.6598,umap_iter:0.1866,umap_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_fnd:6.5204,kntrie_nf:5.3756,kntrie_insert:10.6499,kntrie_erase:6.8883,kntrie_iter:12.8100,kntrie_mem:1806096,map_fnd:43.7539,map_nf:44.5511,map_insert:41.6707,map_erase:27.1821,map_iter:6.7095,map_mem:7093872,umap_fnd:1.2726,umap_nf:1.8167,umap_insert:3.1229,umap_erase:2.7116,umap_iter:0.2915,umap_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_fnd:10.5492,kntrie_nf:8.1994,kntrie_insert:16.4566,kntrie_erase:10.6366,kntrie_iter:19.2639,kntrie_mem:2708512,map_fnd:77.5200,map_nf:77.2722,map_insert:71.2781,map_erase:47.0097,map_iter:11.3532,map_mem:10640784,umap_fnd:2.1524,umap_nf:3.0697,umap_insert:5.0569,umap_erase:4.6811,umap_iter:0.5743,umap_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_fnd:17.0847,kntrie_nf:12.5243,kntrie_insert:25.6159,kntrie_erase:17.4298,kntrie_iter:28.9006,kntrie_mem:4063360,map_fnd:137.8081,map_nf:138.3014,map_insert:122.3961,map_erase:81.2433,map_iter:18.3320,map_mem:15961200,umap_fnd:3.8306,umap_nf:4.9921,umap_insert:8.1651,umap_erase:7.6730,umap_iter:0.8064,umap_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_fnd:27.4473,kntrie_nf:19.3662,kntrie_insert:41.5929,kntrie_erase:30.2634,kntrie_iter:43.4716,kntrie_mem:6095232,map_fnd:236.7546,map_nf:233.7522,map_insert:209.5187,map_erase:135.0076,map_iter:29.8417,map_mem:23941824,umap_fnd:6.2142,umap_nf:7.9162,umap_insert:12.6888,umap_erase:12.2156,umap_iter:1.1827,umap_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_fnd:46.6230,kntrie_nf:31.3364,kntrie_insert:69.7146,kntrie_erase:52.9203,kntrie_iter:65.4334,kntrie_mem:9143504,map_fnd:403.4298,map_nf:413.0847,map_insert:364.2796,map_erase:225.9723,map_iter:51.5736,map_mem:35912736,umap_fnd:9.8372,umap_nf:12.8170,umap_insert:20.7271,umap_erase:19.6272,umap_iter:1.6575,umap_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_fnd:74.9548,kntrie_nf:51.6895,kntrie_insert:113.7789,kntrie_erase:88.4310,kntrie_iter:97.9230,kntrie_mem:13713968,umap_fnd:19.9376,umap_nf:21.0314,umap_insert:40.2719,umap_erase:34.1944,umap_iter:4.4736,umap_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_fnd:126.0357,kntrie_nf:84.4187,kntrie_insert:186.4331,kntrie_erase:150.4912,kntrie_iter:146.9918,kntrie_mem:20570672,umap_fnd:31.5837,umap_nf:31.9479,umap_insert:65.7731,umap_erase:50.3204,umap_iter:6.5382,umap_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_fnd:206.3250,kntrie_nf:144.1381,kntrie_insert:309.1285,kntrie_erase:244.3774,kntrie_iter:220.6906,kntrie_mem:30852840,umap_fnd:52.0274,umap_nf:51.6175,umap_insert:108.5493,umap_erase:85.3208,umap_iter:11.0207,umap_mem:82332776},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
