<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64)</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0005,kntrie_insert:0.0134,kntrie_erase:0.0061,kntrie_iter:0.0037,kntrie_mem:2056,map_fnd:0.0031,map_nf:0.0022,map_insert:0.0126,map_erase:0.0082,map_iter:0.0013,map_mem:4800,umap_fnd:0.0012,umap_nf:0.0018,umap_insert:0.0041,umap_erase:0.0035,umap_iter:0.0002,umap_mem:3224},
  {pattern:"random",N:150,kntrie_fnd:0.0011,kntrie_nf:0.0009,kntrie_insert:0.0167,kntrie_erase:0.0077,kntrie_iter:0.0050,kntrie_mem:4104,map_fnd:0.0051,map_nf:0.0040,map_insert:0.0177,map_erase:0.0124,map_iter:0.0019,map_mem:7200,umap_fnd:0.0018,umap_nf:0.0022,umap_insert:0.0065,umap_erase:0.0044,umap_iter:0.0003,umap_mem:4856},
  {pattern:"random",N:225,kntrie_fnd:0.0016,kntrie_nf:0.0013,kntrie_insert:0.0226,kntrie_erase:0.0085,kntrie_iter:0.0063,kntrie_mem:4104,map_fnd:0.0084,map_nf:0.0070,map_insert:0.0245,map_erase:0.0139,map_iter:0.0025,map_mem:10800,umap_fnd:0.0029,umap_nf:0.0041,umap_insert:0.0086,umap_erase:0.0044,umap_iter:0.0004,umap_mem:7216},
  {pattern:"random",N:337,kntrie_fnd:0.0027,kntrie_nf:0.0024,kntrie_insert:0.0254,kntrie_erase:0.0109,kntrie_iter:0.0096,kntrie_mem:8200,map_fnd:0.0135,map_nf:0.0112,map_insert:0.0373,map_erase:0.0196,map_iter:0.0035,map_mem:16176,umap_fnd:0.0040,umap_nf:0.0064,umap_insert:0.0115,umap_erase:0.0064,umap_iter:0.0006,umap_mem:10784},
  {pattern:"random",N:506,kntrie_fnd:0.0042,kntrie_nf:0.0036,kntrie_insert:0.0416,kntrie_erase:0.0143,kntrie_iter:0.0147,kntrie_mem:8200,map_fnd:0.0222,map_nf:0.0184,map_insert:0.0546,map_erase:0.0315,map_iter:0.0049,map_mem:24288,umap_fnd:0.0058,umap_nf:0.0088,umap_insert:0.0163,umap_erase:0.0079,umap_iter:0.0008,umap_mem:16472},
  {pattern:"random",N:759,kntrie_fnd:0.0069,kntrie_nf:0.0064,kntrie_insert:0.0552,kntrie_erase:0.0221,kntrie_iter:0.0233,kntrie_mem:16392,map_fnd:0.0365,map_nf:0.0306,map_insert:0.0823,map_erase:0.0454,map_iter:0.0078,map_mem:36432,umap_fnd:0.0093,umap_nf:0.0146,umap_insert:0.0235,umap_erase:0.0122,umap_iter:0.0013,umap_mem:24304},
  {pattern:"random",N:1139,kntrie_fnd:0.0111,kntrie_nf:0.0105,kntrie_insert:0.0722,kntrie_erase:0.0216,kntrie_iter:0.0370,kntrie_mem:32776,map_fnd:0.0635,map_nf:0.0550,map_insert:0.1199,map_erase:0.0701,map_iter:0.0118,map_mem:54672,umap_fnd:0.0132,umap_nf:0.0201,umap_insert:0.0324,umap_erase:0.0147,umap_iter:0.0022,umap_mem:36880},
  {pattern:"random",N:1708,kntrie_fnd:0.0168,kntrie_nf:0.0156,kntrie_insert:0.1183,kntrie_erase:0.0453,kntrie_iter:0.0557,kntrie_mem:32776,map_fnd:0.1079,map_nf:0.0956,map_insert:0.1849,map_erase:0.1024,map_iter:0.0187,map_mem:81984,umap_fnd:0.0222,umap_nf:0.0331,umap_insert:0.0456,umap_erase:0.0234,umap_iter:0.0043,umap_mem:54920},
  {pattern:"random",N:2562,kntrie_fnd:0.0300,kntrie_nf:0.0265,kntrie_insert:0.1813,kntrie_erase:0.0589,kntrie_iter:0.0905,kntrie_mem:65544,map_fnd:0.1806,map_nf:0.1666,map_insert:0.2957,map_erase:0.1649,map_iter:0.0288,map_mem:122976,umap_fnd:0.0333,umap_nf:0.0496,umap_insert:0.0676,umap_erase:0.0347,umap_iter:0.0073,umap_mem:83512},
  {pattern:"random",N:3844,kntrie_fnd:0.0443,kntrie_nf:0.0397,kntrie_insert:0.3270,kntrie_erase:0.0813,kntrie_iter:0.1357,kntrie_mem:65544,map_fnd:0.2973,map_nf:0.2821,map_insert:0.4715,map_erase:0.2558,map_iter:0.0440,map_mem:184512,umap_fnd:0.0540,umap_nf:0.0762,umap_insert:0.1033,umap_erase:0.0559,umap_iter:0.0126,umap_mem:124472},
  {pattern:"random",N:5766,kntrie_fnd:0.0621,kntrie_nf:0.0569,kntrie_insert:0.5156,kntrie_erase:0.3611,kntrie_iter:0.1769,kntrie_mem:131600,map_fnd:0.4823,map_nf:0.4699,map_insert:0.7163,map_erase:0.3927,map_iter:0.0658,map_mem:276768,umap_fnd:0.0848,umap_nf:0.1224,umap_insert:0.1597,umap_erase:0.0850,umap_iter:0.0221,umap_mem:186008},
  {pattern:"random",N:8649,kntrie_fnd:0.1282,kntrie_nf:0.1276,kntrie_insert:0.7051,kntrie_erase:0.6873,kntrie_iter:0.2787,kntrie_mem:214544,map_fnd:0.8165,map_nf:0.8020,map_insert:1.1438,map_erase:0.6385,map_iter:0.1022,map_mem:415152,umap_fnd:0.1308,umap_nf:0.1827,umap_insert:0.2400,umap_erase:0.1308,umap_iter:0.0337,umap_mem:277840},
  {pattern:"random",N:12974,kntrie_fnd:0.1580,kntrie_nf:0.1374,kntrie_insert:0.9926,kntrie_erase:0.8074,kntrie_iter:0.4271,kntrie_mem:274960,map_fnd:1.3465,map_nf:1.3319,map_insert:1.8533,map_erase:1.0159,map_iter:0.1586,map_mem:622752,umap_fnd:0.1985,umap_nf:0.2848,umap_insert:0.3554,umap_erase:0.1953,umap_iter:0.0538,umap_mem:415240},
  {pattern:"random",N:19461,kntrie_fnd:0.2887,kntrie_nf:0.2523,kntrie_insert:1.4202,kntrie_erase:1.0792,kntrie_iter:0.6862,kntrie_mem:503824,map_fnd:2.2836,map_nf:2.2548,map_insert:2.9078,map_erase:1.6238,map_iter:0.2631,map_mem:934128,umap_fnd:0.2954,umap_nf:0.4198,umap_insert:0.5473,umap_erase:0.2952,umap_iter:0.0816,umap_mem:633088},
  {pattern:"random",N:29192,kntrie_fnd:0.4545,kntrie_nf:0.3963,kntrie_insert:2.2145,kntrie_erase:1.4155,kntrie_iter:1.0445,kntrie_mem:568336,map_fnd:4.5948,map_nf:4.4804,map_insert:4.8468,map_erase:3.0807,map_iter:0.9153,map_mem:1401216,umap_fnd:0.4927,umap_nf:0.6692,umap_insert:0.8441,umap_erase:0.5054,umap_iter:0.1416,umap_mem:946424},
  {pattern:"random",N:43789,kntrie_fnd:0.7550,kntrie_nf:0.6645,kntrie_insert:3.1504,kntrie_erase:1.9334,kntrie_iter:1.6598,kntrie_mem:1053712,map_fnd:8.4681,map_nf:7.7429,map_insert:8.2775,map_erase:5.2294,map_iter:1.8108,map_mem:2101872,umap_fnd:0.7576,umap_nf:1.0367,umap_insert:1.3127,umap_erase:0.8161,umap_iter:0.2359,umap_mem:1414784},
  {pattern:"random",N:65684,kntrie_fnd:1.6797,kntrie_nf:1.3354,kntrie_insert:5.5081,kntrie_erase:2.7103,kntrie_iter:2.6089,kntrie_mem:1573904,map_fnd:18.8931,map_nf:16.9295,map_insert:14.9639,map_erase:9.8844,map_iter:3.5198,map_mem:3152832,umap_fnd:1.4750,umap_nf:1.8851,umap_insert:2.5188,umap_erase:1.8702,umap_iter:0.5541,umap_mem:2114872},
  {pattern:"random",N:98526,kntrie_fnd:2.8893,kntrie_nf:1.8022,kntrie_insert:7.9898,kntrie_erase:4.8570,kntrie_iter:4.0435,kntrie_mem:2102288,map_fnd:38.1910,map_nf:36.2214,map_insert:27.3624,map_erase:20.0863,map_iter:6.2143,map_mem:4729248,umap_fnd:2.4012,umap_nf:3.0846,umap_insert:4.6126,umap_erase:3.0372,umap_iter:1.1604,umap_mem:3162488},
  {pattern:"random",N:147789,kntrie_fnd:8.1074,kntrie_nf:4.5539,kntrie_insert:14.5943,kntrie_erase:7.4469,kntrie_iter:6.5717,kntrie_mem:4183056,map_fnd:77.3215,map_nf:72.4861,map_insert:52.9014,map_erase:38.0171,map_iter:13.2364,map_mem:7093872,umap_fnd:3.9703,umap_nf:5.2486,umap_insert:8.7963,umap_erase:5.3775,umap_iter:2.5770,umap_mem:4729280},
  {pattern:"random",N:221683,kntrie_fnd:13.5276,kntrie_nf:7.5683,kntrie_insert:25.9525,kntrie_erase:16.0893,kntrie_iter:9.8260,kntrie_mem:4199440,map_fnd:173.5424,map_nf:171.0126,map_insert:111.5023,map_erase:81.5786,map_iter:28.5477,map_mem:10640784,umap_fnd:6.9900,umap_nf:8.7975,umap_insert:15.3961,umap_erase:10.5692,umap_iter:4.9873,umap_mem:7215568},
  {pattern:"random",N:332525,kntrie_fnd:39.1843,kntrie_nf:22.2826,kntrie_insert:50.0297,kntrie_erase:28.3959,kntrie_iter:16.7299,kntrie_mem:8393744,map_fnd:342.7587,map_nf:331.9180,map_insert:219.3492,map_erase:157.1706,map_iter:57.6638,map_mem:15961200,umap_fnd:12.1833,umap_nf:14.6319,umap_insert:30.9663,umap_erase:21.3807,umap_iter:9.9954,umap_mem:10789088},
  {pattern:"random",N:498788,kntrie_fnd:47.0531,kntrie_nf:26.1275,kntrie_insert:88.9017,kntrie_erase:48.6528,kntrie_iter:23.8234,kntrie_mem:8524816,map_fnd:585.7754,map_nf:547.2963,map_insert:385.4144,map_erase:263.6405,map_iter:91.6303,map_mem:23941824,umap_fnd:19.8972,umap_nf:23.5748,umap_insert:48.7929,umap_erase:34.9572,umap_iter:19.5977,umap_mem:16132840},
  {pattern:"random",N:748182,kntrie_fnd:145.1597,kntrie_nf:72.7034,kntrie_insert:171.2512,kntrie_erase:95.7358,kntrie_iter:39.3780,kntrie_mem:16782352,map_fnd:1054.3948,map_nf:1015.2621,map_insert:735.1949,map_erase:516.1245,map_iter:145.9473,map_mem:35912736,umap_fnd:40.3652,umap_nf:52.0442,umap_insert:106.8106,umap_erase:71.4603,umap_iter:41.4849,umap_mem:24124760},
  {pattern:"random",N:1122274,kntrie_fnd:141.9527,kntrie_nf:117.4712,kntrie_insert:377.8595,kntrie_erase:88.8159,kntrie_iter:48.0415,kntrie_mem:27146000,umap_fnd:66.7145,umap_nf:83.3350,umap_insert:190.6368,umap_erase:119.6211,umap_iter:68.1654,umap_mem:36077144},
  {pattern:"random",N:1683411,kntrie_fnd:205.3640,kntrie_nf:193.8818,kntrie_insert:562.9261,kntrie_erase:383.5417,kntrie_iter:85.3071,kntrie_mem:37514256,umap_fnd:124.2128,umap_nf:142.9909,umap_insert:334.3346,umap_erase:206.0625,umap_iter:112.9432,umap_mem:53952736},
  {pattern:"random",N:2525116,kntrie_fnd:476.4358,kntrie_nf:451.9344,kntrie_insert:894.3424,kntrie_erase:830.1716,kntrie_iter:142.5648,kntrie_mem:62881040,umap_fnd:191.6593,umap_nf:214.3781,umap_insert:547.9251,umap_erase:322.9769,umap_iter:179.9163,umap_mem:82332776},
  {pattern:"sequential",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0005,kntrie_insert:0.0097,kntrie_erase:0.0051,kntrie_iter:0.0031,kntrie_mem:2056,map_fnd:0.0031,map_nf:0.0031,map_insert:0.0109,map_erase:0.0078,map_iter:0.0013,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0007,umap_insert:0.0026,umap_erase:0.0017,umap_iter:0.0002,umap_mem:3224},
  {pattern:"sequential",N:150,kntrie_fnd:0.0010,kntrie_nf:0.0009,kntrie_insert:0.0144,kntrie_erase:0.0068,kntrie_iter:0.0047,kntrie_mem:4104,map_fnd:0.0050,map_nf:0.0051,map_insert:0.0178,map_erase:0.0099,map_iter:0.0017,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0010,umap_insert:0.0047,umap_erase:0.0024,umap_iter:0.0003,umap_mem:4856},
  {pattern:"sequential",N:225,kntrie_fnd:0.0015,kntrie_nf:0.0013,kntrie_insert:0.0165,kntrie_erase:0.0066,kntrie_iter:0.0063,kntrie_mem:4104,map_fnd:0.0082,map_nf:0.0081,map_insert:0.0237,map_erase:0.0118,map_iter:0.0024,map_mem:10800,umap_fnd:0.0007,umap_nf:0.0014,umap_insert:0.0059,umap_erase:0.0021,umap_iter:0.0004,umap_mem:7216},
  {pattern:"sequential",N:337,kntrie_fnd:0.0026,kntrie_nf:0.0023,kntrie_insert:0.0250,kntrie_erase:0.0090,kntrie_iter:0.0097,kntrie_mem:8200,map_fnd:0.0136,map_nf:0.0133,map_insert:0.0356,map_erase:0.0196,map_iter:0.0034,map_mem:16176,umap_fnd:0.0011,umap_nf:0.0021,umap_insert:0.0079,umap_erase:0.0025,umap_iter:0.0006,umap_mem:10784},
  {pattern:"sequential",N:506,kntrie_fnd:0.0040,kntrie_nf:0.0035,kntrie_insert:0.0391,kntrie_erase:0.0125,kntrie_iter:0.0142,kntrie_mem:8200,map_fnd:0.0218,map_nf:0.0218,map_insert:0.0543,map_erase:0.0302,map_iter:0.0049,map_mem:24288,umap_fnd:0.0017,umap_nf:0.0035,umap_insert:0.0110,umap_erase:0.0043,umap_iter:0.0008,umap_mem:16472},
  {pattern:"sequential",N:759,kntrie_fnd:0.0069,kntrie_nf:0.0063,kntrie_insert:0.0530,kntrie_erase:0.0213,kntrie_iter:0.0231,kntrie_mem:16392,map_fnd:0.0362,map_nf:0.0357,map_insert:0.0817,map_erase:0.0450,map_iter:0.0079,map_mem:36432,umap_fnd:0.0026,umap_nf:0.0048,umap_insert:0.0147,umap_erase:0.0057,umap_iter:0.0013,umap_mem:24304},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0111,kntrie_nf:0.0099,kntrie_insert:0.0814,kntrie_erase:0.0209,kntrie_iter:0.0368,kntrie_mem:32776,map_fnd:0.0627,map_nf:0.0633,map_insert:0.1199,map_erase:0.0625,map_iter:0.0122,map_mem:54672,umap_fnd:0.0036,umap_nf:0.0076,umap_insert:0.0203,umap_erase:0.0063,umap_iter:0.0019,umap_mem:36880},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0164,kntrie_nf:0.0150,kntrie_insert:0.1106,kntrie_erase:0.0357,kntrie_iter:0.0557,kntrie_mem:32776,map_fnd:0.1064,map_nf:0.1068,map_insert:0.1832,map_erase:0.0998,map_iter:0.0181,map_mem:81984,umap_fnd:0.0053,umap_nf:0.0114,umap_insert:0.0289,umap_erase:0.0100,umap_iter:0.0030,umap_mem:54920},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0294,kntrie_nf:0.0250,kntrie_insert:0.1848,kntrie_erase:0.0569,kntrie_iter:0.0912,kntrie_mem:65544,map_fnd:0.1779,map_nf:0.1754,map_insert:0.2932,map_erase:0.1553,map_iter:0.0279,map_mem:122976,umap_fnd:0.0082,umap_nf:0.0184,umap_insert:0.0422,umap_erase:0.0164,umap_iter:0.0043,umap_mem:83512},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0438,kntrie_nf:0.0391,kntrie_insert:0.2792,kntrie_erase:0.0906,kntrie_iter:0.1356,kntrie_mem:65544,map_fnd:0.2954,map_nf:0.2933,map_insert:0.4721,map_erase:0.2488,map_iter:0.0441,map_mem:184512,umap_fnd:0.0127,umap_nf:0.0272,umap_insert:0.0590,umap_erase:0.0247,umap_iter:0.0064,umap_mem:124472},
  {pattern:"sequential",N:5766,kntrie_fnd:0.1777,kntrie_nf:0.1521,kntrie_insert:0.4958,kntrie_erase:0.1552,kntrie_iter:0.1753,kntrie_mem:70960,map_fnd:0.4911,map_nf:0.4906,map_insert:0.7402,map_erase:0.3950,map_iter:0.0670,map_mem:276768,umap_fnd:0.0196,umap_nf:0.0406,umap_insert:0.0898,umap_erase:0.0404,umap_iter:0.0095,umap_mem:186008},
  {pattern:"sequential",N:8649,kntrie_fnd:0.2747,kntrie_nf:0.2276,kntrie_insert:0.6647,kntrie_erase:0.3824,kntrie_iter:0.2663,kntrie_mem:105792,map_fnd:0.8358,map_nf:0.8233,map_insert:1.1797,map_erase:0.6625,map_iter:0.1043,map_mem:415152,umap_fnd:0.0295,umap_nf:0.0599,umap_insert:0.1270,umap_erase:0.0633,umap_iter:0.0140,umap_mem:277840},
  {pattern:"sequential",N:12974,kntrie_fnd:0.4068,kntrie_nf:0.3386,kntrie_insert:0.8624,kntrie_erase:0.5283,kntrie_iter:0.3902,kntrie_mem:158816,map_fnd:1.3510,map_nf:1.3746,map_insert:1.8157,map_erase:1.0322,map_iter:0.1717,map_mem:622752,umap_fnd:0.0413,umap_nf:0.0878,umap_insert:0.1926,umap_erase:0.0917,umap_iter:0.0206,umap_mem:415240},
  {pattern:"sequential",N:19461,kntrie_fnd:0.6172,kntrie_nf:0.5053,kntrie_insert:1.2089,kntrie_erase:0.7990,kntrie_iter:0.5861,kntrie_mem:238048,map_fnd:2.2717,map_nf:2.3060,map_insert:2.9400,map_erase:1.6866,map_iter:0.2654,map_mem:934128,umap_fnd:0.0640,umap_nf:0.1423,umap_insert:0.2807,umap_erase:0.1371,umap_iter:0.0310,umap_mem:633088},
  {pattern:"sequential",N:29192,kntrie_fnd:0.9400,kntrie_nf:0.7798,kntrie_insert:1.7659,kntrie_erase:1.2288,kntrie_iter:0.8939,kntrie_mem:357056,map_fnd:4.7274,map_nf:4.1467,map_insert:4.9311,map_erase:2.7770,map_iter:0.8604,map_mem:1401216,umap_fnd:0.0973,umap_nf:0.2121,umap_insert:0.4321,umap_erase:0.2352,umap_iter:0.0474,umap_mem:946424},
  {pattern:"sequential",N:43789,kntrie_fnd:1.4263,kntrie_nf:1.1760,kntrie_insert:3.0612,kntrie_erase:2.0701,kntrie_iter:1.5699,kntrie_mem:535504,map_fnd:9.0481,map_nf:9.0918,map_insert:8.4152,map_erase:5.3364,map_iter:1.8658,map_mem:2101872,umap_fnd:0.2787,umap_nf:0.3996,umap_insert:0.6714,umap_erase:0.4988,umap_iter:0.0782,umap_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_fnd:2.2124,kntrie_nf:1.8004,kntrie_insert:4.5027,kntrie_erase:3.1650,kntrie_iter:2.3688,kntrie_mem:803768,map_fnd:18.0091,map_nf:18.2406,map_insert:14.3626,map_erase:9.6942,map_iter:3.4480,map_mem:3152832,umap_fnd:0.5858,umap_nf:0.7593,umap_insert:1.0392,umap_erase:1.0132,umap_iter:0.1203,umap_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_fnd:3.3929,kntrie_nf:2.7620,kntrie_insert:6.7663,kntrie_erase:4.9230,kntrie_iter:3.5136,kntrie_mem:1204168,map_fnd:40.1397,map_nf:39.1598,map_insert:26.8867,map_erase:19.2775,map_iter:6.6788,map_mem:4729248,umap_fnd:1.1917,umap_nf:1.4945,umap_insert:1.8790,umap_erase:1.9964,umap_iter:0.1968,umap_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_fnd:5.4135,kntrie_nf:4.2340,kntrie_insert:10.5286,kntrie_erase:7.5091,kntrie_iter:5.3547,kntrie_mem:1806096,map_fnd:74.4497,map_nf:74.9363,map_insert:51.2520,map_erase:37.2700,map_iter:13.4361,map_mem:7093872,umap_fnd:1.7766,umap_nf:2.4500,umap_insert:3.7789,umap_erase:3.2113,umap_iter:0.3723,umap_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_fnd:10.1581,kntrie_nf:6.4716,kntrie_insert:16.9933,kntrie_erase:11.8989,kntrie_iter:7.9530,kntrie_mem:2708512,map_fnd:166.3690,map_nf:167.0613,map_insert:98.9142,map_erase:73.2544,map_iter:25.9746,map_mem:10640784,umap_fnd:3.5425,umap_nf:4.1899,umap_insert:7.3790,umap_erase:6.2637,umap_iter:0.8715,umap_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_fnd:18.6640,kntrie_nf:9.9886,kntrie_insert:28.6993,kntrie_erase:21.4121,kntrie_iter:12.2363,kntrie_mem:4063360,map_fnd:324.9068,map_nf:322.5251,map_insert:199.1812,map_erase:148.5504,map_iter:53.4579,map_mem:15961200,umap_fnd:6.8676,umap_nf:6.5966,umap_insert:11.7647,umap_erase:10.4825,umap_iter:1.6480,umap_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_fnd:36.3394,kntrie_nf:15.7483,kntrie_insert:49.7781,kntrie_erase:42.4659,kntrie_iter:18.4603,kntrie_mem:6095232,map_fnd:601.0545,map_nf:591.3127,map_insert:395.0392,map_erase:274.7596,map_iter:91.7170,map_mem:23941824,umap_fnd:12.1540,umap_nf:11.2763,umap_insert:21.7965,umap_erase:20.6320,umap_iter:2.7807,umap_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_fnd:71.7843,kntrie_nf:25.7559,kntrie_insert:86.9652,kntrie_erase:78.6304,kntrie_iter:28.2628,kntrie_mem:9143504,map_fnd:1025.7552,map_nf:1007.2531,map_insert:709.2759,map_erase:508.5622,map_iter:146.0396,map_mem:35912736,umap_fnd:23.6049,umap_nf:23.7268,umap_insert:35.0392,umap_erase:36.1846,umap_iter:3.9767,umap_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_fnd:144.8802,kntrie_nf:42.8629,kntrie_insert:162.4165,kntrie_erase:153.6723,kntrie_iter:42.0693,kntrie_mem:13713968,umap_fnd:44.6027,umap_nf:60.7356,umap_insert:72.2078,umap_erase:95.7860,umap_iter:6.1774,umap_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_fnd:261.8333,kntrie_nf:79.0153,kntrie_insert:279.0386,kntrie_erase:302.0592,kntrie_iter:63.6401,kntrie_mem:20570672,umap_fnd:78.4338,umap_nf:100.9412,umap_insert:143.3726,umap_erase:139.8317,umap_iter:9.6908,umap_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_fnd:437.9203,kntrie_nf:155.2059,kntrie_insert:495.9614,kntrie_erase:566.7426,kntrie_iter:94.7717,kntrie_mem:30852840,umap_fnd:115.5700,umap_nf:153.5639,umap_insert:255.0797,umap_erase:217.4466,umap_iter:14.3180,umap_mem:82332776},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
    },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
