<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0013,kntrie_int32_insert:0.0068,kntrie_int32_erase:0.0036,kntrie_int32_mem:1560,kntrie_uint64_find:0.0008,kntrie_uint64_insert:0.0057,kntrie_uint64_erase:0.0034,kntrie_uint64_mem:2072,map_int32_find:0.0013,map_int32_insert:0.0086,map_int32_erase:0.0050,map_int32_mem:4800,map_uint64_find:0.0013,map_uint64_insert:0.0090,map_uint64_erase:0.0057,map_uint64_mem:4800,umap_int32_find:0.0011,umap_int32_insert:0.0022,umap_int32_erase:0.0015,umap_int32_mem:3224,umap_uint64_find:0.0012,umap_uint64_insert:0.0026,umap_uint64_erase:0.0021,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0013,kntrie_int32_insert:0.0086,kntrie_int32_erase:0.0044,kntrie_int32_mem:3096,kntrie_uint64_find:0.0013,kntrie_uint64_insert:0.0138,kntrie_uint64_erase:0.0041,kntrie_uint64_mem:4120,map_int32_find:0.0023,map_int32_insert:0.0124,map_int32_erase:0.0078,map_int32_mem:7200,map_uint64_find:0.0022,map_uint64_insert:0.0128,map_uint64_erase:0.0084,map_uint64_mem:7200,umap_int32_find:0.0019,umap_int32_insert:0.0057,umap_int32_erase:0.0025,umap_int32_mem:4856,umap_uint64_find:0.0017,umap_uint64_insert:0.0053,umap_uint64_erase:0.0029,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0020,kntrie_int32_insert:0.0137,kntrie_int32_erase:0.0053,kntrie_int32_mem:3096,kntrie_uint64_find:0.0021,kntrie_uint64_insert:0.0135,kntrie_uint64_erase:0.0053,kntrie_uint64_mem:4120,map_int32_find:0.0037,map_int32_insert:0.0186,map_int32_erase:0.0104,map_int32_mem:10800,map_uint64_find:0.0036,map_uint64_insert:0.0190,map_uint64_erase:0.0102,map_uint64_mem:10800,umap_int32_find:0.0031,umap_int32_insert:0.0078,umap_int32_erase:0.0033,umap_int32_mem:7216,umap_uint64_find:0.0028,umap_uint64_insert:0.0073,umap_uint64_erase:0.0032,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0034,kntrie_int32_insert:0.0195,kntrie_int32_erase:0.0073,kntrie_int32_mem:6168,kntrie_uint64_find:0.0034,kntrie_uint64_insert:0.0199,kntrie_uint64_erase:0.0085,kntrie_uint64_mem:8216,map_int32_find:0.0060,map_int32_insert:0.0290,map_int32_erase:0.0156,map_int32_mem:16176,map_uint64_find:0.0056,map_uint64_insert:0.0296,map_uint64_erase:0.0165,map_uint64_mem:16176,umap_int32_find:0.0040,umap_int32_insert:0.0109,umap_int32_erase:0.0045,umap_int32_mem:10784,umap_uint64_find:0.0038,umap_uint64_insert:0.0102,umap_uint64_erase:0.0048,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0051,kntrie_int32_insert:0.0326,kntrie_int32_erase:0.0103,kntrie_int32_mem:6168,kntrie_uint64_find:0.0051,kntrie_uint64_insert:0.0326,kntrie_uint64_erase:0.0116,kntrie_uint64_mem:8216,map_int32_find:0.0099,map_int32_insert:0.0447,map_int32_erase:0.0241,map_int32_mem:24288,map_uint64_find:0.0093,map_uint64_insert:0.0443,map_uint64_erase:0.0247,map_uint64_mem:24288,umap_int32_find:0.0059,umap_int32_insert:0.0180,umap_int32_erase:0.0080,umap_int32_mem:16472,umap_uint64_find:0.0055,umap_uint64_insert:0.0146,umap_uint64_erase:0.0067,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0088,kntrie_int32_insert:0.0482,kntrie_int32_erase:0.0186,kntrie_int32_mem:12312,kntrie_uint64_find:0.0084,kntrie_uint64_insert:0.0454,kntrie_uint64_erase:0.0188,kntrie_uint64_mem:16408,map_int32_find:0.0164,map_int32_insert:0.0684,map_int32_erase:0.0379,map_int32_mem:36432,map_uint64_find:0.0156,map_uint64_insert:0.0704,map_uint64_erase:0.0386,map_uint64_mem:36432,umap_int32_find:0.0091,umap_int32_insert:0.0227,umap_int32_erase:0.0099,umap_int32_mem:24304,umap_uint64_find:0.0088,umap_uint64_insert:0.0211,umap_uint64_erase:0.0103,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0144,kntrie_int32_insert:0.0787,kntrie_int32_erase:0.0186,kntrie_int32_mem:24600,kntrie_uint64_find:0.0141,kntrie_uint64_insert:0.0765,kntrie_uint64_erase:0.0196,kntrie_uint64_mem:32792,map_int32_find:0.0277,map_int32_insert:0.1135,map_int32_erase:0.0577,map_int32_mem:54672,map_uint64_find:0.0261,map_uint64_insert:0.1091,map_uint64_erase:0.0586,map_uint64_mem:54672,umap_int32_find:0.0130,umap_int32_insert:0.0302,umap_int32_erase:0.0144,umap_int32_mem:36880,umap_uint64_find:0.0137,umap_uint64_insert:0.0307,umap_uint64_erase:0.0149,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0213,kntrie_int32_insert:0.1125,kntrie_int32_erase:0.0351,kntrie_int32_mem:24600,kntrie_uint64_find:0.0261,kntrie_uint64_insert:0.1210,kntrie_uint64_erase:0.0341,kntrie_uint64_mem:32792,map_int32_find:0.0446,map_int32_insert:0.1711,map_int32_erase:0.0902,map_int32_mem:81984,map_uint64_find:0.0423,map_uint64_insert:0.1697,map_uint64_erase:0.0918,map_uint64_mem:81984,umap_int32_find:0.0221,umap_int32_insert:0.0465,umap_int32_erase:0.0227,umap_int32_mem:54920,umap_uint64_find:0.0215,umap_uint64_insert:0.0447,umap_uint64_erase:0.0222,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0384,kntrie_int32_insert:0.1799,kntrie_int32_erase:0.0502,kntrie_int32_mem:49176,kntrie_uint64_find:0.0365,kntrie_uint64_insert:0.1684,kntrie_uint64_erase:0.0526,kntrie_uint64_mem:65560,map_int32_find:0.0721,map_int32_insert:0.2922,map_int32_erase:0.1486,map_int32_mem:122976,map_uint64_find:0.0685,map_uint64_insert:0.2790,map_uint64_erase:0.1531,map_uint64_mem:122976,umap_int32_find:0.0330,umap_int32_insert:0.0657,umap_int32_erase:0.0345,umap_int32_mem:83512,umap_uint64_find:0.0325,umap_uint64_insert:0.0637,umap_uint64_erase:0.0339,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0546,kntrie_int32_insert:0.2776,kntrie_int32_erase:0.0781,kntrie_int32_mem:49176,kntrie_uint64_find:0.0547,kntrie_uint64_insert:0.2685,kntrie_uint64_erase:0.0802,kntrie_uint64_mem:65560,map_int32_find:0.1207,map_int32_insert:0.4463,map_int32_erase:0.2314,map_int32_mem:184512,map_uint64_find:0.1183,map_uint64_insert:0.4403,map_uint64_erase:0.2289,map_uint64_mem:184512,umap_int32_find:0.0533,umap_int32_insert:0.1039,umap_int32_erase:0.0614,umap_int32_mem:124472,umap_uint64_find:0.0523,umap_uint64_insert:0.0998,umap_uint64_erase:0.0535,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0790,kntrie_int32_insert:0.4971,kntrie_int32_erase:0.1474,kntrie_int32_mem:102616,kntrie_uint64_find:0.0805,kntrie_uint64_insert:0.4703,kntrie_uint64_erase:0.1550,kntrie_uint64_mem:133656,map_int32_find:0.2017,map_int32_insert:0.7233,map_int32_erase:0.3913,map_int32_mem:276768,map_uint64_find:0.1889,map_uint64_insert:0.7211,map_uint64_erase:0.3775,map_uint64_mem:276768,umap_int32_find:0.0818,umap_int32_insert:0.1597,umap_int32_erase:0.0835,umap_int32_mem:186008,umap_uint64_find:0.0822,umap_uint64_insert:0.1550,umap_uint64_erase:0.0839,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1598,kntrie_int32_insert:0.7086,kntrie_int32_erase:0.2161,kntrie_int32_mem:160024,kntrie_uint64_find:0.1582,kntrie_uint64_insert:0.6884,kntrie_uint64_erase:0.2191,kntrie_uint64_mem:216600,map_int32_find:0.3385,map_int32_insert:1.1831,map_int32_erase:0.6377,map_int32_mem:415152,map_uint64_find:0.3267,map_uint64_insert:1.1962,map_uint64_erase:0.6159,map_uint64_mem:415152,umap_int32_find:0.1283,umap_int32_insert:0.2479,umap_int32_erase:0.1295,umap_int32_mem:277840,umap_uint64_find:0.1253,umap_uint64_insert:0.2329,umap_uint64_erase:0.1301,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.1952,kntrie_int32_insert:0.9489,kntrie_int32_erase:0.2993,kntrie_int32_mem:209944,kntrie_uint64_find:0.2020,kntrie_uint64_insert:0.9915,kntrie_uint64_erase:0.3270,kntrie_uint64_mem:277016,map_int32_find:0.5702,map_int32_insert:1.8859,map_int32_erase:1.0109,map_int32_mem:622752,map_uint64_find:0.5399,map_uint64_insert:1.8469,map_uint64_erase:1.0082,map_uint64_mem:622752,umap_int32_find:0.2066,umap_int32_insert:0.3845,umap_int32_erase:0.2048,umap_int32_mem:415240,umap_uint64_find:0.1953,umap_uint64_insert:0.3552,umap_uint64_erase:0.1959,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.3413,kntrie_int32_insert:1.4151,kntrie_int32_erase:0.4512,kntrie_int32_mem:382744,kntrie_uint64_find:0.3623,kntrie_uint64_insert:1.4549,kntrie_uint64_erase:0.5135,kntrie_uint64_mem:505880,map_int32_find:0.9333,map_int32_insert:2.8936,map_int32_erase:1.6386,map_int32_mem:934128,map_uint64_find:0.9281,map_uint64_insert:3.0039,map_uint64_erase:1.6695,map_uint64_mem:934128,umap_int32_find:0.3002,umap_int32_insert:0.5317,umap_int32_erase:0.2999,umap_int32_mem:633088,umap_uint64_find:0.2929,umap_uint64_insert:0.5457,umap_uint64_erase:0.3061,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.5475,kntrie_int32_insert:2.1431,kntrie_int32_erase:0.6938,kntrie_int32_mem:446488,kntrie_uint64_find:0.5535,kntrie_uint64_insert:2.1349,kntrie_uint64_erase:0.7261,kntrie_uint64_mem:570392,map_int32_find:1.7126,map_int32_insert:5.0631,map_int32_erase:2.9510,map_int32_mem:1401216,map_uint64_find:1.6682,map_uint64_insert:5.7322,map_uint64_erase:2.9661,map_uint64_mem:1401216,umap_int32_find:0.4675,umap_int32_insert:0.8111,umap_int32_erase:0.4805,umap_int32_mem:946424,umap_uint64_find:0.4741,umap_uint64_insert:0.8275,umap_uint64_erase:0.4856,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:0.8801,kntrie_int32_insert:3.2037,kntrie_int32_erase:1.1066,kntrie_int32_mem:793624,kntrie_uint64_find:0.9551,kntrie_uint64_insert:3.2602,kntrie_uint64_erase:1.2335,kntrie_uint64_mem:1055768,map_int32_find:3.0402,map_int32_insert:8.6925,map_int32_erase:5.3255,map_int32_mem:2101872,map_uint64_find:3.1816,map_uint64_insert:10.1796,map_uint64_erase:5.4736,map_uint64_mem:2101872,umap_int32_find:0.7790,umap_int32_insert:1.3692,umap_int32_erase:0.8696,umap_int32_mem:1414784,umap_uint64_find:0.7890,umap_uint64_insert:1.3215,umap_uint64_erase:0.9146,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.7125,kntrie_int32_insert:5.4157,kntrie_int32_erase:1.5336,kntrie_int32_mem:1165336,kntrie_uint64_find:2.0841,kntrie_uint64_insert:5.5183,kntrie_uint64_erase:1.7910,kntrie_uint64_mem:1575960,map_int32_find:5.6358,map_int32_insert:14.3327,map_int32_erase:9.4632,map_int32_mem:3152832,map_uint64_find:5.7397,map_uint64_insert:18.4143,map_uint64_erase:9.6259,map_uint64_mem:3152832,umap_int32_find:1.3494,umap_int32_insert:2.2757,umap_int32_erase:1.6113,umap_int32_mem:2114872,umap_uint64_find:1.4731,umap_uint64_insert:2.5543,umap_uint64_erase:1.7853,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.5427,kntrie_int32_insert:7.5777,kntrie_int32_erase:2.7892,kntrie_int32_mem:1580056,map_int32_find:9.9342,map_int32_insert:25.2423,map_int32_erase:16.3517,map_int32_mem:4729104,umap_int32_find:2.3321,umap_int32_insert:4.2706,umap_int32_erase:2.9553,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:4.0865,kntrie_uint64_insert:8.2821,kntrie_uint64_erase:3.7367,kntrie_uint64_mem:2104344,map_uint64_find:10.9377,map_uint64_insert:30.2913,map_uint64_erase:16.9068,map_uint64_mem:4729248,umap_uint64_find:2.3414,umap_uint64_insert:4.5341,umap_uint64_erase:3.2340,umap_uint64_mem:3162488},
  {pattern:"random",N:147785,kntrie_int32_find:6.1640,kntrie_int32_insert:13.5328,kntrie_int32_erase:4.2848,kntrie_int32_mem:3152920,map_int32_find:22.3731,map_int32_insert:51.1926,map_int32_erase:35.8868,map_int32_mem:7093680,umap_int32_find:3.7641,umap_int32_insert:8.2248,umap_int32_erase:5.4799,umap_int32_mem:4729184},
  {pattern:"random",N:147789,kntrie_uint64_find:9.7044,kntrie_uint64_insert:14.1653,kntrie_uint64_erase:6.5223,kntrie_uint64_mem:4185112,map_uint64_find:19.3350,map_uint64_insert:54.2190,map_uint64_erase:32.4801,map_uint64_mem:7093872,umap_uint64_find:3.6985,umap_uint64_insert:7.7095,umap_uint64_erase:5.0460,umap_uint64_mem:4729280},
  {pattern:"random",N:221675,kntrie_int32_find:9.4590,kntrie_int32_insert:20.1063,kntrie_int32_erase:7.8289,kntrie_int32_mem:3152920,map_int32_find:36.6919,map_int32_insert:82.7378,map_int32_erase:61.0074,map_int32_mem:10640400,umap_int32_find:6.1125,umap_int32_insert:14.4683,umap_int32_erase:9.4304,umap_int32_mem:7215376},
  {pattern:"random",N:221683,kntrie_uint64_find:14.4823,kntrie_uint64_insert:23.9265,kntrie_uint64_erase:12.0313,kntrie_uint64_mem:4201496,map_uint64_find:38.9934,map_uint64_insert:93.7162,map_uint64_erase:55.0512,map_uint64_mem:10640784,umap_uint64_find:6.2843,umap_uint64_insert:14.3664,umap_uint64_erase:9.2442,umap_uint64_mem:7215568},
  {pattern:"random",N:332509,kntrie_int32_find:24.6914,kntrie_int32_insert:34.6880,kntrie_int32_erase:15.3770,kntrie_int32_mem:6298648,map_int32_find:65.7157,map_int32_insert:157.5352,map_int32_erase:101.1056,map_int32_mem:15960432,umap_int32_find:10.1450,umap_int32_insert:22.8574,umap_int32_erase:14.2305,umap_int32_mem:10788704},
  {pattern:"random",N:332525,kntrie_uint64_find:34.4610,kntrie_uint64_insert:45.9603,kntrie_uint64_erase:24.2100,kntrie_uint64_mem:8395800,map_uint64_find:66.7200,map_uint64_insert:173.3131,map_uint64_erase:96.2662,map_uint64_mem:15961200,umap_uint64_find:9.9109,umap_uint64_insert:22.6191,umap_uint64_erase:14.2934,umap_uint64_mem:10789088},
  {pattern:"random",N:498753,kntrie_int32_find:34.7702,kntrie_int32_insert:67.6533,kntrie_int32_erase:25.8961,kntrie_int32_mem:6446104,map_int32_find:116.2282,map_int32_insert:258.7164,map_int32_erase:169.3093,map_int32_mem:23940144,umap_int32_find:16.0288,umap_int32_insert:38.0474,umap_int32_erase:23.0451,umap_int32_mem:16132000},
  {pattern:"random",N:498788,kntrie_uint64_find:53.1389,kntrie_uint64_insert:92.2207,kntrie_uint64_erase:40.9513,kntrie_uint64_mem:8526872,map_uint64_find:136.6703,map_uint64_insert:322.6571,map_uint64_erase:181.8703,map_uint64_mem:23941824,umap_uint64_find:15.5701,umap_uint64_insert:37.3150,umap_uint64_erase:22.9820,umap_uint64_mem:16132840},
  {pattern:"random",N:748117,kntrie_int32_find:76.9898,kntrie_int32_insert:119.6839,kntrie_int32_erase:51.7320,kntrie_int32_mem:12590104,map_int32_find:204.4922,map_int32_insert:478.1546,map_int32_erase:284.7981,map_int32_mem:35909616,umap_int32_find:24.8679,umap_int32_insert:65.0518,umap_int32_erase:39.8921,umap_int32_mem:24123200},
  {pattern:"random",N:748182,kntrie_uint64_find:97.1243,kntrie_uint64_insert:148.4990,kntrie_uint64_erase:71.0322,kntrie_uint64_mem:16784408,map_uint64_find:221.9812,map_uint64_insert:618.6581,map_uint64_erase:316.9029,map_uint64_mem:35912736,umap_uint64_find:24.9482,umap_uint64_insert:61.7820,umap_uint64_erase:39.9415,umap_uint64_mem:24124760},
  {pattern:"random",N:1122145,kntrie_int32_find:90.4786,kntrie_int32_insert:273.3482,kntrie_int32_erase:77.8564,kntrie_int32_mem:17970520,umap_int32_find:40.0794,umap_int32_insert:96.4933,umap_int32_erase:60.1508,umap_int32_mem:36074048},
  {pattern:"random",N:1122274,kntrie_uint64_find:102.9320,kntrie_uint64_insert:330.7060,kntrie_uint64_erase:86.0485,kntrie_uint64_mem:27670296,umap_uint64_find:39.4437,umap_uint64_insert:98.8400,umap_uint64_erase:58.4769,umap_uint64_mem:36077144},
  {pattern:"random",N:1683111,kntrie_int32_find:140.9381,kntrie_int32_insert:343.6842,kntrie_int32_erase:116.2166,kntrie_int32_mem:24467080,umap_int32_find:63.3297,umap_int32_insert:154.9477,umap_int32_erase:90.5821,umap_int32_mem:53945536},
  {pattern:"random",N:1683411,kntrie_uint64_find:196.1185,kntrie_uint64_insert:487.8885,kntrie_uint64_erase:148.9623,kntrie_uint64_mem:38038552,umap_uint64_find:62.2630,umap_uint64_insert:170.1772,umap_uint64_erase:94.8288,umap_uint64_mem:53952736},
  {pattern:"random",N:2524384,kntrie_int32_find:251.9006,kntrie_int32_insert:516.3183,kntrie_int32_erase:197.6842,kntrie_int32_mem:40317400,umap_int32_find:97.1462,umap_int32_insert:246.5861,umap_int32_erase:156.0755,umap_int32_mem:82315208},
  {pattern:"random",N:2525116,kntrie_uint64_find:339.0927,kntrie_uint64_insert:689.3550,kntrie_uint64_erase:270.9093,kntrie_uint64_mem:63405336,umap_uint64_find:96.9910,umap_uint64_insert:236.7355,umap_uint64_erase:148.3648,umap_uint64_mem:82332776},
  {pattern:"random",N:3786033,kntrie_int32_find:398.1174,kntrie_int32_insert:784.3523,kntrie_int32_erase:310.2685,kntrie_int32_mem:51616280,umap_int32_find:157.6301,umap_int32_insert:377.5127,umap_int32_erase:238.6109,umap_int32_mem:123073040},
  {pattern:"random",N:3787675,kntrie_uint64_find:553.4598,kntrie_uint64_insert:1082.3703,kntrie_uint64_erase:444.2327,kntrie_uint64_mem:81562648,umap_uint64_find:156.5744,umap_uint64_insert:384.0556,umap_uint64_erase:234.6313,umap_uint64_mem:123112448},
  {pattern:"random",N:5677748,kntrie_int32_find:658.8008,kntrie_int32_insert:1185.5834,kntrie_int32_erase:501.6153,kntrie_int32_mem:85417240,umap_int32_find:282.0789,umap_int32_insert:697.5132,umap_int32_erase:401.0750,umap_int32_mem:184004728},
  {pattern:"random",N:5681512,kntrie_uint64_find:764.4313,kntrie_uint64_insert:1519.0019,kntrie_uint64_erase:681.8368,kntrie_uint64_mem:135633944,umap_uint64_find:279.2735,umap_uint64_insert:628.4846,umap_uint64_erase:402.4392,umap_uint64_mem:184095064},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0008,kntrie_int32_insert:0.0057,kntrie_int32_erase:0.0027,kntrie_int32_mem:1560,kntrie_uint64_find:0.0008,kntrie_uint64_insert:0.0055,kntrie_uint64_erase:0.0032,kntrie_uint64_mem:2072,map_int32_find:0.0013,map_int32_insert:0.0088,map_int32_erase:0.0051,map_int32_mem:4800,map_uint64_find:0.0012,map_uint64_insert:0.0085,map_uint64_erase:0.0057,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0013,umap_int32_erase:0.0010,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0014,umap_uint64_erase:0.0012,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0014,kntrie_int32_insert:0.0086,kntrie_int32_erase:0.0036,kntrie_int32_mem:3096,kntrie_uint64_find:0.0013,kntrie_uint64_insert:0.0093,kntrie_uint64_erase:0.0046,kntrie_uint64_mem:4120,map_int32_find:0.0023,map_int32_insert:0.0127,map_int32_erase:0.0074,map_int32_mem:7200,map_uint64_find:0.0023,map_uint64_insert:0.0125,map_uint64_erase:0.0079,map_uint64_mem:7200,umap_int32_find:0.0005,umap_int32_insert:0.0038,umap_int32_erase:0.0015,umap_int32_mem:4856,umap_uint64_find:0.0005,umap_uint64_insert:0.0035,umap_uint64_erase:0.0017,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0020,kntrie_int32_insert:0.0136,kntrie_int32_erase:0.0049,kntrie_int32_mem:3096,kntrie_uint64_find:0.0020,kntrie_uint64_insert:0.0136,kntrie_uint64_erase:0.0048,kntrie_uint64_mem:4120,map_int32_find:0.0035,map_int32_insert:0.0189,map_int32_erase:0.0105,map_int32_mem:10800,map_uint64_find:0.0033,map_uint64_insert:0.0183,map_uint64_erase:0.0101,map_uint64_mem:10800,umap_int32_find:0.0007,umap_int32_insert:0.0049,umap_int32_erase:0.0014,umap_int32_mem:7216,umap_uint64_find:0.0007,umap_uint64_insert:0.0050,umap_uint64_erase:0.0012,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0034,kntrie_int32_insert:0.0197,kntrie_int32_erase:0.0072,kntrie_int32_mem:6168,kntrie_uint64_find:0.0033,kntrie_uint64_insert:0.0203,kntrie_uint64_erase:0.0076,kntrie_uint64_mem:8216,map_int32_find:0.0062,map_int32_insert:0.0289,map_int32_erase:0.0152,map_int32_mem:16176,map_uint64_find:0.0058,map_uint64_insert:0.0292,map_uint64_erase:0.0153,map_uint64_mem:16176,umap_int32_find:0.0010,umap_int32_insert:0.0075,umap_int32_erase:0.0017,umap_int32_mem:10784,umap_uint64_find:0.0010,umap_uint64_insert:0.0071,umap_uint64_erase:0.0021,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0051,kntrie_int32_insert:0.0333,kntrie_int32_erase:0.0106,kntrie_int32_mem:6168,kntrie_uint64_find:0.0050,kntrie_uint64_insert:0.0326,kntrie_uint64_erase:0.0106,kntrie_uint64_mem:8216,map_int32_find:0.0100,map_int32_insert:0.0445,map_int32_erase:0.0252,map_int32_mem:24288,map_uint64_find:0.0097,map_uint64_insert:0.0441,map_uint64_erase:0.0244,map_uint64_mem:24288,umap_int32_find:0.0015,umap_int32_insert:0.0103,umap_int32_erase:0.0032,umap_int32_mem:16472,umap_uint64_find:0.0016,umap_uint64_insert:0.0101,umap_uint64_erase:0.0034,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0087,kntrie_int32_insert:0.0447,kntrie_int32_erase:0.0169,kntrie_int32_mem:12312,kntrie_uint64_find:0.0083,kntrie_uint64_insert:0.0457,kntrie_uint64_erase:0.0179,kntrie_uint64_mem:16408,map_int32_find:0.0164,map_int32_insert:0.0689,map_int32_erase:0.0376,map_int32_mem:36432,map_uint64_find:0.0156,map_uint64_insert:0.0701,map_uint64_erase:0.0406,map_uint64_mem:36432,umap_int32_find:0.0023,umap_int32_insert:0.0159,umap_int32_erase:0.0047,umap_int32_mem:24304,umap_uint64_find:0.0024,umap_uint64_insert:0.0144,umap_uint64_erase:0.0053,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0141,kntrie_int32_insert:0.0843,kntrie_int32_erase:0.0188,kntrie_int32_mem:24600,kntrie_uint64_find:0.0140,kntrie_uint64_insert:0.0830,kntrie_uint64_erase:0.0193,kntrie_uint64_mem:32792,map_int32_find:0.0277,map_int32_insert:0.1077,map_int32_erase:0.0588,map_int32_mem:54672,map_uint64_find:0.0270,map_uint64_insert:0.1100,map_uint64_erase:0.0585,map_uint64_mem:54672,umap_int32_find:0.0036,umap_int32_insert:0.0285,umap_int32_erase:0.0104,umap_int32_mem:36880,umap_uint64_find:0.0035,umap_uint64_insert:0.0204,umap_uint64_erase:0.0062,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0214,kntrie_int32_insert:0.1107,kntrie_int32_erase:0.0349,kntrie_int32_mem:24600,kntrie_uint64_find:0.0209,kntrie_uint64_insert:0.1012,kntrie_uint64_erase:0.0344,kntrie_uint64_mem:32792,map_int32_find:0.0458,map_int32_insert:0.1691,map_int32_erase:0.0917,map_int32_mem:81984,map_uint64_find:0.0429,map_uint64_insert:0.1719,map_uint64_erase:0.0900,map_uint64_mem:81984,umap_int32_find:0.0052,umap_int32_insert:0.0303,umap_int32_erase:0.0100,umap_int32_mem:54920,umap_uint64_find:0.0052,umap_uint64_insert:0.0289,umap_uint64_erase:0.0095,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0354,kntrie_int32_insert:0.1852,kntrie_int32_erase:0.0491,kntrie_int32_mem:49176,kntrie_uint64_find:0.0380,kntrie_uint64_insert:0.1783,kntrie_uint64_erase:0.0556,kntrie_uint64_mem:65560,map_int32_find:0.0784,map_int32_insert:0.2733,map_int32_erase:0.1467,map_int32_mem:122976,map_uint64_find:0.0724,map_uint64_insert:0.2913,map_uint64_erase:0.1534,map_uint64_mem:122976,umap_int32_find:0.0079,umap_int32_insert:0.0463,umap_int32_erase:0.0163,umap_int32_mem:83512,umap_uint64_find:0.0079,umap_uint64_insert:0.0421,umap_uint64_erase:0.0155,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0541,kntrie_int32_insert:0.2901,kntrie_int32_erase:0.0771,kntrie_int32_mem:49176,kntrie_uint64_find:0.0592,kntrie_uint64_insert:0.2848,kntrie_uint64_erase:0.0883,kntrie_uint64_mem:65560,map_int32_find:0.1297,map_int32_insert:0.4424,map_int32_erase:0.2375,map_int32_mem:184512,map_uint64_find:0.1288,map_uint64_insert:0.4553,map_uint64_erase:0.2436,map_uint64_mem:184512,umap_int32_find:0.0118,umap_int32_insert:0.0650,umap_int32_erase:0.0251,umap_int32_mem:124472,umap_uint64_find:0.0120,umap_uint64_insert:0.0611,umap_uint64_erase:0.0245,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0393,kntrie_int32_insert:0.4664,kntrie_int32_erase:0.0868,kntrie_int32_mem:69752,kntrie_uint64_find:0.0496,kntrie_uint64_insert:0.4819,kntrie_uint64_erase:0.0995,kntrie_uint64_mem:69752,map_int32_find:0.2111,map_int32_insert:0.7337,map_int32_erase:0.4064,map_int32_mem:276768,map_uint64_find:0.2053,map_uint64_insert:0.7467,map_uint64_erase:0.3953,map_uint64_mem:276768,umap_int32_find:0.0180,umap_int32_insert:0.0945,umap_int32_erase:0.0388,umap_int32_mem:186008,umap_uint64_find:0.0183,umap_uint64_insert:0.0883,umap_uint64_erase:0.0395,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.0615,kntrie_int32_insert:0.5779,kntrie_int32_erase:0.1390,kntrie_int32_mem:104360,kntrie_uint64_find:0.0760,kntrie_uint64_insert:0.5730,kntrie_uint64_erase:0.1618,kntrie_uint64_mem:104360,map_int32_find:0.3553,map_int32_insert:1.1790,map_int32_erase:0.6344,map_int32_mem:415152,map_uint64_find:0.3429,map_uint64_insert:1.1991,map_uint64_erase:0.6351,map_uint64_mem:415152,umap_int32_find:0.0270,umap_int32_insert:0.1460,umap_int32_erase:0.0588,umap_int32_mem:277840,umap_uint64_find:0.0272,umap_uint64_insert:0.1314,umap_uint64_erase:0.0601,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.0893,kntrie_int32_insert:0.7652,kntrie_int32_erase:0.2115,kntrie_int32_mem:156472,kntrie_uint64_find:0.1134,kntrie_uint64_insert:0.7788,kntrie_uint64_erase:0.2450,kntrie_uint64_mem:156472,map_int32_find:0.5758,map_int32_insert:1.8460,map_int32_erase:1.0311,map_int32_mem:622752,map_uint64_find:0.5603,map_uint64_insert:1.9007,map_uint64_erase:1.0267,map_uint64_mem:622752,umap_int32_find:0.0394,umap_int32_insert:0.1992,umap_int32_erase:0.0904,umap_int32_mem:415240,umap_uint64_find:0.0396,umap_uint64_insert:0.1961,umap_uint64_erase:0.0879,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.1362,kntrie_int32_insert:1.0237,kntrie_int32_erase:0.3365,kntrie_int32_mem:235576,kntrie_uint64_find:0.1719,kntrie_uint64_insert:1.1006,kntrie_uint64_erase:0.3744,kntrie_uint64_mem:235576,map_int32_find:0.9379,map_int32_insert:2.9691,map_int32_erase:1.6409,map_int32_mem:934128,map_uint64_find:0.9306,map_uint64_insert:3.0459,map_uint64_erase:1.6675,map_uint64_mem:934128,umap_int32_find:0.0595,umap_int32_insert:0.3100,umap_int32_erase:0.1407,umap_int32_mem:633088,umap_uint64_find:0.0603,umap_uint64_insert:0.2925,umap_uint64_erase:0.1399,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.2134,kntrie_int32_insert:1.3750,kntrie_int32_erase:0.5337,kntrie_int32_mem:353176,kntrie_uint64_find:0.2759,kntrie_uint64_insert:1.4784,kntrie_uint64_erase:0.6000,kntrie_uint64_mem:353176,map_int32_find:1.7318,map_int32_insert:4.9732,map_int32_erase:2.9281,map_int32_mem:1401216,map_uint64_find:1.7396,map_uint64_insert:5.1205,map_uint64_erase:3.0342,map_uint64_mem:1401216,umap_int32_find:0.1251,umap_int32_insert:0.4497,umap_int32_erase:0.2490,umap_int32_mem:946424,umap_uint64_find:0.1062,umap_uint64_insert:0.4261,umap_uint64_erase:0.2201,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.3428,kntrie_int32_insert:2.0143,kntrie_int32_erase:0.8260,kntrie_int32_mem:529816,kntrie_uint64_find:0.4036,kntrie_uint64_insert:2.2387,kntrie_uint64_erase:0.8512,kntrie_uint64_mem:529816,map_int32_find:3.2389,map_int32_insert:8.3288,map_int32_erase:5.2566,map_int32_mem:2101872,map_uint64_find:3.2752,map_uint64_insert:8.4624,map_uint64_erase:5.4492,map_uint64_mem:2101872,umap_int32_find:0.2397,umap_int32_insert:0.6872,umap_int32_erase:0.4987,umap_int32_mem:1414784,umap_uint64_find:0.2937,umap_uint64_insert:0.6255,umap_uint64_erase:0.6353,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:0.7727,kntrie_int32_insert:3.4843,kntrie_int32_erase:1.5454,kntrie_int32_mem:796296,kntrie_uint64_find:0.8500,kntrie_uint64_insert:3.4221,kntrie_uint64_erase:1.5985,kntrie_uint64_mem:796296,map_int32_find:6.1052,map_int32_insert:16.7129,map_int32_erase:10.6013,map_int32_mem:3152832,map_uint64_find:6.1591,map_uint64_insert:15.3678,map_uint64_erase:9.4919,map_uint64_mem:3152832,umap_int32_find:0.5057,umap_int32_insert:1.0807,umap_int32_erase:1.1464,umap_int32_mem:2114872,umap_uint64_find:0.5611,umap_uint64_insert:0.9902,umap_uint64_erase:1.2320,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.2196,kntrie_int32_insert:5.4926,kntrie_int32_erase:2.3730,kntrie_int32_mem:1192584,kntrie_uint64_find:1.4684,kntrie_uint64_insert:5.9289,kntrie_uint64_erase:2.6047,kntrie_uint64_mem:1192584,map_int32_find:10.4150,map_int32_insert:28.3897,map_int32_erase:17.0894,map_int32_mem:4729248,map_uint64_find:11.3135,map_uint64_insert:29.4083,map_uint64_erase:18.4730,map_uint64_mem:4729248,umap_int32_find:0.9107,umap_int32_insert:1.7348,umap_int32_erase:1.9560,umap_int32_mem:3162488,umap_uint64_find:0.9785,umap_uint64_insert:2.0444,umap_uint64_erase:2.1174,umap_uint64_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_int32_find:2.1819,kntrie_int32_insert:8.6936,kntrie_int32_erase:3.7642,kntrie_int32_mem:1789624,kntrie_uint64_find:2.9117,kntrie_uint64_insert:9.1796,kntrie_uint64_erase:4.0595,kntrie_uint64_mem:1789624,map_int32_find:22.7077,map_int32_insert:48.7812,map_int32_erase:35.1342,map_int32_mem:7093872,map_uint64_find:21.0036,map_uint64_insert:50.7601,map_uint64_erase:34.7496,map_uint64_mem:7093872,umap_int32_find:1.6162,umap_int32_insert:3.5906,umap_int32_erase:3.7153,umap_int32_mem:4729280,umap_uint64_find:1.5074,umap_uint64_insert:3.5369,umap_uint64_erase:3.4469,umap_uint64_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_int32_find:4.2662,kntrie_int32_insert:13.6631,kntrie_int32_erase:5.9835,kntrie_int32_mem:2683560,kntrie_uint64_find:4.6232,kntrie_uint64_insert:14.5349,kntrie_uint64_erase:6.4350,kntrie_uint64_mem:2683560,map_int32_find:36.4963,map_int32_insert:83.1760,map_int32_erase:54.8467,map_int32_mem:10640784,map_uint64_find:36.9900,map_uint64_insert:87.7197,map_uint64_erase:56.7214,map_uint64_mem:10640784,umap_int32_find:2.6532,umap_int32_insert:6.0017,umap_int32_erase:6.0647,umap_int32_mem:7215568,umap_uint64_find:2.3952,umap_uint64_insert:5.7994,umap_uint64_erase:5.4477,umap_uint64_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_int32_find:7.5075,kntrie_int32_insert:21.2983,kntrie_int32_erase:10.7832,kntrie_int32_mem:4026040,kntrie_uint64_find:8.9807,kntrie_uint64_insert:23.2308,kntrie_uint64_erase:12.5956,kntrie_uint64_mem:4026040,map_int32_find:70.7255,map_int32_insert:163.0534,map_int32_erase:101.4884,map_int32_mem:15961200,map_uint64_find:70.0138,map_uint64_insert:155.1735,map_uint64_erase:102.7590,map_uint64_mem:15961200,umap_int32_find:4.4551,umap_int32_insert:9.9504,umap_int32_erase:10.2745,umap_int32_mem:10789088,umap_uint64_find:4.1953,umap_uint64_insert:9.9979,umap_uint64_erase:9.9800,umap_uint64_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_int32_find:13.0449,kntrie_int32_insert:35.0897,kntrie_int32_erase:21.0900,kntrie_int32_mem:6039752,kntrie_uint64_find:14.6661,kntrie_uint64_insert:38.3894,kntrie_uint64_erase:21.6186,kntrie_uint64_mem:6039752,map_int32_find:118.2368,map_int32_insert:257.8114,map_int32_erase:168.6871,map_int32_mem:23941824,map_uint64_find:113.2348,map_uint64_insert:259.6685,map_uint64_erase:168.9760,map_uint64_mem:23941824,umap_int32_find:6.7997,umap_int32_insert:16.1038,umap_int32_erase:16.1699,umap_int32_mem:16132840,umap_uint64_find:6.7172,umap_uint64_insert:15.3217,umap_uint64_erase:15.9289,umap_uint64_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_int32_find:22.6988,kntrie_int32_insert:66.6219,kntrie_int32_erase:41.3244,kntrie_int32_mem:9059896,kntrie_uint64_find:24.1958,kntrie_uint64_insert:65.2637,kntrie_uint64_erase:42.5773,kntrie_uint64_mem:9059896,map_int32_find:211.1910,map_int32_insert:501.2817,map_int32_erase:294.1618,map_int32_mem:35912736,map_uint64_find:218.7308,map_uint64_insert:456.1606,map_uint64_erase:291.9867,map_uint64_mem:35912736,umap_int32_find:11.5872,umap_int32_insert:26.0117,umap_int32_erase:26.8654,umap_int32_mem:24124760,umap_uint64_find:11.4400,umap_uint64_insert:25.1129,umap_uint64_erase:25.7151,umap_uint64_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_int32_find:36.7569,kntrie_int32_insert:114.6805,kntrie_int32_erase:76.1616,kntrie_int32_mem:13589864,kntrie_uint64_find:40.1281,kntrie_uint64_insert:123.5851,kntrie_uint64_erase:75.3938,kntrie_uint64_mem:13589864,umap_int32_find:18.5523,umap_int32_insert:42.7947,umap_int32_erase:42.2227,umap_int32_mem:36077144,umap_uint64_find:18.2447,umap_uint64_insert:43.0038,umap_uint64_erase:42.9681,umap_uint64_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_int32_find:65.5443,kntrie_int32_insert:201.8193,kntrie_int32_erase:130.8227,kntrie_int32_mem:20384808,kntrie_uint64_find:73.4469,kntrie_uint64_insert:213.1160,kntrie_uint64_erase:131.5771,kntrie_uint64_mem:20384808,umap_int32_find:30.7199,umap_int32_insert:68.1276,umap_int32_erase:67.4803,umap_int32_mem:53952736,umap_uint64_find:29.7480,umap_uint64_insert:66.8564,umap_uint64_erase:65.5697,umap_uint64_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_int32_find:123.1363,kntrie_int32_insert:355.6113,kntrie_int32_erase:226.4192,kntrie_int32_mem:30577800,kntrie_uint64_find:128.2399,kntrie_uint64_insert:350.9497,kntrie_uint64_erase:224.8511,kntrie_uint64_mem:30577800,umap_int32_find:46.6600,umap_int32_insert:107.3075,umap_int32_erase:106.0907,umap_int32_mem:82332776,umap_uint64_find:52.7435,umap_uint64_insert:112.5829,umap_uint64_erase:120.6629,umap_uint64_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_int32_find:211.9872,kntrie_int32_insert:602.4089,kntrie_int32_erase:363.9451,kntrie_int32_mem:45867368,kntrie_uint64_find:230.6733,kntrie_uint64_insert:610.0186,kntrie_uint64_erase:387.6081,kntrie_uint64_mem:45867368,umap_int32_find:78.1377,umap_int32_insert:161.6804,umap_int32_erase:163.5100,umap_int32_mem:123112448,umap_uint64_find:81.2355,umap_uint64_insert:164.7974,umap_uint64_erase:165.3486,umap_uint64_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_int32_find:360.2295,kntrie_int32_insert:1002.5292,kntrie_int32_erase:626.0952,kntrie_int32_mem:68800920,kntrie_uint64_find:378.0173,kntrie_uint64_insert:1014.8292,kntrie_uint64_erase:616.9888,kntrie_uint64_mem:68800920,umap_int32_find:143.4532,umap_int32_insert:294.0950,umap_int32_erase:280.5505,umap_int32_mem:184095064,umap_uint64_find:146.6223,umap_uint64_insert:276.1987,umap_uint64_erase:281.3233,umap_uint64_mem:184095064},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
