<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64 &rarr; i32)</h2>
  <p class="sub">Log-log &middot; Per-entry &middot; Lower is better &middot; FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0007,kntrie_nf:0.0007,kntrie_insert:0.0108,kntrie_erase:0.0063,kntrie_iter:0.0024,kntrie_mem:1544,map_fnd:0.0034,map_nf:0.0025,map_insert:0.0116,map_erase:0.0064,map_iter:0.0013,map_mem:4800,umap_fnd:0.0012,umap_nf:0.0018,umap_insert:0.0043,umap_erase:0.0031,umap_iter:0.0002,umap_mem:3224,kntrie_mempre:2024},
  {pattern:"random",N:150,kntrie_fnd:0.0011,kntrie_nf:0.0010,kntrie_insert:0.0135,kntrie_erase:0.0063,kntrie_iter:0.0041,kntrie_mem:3080,map_fnd:0.0055,map_nf:0.0046,map_insert:0.0165,map_erase:0.0089,map_iter:0.0017,map_mem:7200,umap_fnd:0.0017,umap_nf:0.0021,umap_insert:0.0061,umap_erase:0.0034,umap_iter:0.0003,umap_mem:4856,kntrie_mempre:3560},
  {pattern:"random",N:225,kntrie_fnd:0.0017,kntrie_nf:0.0016,kntrie_insert:0.0161,kntrie_erase:0.0078,kntrie_iter:0.0057,kntrie_mem:3080,map_fnd:0.0091,map_nf:0.0081,map_insert:0.0236,map_erase:0.0123,map_iter:0.0022,map_mem:10800,umap_fnd:0.0029,umap_nf:0.0039,umap_insert:0.0084,umap_erase:0.0047,umap_iter:0.0004,umap_mem:7216,kntrie_mempre:3560},
  {pattern:"random",N:337,kntrie_fnd:0.0028,kntrie_nf:0.0025,kntrie_insert:0.0255,kntrie_erase:0.0100,kntrie_iter:0.0094,kntrie_mem:6152,map_fnd:0.0146,map_nf:0.0134,map_insert:0.0351,map_erase:0.0179,map_iter:0.0034,map_mem:16176,umap_fnd:0.0038,umap_nf:0.0062,umap_insert:0.0114,umap_erase:0.0053,umap_iter:0.0005,umap_mem:10784,kntrie_mempre:6632},
  {pattern:"random",N:506,kntrie_fnd:0.0042,kntrie_nf:0.0037,kntrie_insert:0.0398,kntrie_erase:0.0133,kntrie_iter:0.0139,kntrie_mem:6152,map_fnd:0.0239,map_nf:0.0212,map_insert:0.0519,map_erase:0.0262,map_iter:0.0049,map_mem:24288,umap_fnd:0.0055,umap_nf:0.0086,umap_insert:0.0159,umap_erase:0.0072,umap_iter:0.0008,umap_mem:16472,kntrie_mempre:6632},
  {pattern:"random",N:759,kntrie_fnd:0.0071,kntrie_nf:0.0064,kntrie_insert:0.0522,kntrie_erase:0.0201,kntrie_iter:0.0230,kntrie_mem:12296,map_fnd:0.0389,map_nf:0.0367,map_insert:0.0798,map_erase:0.0411,map_iter:0.0075,map_mem:36432,umap_fnd:0.0091,umap_nf:0.0142,umap_insert:0.0232,umap_erase:0.0109,umap_iter:0.0013,umap_mem:24304,kntrie_mempre:12776},
  {pattern:"random",N:1139,kntrie_fnd:0.0122,kntrie_nf:0.0109,kntrie_insert:0.0820,kntrie_erase:0.0217,kntrie_iter:0.0370,kntrie_mem:24584,map_fnd:0.0662,map_nf:0.0646,map_insert:0.1227,map_erase:0.0629,map_iter:0.0138,map_mem:54672,umap_fnd:0.0132,umap_nf:0.0201,umap_insert:0.0320,umap_erase:0.0149,umap_iter:0.0023,umap_mem:36880,kntrie_mempre:25064},
  {pattern:"random",N:1708,kntrie_fnd:0.0181,kntrie_nf:0.0154,kntrie_insert:0.1092,kntrie_erase:0.0379,kntrie_iter:0.0555,kntrie_mem:24584,map_fnd:0.1082,map_nf:0.1042,map_insert:0.1866,map_erase:0.0985,map_iter:0.0185,map_mem:81984,umap_fnd:0.0216,umap_nf:0.0324,umap_insert:0.0465,umap_erase:0.0229,umap_iter:0.0044,umap_mem:54920,kntrie_mempre:25064},
  {pattern:"random",N:2562,kntrie_fnd:0.0311,kntrie_nf:0.0263,kntrie_insert:0.1900,kntrie_erase:0.0550,kntrie_iter:0.0903,kntrie_mem:49160,map_fnd:0.1788,map_nf:0.1743,map_insert:0.2826,map_erase:0.1515,map_iter:0.0281,map_mem:122976,umap_fnd:0.0327,umap_nf:0.0481,umap_insert:0.0663,umap_erase:0.0347,umap_iter:0.0074,umap_mem:83512,kntrie_mempre:49640},
  {pattern:"random",N:3844,kntrie_fnd:0.0473,kntrie_nf:0.0399,kntrie_insert:0.2696,kntrie_erase:0.0900,kntrie_iter:0.1353,kntrie_mem:49160,map_fnd:0.2898,map_nf:0.2871,map_insert:0.4562,map_erase:0.2399,map_iter:0.0422,map_mem:184512,umap_fnd:0.0526,umap_nf:0.0748,umap_insert:0.1044,umap_erase:0.0549,umap_iter:0.0127,umap_mem:124472,kntrie_mempre:49640},
  {pattern:"random",N:5766,kntrie_fnd:0.0627,kntrie_nf:0.0568,kntrie_insert:0.5187,kntrie_erase:0.1754,kntrie_iter:0.1814,kntrie_mem:100192,map_fnd:0.4873,map_nf:0.4822,map_insert:0.7300,map_erase:0.3833,map_iter:0.0648,map_mem:276768,umap_fnd:0.0823,umap_nf:0.1200,umap_insert:0.1648,umap_erase:0.0830,umap_iter:0.0206,umap_mem:186008,kntrie_mempre:124320},
  {pattern:"random",N:8649,kntrie_fnd:0.1262,kntrie_nf:0.1248,kntrie_insert:0.7022,kntrie_erase:0.2233,kntrie_iter:0.2786,kntrie_mem:162192,map_fnd:0.8043,map_nf:0.8093,map_insert:1.1464,map_erase:0.6290,map_iter:0.1041,map_mem:415152,umap_fnd:0.1253,umap_nf:0.1761,umap_insert:0.2514,umap_erase:0.1308,umap_iter:0.0322,umap_mem:277840,kntrie_mempre:192848},
  {pattern:"random",N:12974,kntrie_fnd:0.1598,kntrie_nf:0.1345,kntrie_insert:0.9757,kntrie_erase:0.3402,kntrie_iter:0.4270,kntrie_mem:207504,map_fnd:1.3252,map_nf:1.3378,map_insert:1.8373,map_erase:0.9973,map_iter:0.1615,map_mem:622752,umap_fnd:0.1949,umap_nf:0.2777,umap_insert:0.3740,umap_erase:0.2019,umap_iter:0.0504,umap_mem:415240,kntrie_mempre:235520},
  {pattern:"random",N:19461,kntrie_fnd:0.2985,kntrie_nf:0.2524,kntrie_insert:1.4594,kntrie_erase:0.5227,kntrie_iter:0.6858,kntrie_mem:379152,map_fnd:2.2871,map_nf:2.3370,map_insert:2.9209,map_erase:1.6798,map_iter:0.2692,map_mem:934128,umap_fnd:0.2929,umap_nf:0.4167,umap_insert:0.5472,umap_erase:0.3006,umap_iter:0.0802,umap_mem:633088,kntrie_mempre:409456},
  {pattern:"random",N:29192,kntrie_fnd:0.4515,kntrie_nf:0.3798,kntrie_insert:2.1589,kntrie_erase:0.7705,kntrie_iter:1.0491,kntrie_mem:427536,map_fnd:4.0587,map_nf:4.1292,map_insert:4.7100,map_erase:2.8178,map_iter:0.5804,map_mem:1401216,umap_fnd:0.4602,umap_nf:0.6435,umap_insert:0.8226,umap_erase:0.4791,umap_iter:0.1348,umap_mem:946424,kntrie_mempre:459104},
  {pattern:"random",N:43789,kntrie_fnd:0.7801,kntrie_nf:0.6699,kntrie_insert:3.3052,kntrie_erase:1.2732,kntrie_iter:1.6852,kntrie_mem:791568,map_fnd:8.7822,map_nf:7.9743,map_insert:8.2196,map_erase:5.3513,map_iter:1.7296,map_mem:2101872,umap_fnd:0.7987,umap_nf:1.0866,umap_insert:1.3965,umap_erase:0.8598,umap_iter:0.2497,umap_mem:1414784,kntrie_mempre:821056},
  {pattern:"random",N:65684,kntrie_fnd:1.4524,kntrie_nf:1.3287,kntrie_insert:5.5252,kntrie_erase:1.8840,kntrie_iter:2.6173,kntrie_mem:1181712,map_fnd:16.2768,map_nf:15.1475,map_insert:14.4789,map_erase:9.6208,map_iter:3.2163,map_mem:3152832,umap_fnd:1.4179,umap_nf:1.8612,umap_insert:2.5074,umap_erase:1.7637,umap_iter:0.4911,umap_mem:2114872,kntrie_mempre:1210656},
  {pattern:"random",N:98526,kntrie_fnd:2.7059,kntrie_nf:1.8539,kntrie_insert:8.2935,kntrie_erase:3.5688,kntrie_iter:4.0977,kntrie_mem:1578000,map_fnd:29.0421,map_nf:29.6884,map_insert:27.4507,map_erase:18.2693,map_iter:5.1626,map_mem:4729248,umap_fnd:2.3664,umap_nf:3.1044,umap_insert:4.7509,umap_erase:3.2678,umap_iter:1.1212,umap_mem:3162488,kntrie_mempre:1607216},
  {pattern:"random",N:147789,kntrie_fnd:8.6029,kntrie_nf:5.4827,kntrie_insert:14.9209,kntrie_erase:6.5811,kntrie_iter:6.5728,kntrie_mem:3138576,map_fnd:57.1387,map_nf:53.3366,map_insert:48.3519,map_erase:32.8950,map_iter:9.3558,map_mem:7093872,umap_fnd:3.8619,umap_nf:5.1424,umap_insert:8.7816,umap_erase:5.2786,umap_iter:2.3509,umap_mem:4729280,kntrie_mempre:3167920},
  {pattern:"random",N:221683,kntrie_fnd:12.5016,kntrie_nf:7.9092,kntrie_insert:24.0301,kntrie_erase:12.8288,kntrie_iter:9.7638,kntrie_mem:3150864,map_fnd:88.6291,map_nf:86.2419,map_insert:84.9549,map_erase:51.9626,map_iter:14.3297,map_mem:10640784,umap_fnd:5.9289,umap_nf:7.7216,umap_insert:14.8462,umap_erase:8.4492,umap_iter:3.8402,umap_mem:7215568,kntrie_mempre:3178560},
  {pattern:"random",N:332525,kntrie_fnd:28.5963,kntrie_nf:20.0353,kntrie_insert:44.4636,kntrie_erase:24.0700,kntrie_iter:15.6647,kntrie_mem:6296592,map_fnd:168.3551,map_nf:166.6608,map_insert:146.5159,map_erase:94.2329,map_iter:25.6940,map_mem:15961200,umap_fnd:10.7604,umap_nf:13.2343,umap_insert:25.5323,umap_erase:15.9979,umap_iter:7.7966,umap_mem:10789088,kntrie_mempre:6326352},
  {pattern:"random",N:498788,kntrie_fnd:36.7512,kntrie_nf:25.5426,kntrie_insert:82.4938,kntrie_erase:42.4880,kntrie_iter:23.2497,kntrie_mem:6394896,map_fnd:272.2195,map_nf:279.7728,map_insert:246.7481,map_erase:157.1748,map_iter:38.4937,map_mem:23941824,umap_fnd:17.1099,umap_nf:21.2640,umap_insert:40.6506,umap_erase:25.6628,umap_iter:12.8934,umap_mem:16132840,kntrie_mempre:6424048},
  {pattern:"random",N:748182,kntrie_fnd:83.4783,kntrie_nf:63.0006,kntrie_insert:142.8290,kntrie_erase:71.8349,kntrie_iter:37.2978,kntrie_mem:12588048,map_fnd:453.2481,map_nf:465.8045,map_insert:402.7752,map_erase:260.8919,map_iter:58.9223,map_mem:35912736,umap_fnd:25.5764,umap_nf:31.6844,umap_insert:58.5685,umap_erase:35.3917,umap_iter:19.2315,umap_mem:24124760,kntrie_mempre:12618080},
  {pattern:"random",N:1122274,kntrie_fnd:82.2363,kntrie_nf:70.7448,kntrie_insert:309.5116,kntrie_erase:120.5890,kntrie_iter:41.0278,kntrie_mem:20952504,umap_fnd:43.0554,umap_nf:49.7757,umap_insert:104.3343,umap_erase:58.6731,umap_iter:36.2208,umap_mem:36077144,kntrie_mempre:21568440},
  {pattern:"random",N:1683411,kntrie_fnd:156.6843,kntrie_nf:133.5607,kntrie_insert:442.9228,kntrie_erase:207.9492,kntrie_iter:73.2118,kntrie_mem:28480560,umap_fnd:62.7236,umap_nf:74.0968,umap_insert:181.2860,umap_erase:90.8201,umap_iter:50.9246,umap_mem:53952736,kntrie_mempre:34870096},
  {pattern:"random",N:2525116,kntrie_fnd:251.8694,kntrie_nf:201.6641,kntrie_insert:593.2960,kntrie_erase:248.1223,kntrie_iter:114.8405,kntrie_mem:47490264,umap_fnd:89.9740,umap_nf:106.5742,umap_insert:232.9348,umap_erase:128.8188,umap_iter:73.3916,umap_mem:82332776,kntrie_mempre:54213080},
  {pattern:"random",N:3787675,kntrie_fnd:454.5215,kntrie_nf:372.3147,kntrie_insert:931.7296,kntrie_erase:401.8713,kntrie_iter:146.9645,kntrie_mem:61108240,umap_fnd:146.9008,umap_nf:160.1665,umap_insert:393.0936,umap_erase:240.7192,umap_iter:135.1258,umap_mem:123112448,kntrie_mempre:67854496},
  {pattern:"random",N:5681512,kntrie_fnd:724.5033,kntrie_nf:616.9347,kntrie_insert:1487.3038,kntrie_erase:693.3519,kntrie_iter:275.0885,kntrie_mem:101661712,umap_fnd:262.2672,umap_nf:315.9952,umap_insert:604.1815,umap_erase:433.6319,umap_iter:233.4939,umap_mem:184095064,kntrie_mempre:108438000},
  {pattern:"sequential",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0007,kntrie_insert:0.0114,kntrie_erase:0.0046,kntrie_iter:0.0024,kntrie_mem:1544,map_fnd:0.0034,map_nf:0.0034,map_insert:0.0099,map_erase:0.0064,map_iter:0.0012,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0007,umap_insert:0.0023,umap_erase:0.0017,umap_iter:0.0002,umap_mem:3224,kntrie_mempre:2024},
  {pattern:"sequential",N:150,kntrie_fnd:0.0012,kntrie_nf:0.0011,kntrie_insert:0.0127,kntrie_erase:0.0061,kntrie_iter:0.0039,kntrie_mem:3080,map_fnd:0.0056,map_nf:0.0056,map_insert:0.0175,map_erase:0.0093,map_iter:0.0016,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0010,umap_insert:0.0044,umap_erase:0.0022,umap_iter:0.0003,umap_mem:4856,kntrie_mempre:3560},
  {pattern:"sequential",N:225,kntrie_fnd:0.0018,kntrie_nf:0.0016,kntrie_insert:0.0148,kntrie_erase:0.0073,kntrie_iter:0.0057,kntrie_mem:3080,map_fnd:0.0093,map_nf:0.0093,map_insert:0.0232,map_erase:0.0115,map_iter:0.0024,map_mem:10800,umap_fnd:0.0007,umap_nf:0.0014,umap_insert:0.0056,umap_erase:0.0024,umap_iter:0.0004,umap_mem:7216,kntrie_mempre:3560},
  {pattern:"sequential",N:337,kntrie_fnd:0.0030,kntrie_nf:0.0025,kntrie_insert:0.0246,kntrie_erase:0.0100,kntrie_iter:0.0093,kntrie_mem:6152,map_fnd:0.0148,map_nf:0.0150,map_insert:0.0353,map_erase:0.0177,map_iter:0.0033,map_mem:16176,umap_fnd:0.0010,umap_nf:0.0021,umap_insert:0.0079,umap_erase:0.0030,umap_iter:0.0006,umap_mem:10784,kntrie_mempre:6632},
  {pattern:"sequential",N:506,kntrie_fnd:0.0042,kntrie_nf:0.0039,kntrie_insert:0.0374,kntrie_erase:0.0136,kntrie_iter:0.0140,kntrie_mem:6152,map_fnd:0.0240,map_nf:0.0241,map_insert:0.0528,map_erase:0.0265,map_iter:0.0049,map_mem:24288,umap_fnd:0.0016,umap_nf:0.0034,umap_insert:0.0108,umap_erase:0.0038,umap_iter:0.0008,umap_mem:16472,kntrie_mempre:6632},
  {pattern:"sequential",N:759,kntrie_fnd:0.0070,kntrie_nf:0.0065,kntrie_insert:0.0576,kntrie_erase:0.0203,kntrie_iter:0.0228,kntrie_mem:12296,map_fnd:0.0393,map_nf:0.0396,map_insert:0.0814,map_erase:0.0404,map_iter:0.0079,map_mem:36432,umap_fnd:0.0024,umap_nf:0.0048,umap_insert:0.0155,umap_erase:0.0053,umap_iter:0.0013,umap_mem:24304,kntrie_mempre:12776},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0165,kntrie_nf:0.0147,kntrie_insert:0.1020,kntrie_erase:0.0245,kntrie_iter:0.0380,kntrie_mem:24584,map_fnd:0.0742,map_nf:0.0725,map_insert:0.1604,map_erase:0.0681,map_iter:0.0151,map_mem:54672,umap_fnd:0.0038,umap_nf:0.0083,umap_insert:0.0295,umap_erase:0.0114,umap_iter:0.0023,umap_mem:36880,kntrie_mempre:25064},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0176,kntrie_nf:0.0156,kntrie_insert:0.1384,kntrie_erase:0.0370,kntrie_iter:0.0554,kntrie_mem:24584,map_fnd:0.1096,map_nf:0.1098,map_insert:0.1852,map_erase:0.1000,map_iter:0.0180,map_mem:81984,umap_fnd:0.0052,umap_nf:0.0115,umap_insert:0.0299,umap_erase:0.0108,umap_iter:0.0030,umap_mem:54920,kntrie_mempre:25064},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0316,kntrie_nf:0.0262,kntrie_insert:0.1974,kntrie_erase:0.0546,kntrie_iter:0.0903,kntrie_mem:49160,map_fnd:0.1804,map_nf:0.1826,map_insert:0.2949,map_erase:0.1510,map_iter:0.0276,map_mem:122976,umap_fnd:0.0079,umap_nf:0.0183,umap_insert:0.0417,umap_erase:0.0167,umap_iter:0.0043,umap_mem:83512,kntrie_mempre:49640},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0474,kntrie_nf:0.0395,kntrie_insert:0.2659,kntrie_erase:0.0824,kntrie_iter:0.1352,kntrie_mem:49160,map_fnd:0.2937,map_nf:0.2958,map_insert:0.4549,map_erase:0.2405,map_iter:0.0422,map_mem:184512,umap_fnd:0.0118,umap_nf:0.0267,umap_insert:0.0592,umap_erase:0.0257,umap_iter:0.0064,umap_mem:124472,kntrie_mempre:49640},
  {pattern:"sequential",N:5766,kntrie_fnd:0.1759,kntrie_nf:0.1492,kntrie_insert:0.4974,kntrie_erase:0.1266,kntrie_iter:0.1906,kntrie_mem:36128,map_fnd:0.4860,map_nf:0.4946,map_insert:0.7213,map_erase:0.3946,map_iter:0.0660,map_mem:276768,umap_fnd:0.0181,umap_nf:0.0399,umap_insert:0.0863,umap_erase:0.0384,umap_iter:0.0094,umap_mem:186008,kntrie_mempre:36592},
  {pattern:"sequential",N:8649,kntrie_fnd:0.2662,kntrie_nf:0.2241,kntrie_insert:0.6747,kntrie_erase:0.1930,kntrie_iter:0.2748,kntrie_mem:53952,map_fnd:0.8081,map_nf:0.8252,map_insert:1.1472,map_erase:0.6120,map_iter:0.0997,map_mem:415152,umap_fnd:0.0271,umap_nf:0.0589,umap_insert:0.1331,umap_erase:0.0583,umap_iter:0.0138,umap_mem:277840,kntrie_mempre:60144},
  {pattern:"sequential",N:12974,kntrie_fnd:0.4027,kntrie_nf:0.3350,kntrie_insert:0.8521,kntrie_erase:0.2799,kntrie_iter:0.4125,kntrie_mem:81008,map_fnd:1.3297,map_nf:1.3655,map_insert:1.8361,map_erase:1.0075,map_iter:0.1625,map_mem:622752,umap_fnd:0.0394,umap_nf:0.0868,umap_insert:0.1901,umap_erase:0.0886,umap_iter:0.0205,umap_mem:415240,kntrie_mempre:118320},
  {pattern:"sequential",N:19461,kntrie_fnd:0.6109,kntrie_nf:0.5033,kntrie_insert:1.2207,kntrie_erase:0.4322,kntrie_iter:0.6236,kntrie_mem:121280,map_fnd:2.2097,map_nf:2.2854,map_insert:2.9213,map_erase:1.5848,map_iter:0.2621,map_mem:934128,umap_fnd:0.0595,umap_nf:0.1416,umap_insert:0.2929,umap_erase:0.1368,umap_iter:0.0305,umap_mem:633088,kntrie_mempre:193792},
  {pattern:"sequential",N:29192,kntrie_fnd:0.9245,kntrie_nf:0.7574,kntrie_insert:1.7580,kntrie_erase:0.6700,kntrie_iter:0.9436,kntrie_mem:181936,map_fnd:3.9685,map_nf:4.1140,map_insert:4.6804,map_erase:2.6933,map_iter:0.5787,map_mem:1401216,umap_fnd:0.0995,umap_nf:0.2074,umap_insert:0.4253,umap_erase:0.2231,umap_iter:0.0480,umap_mem:946424,kntrie_mempre:314544},
  {pattern:"sequential",N:43789,kntrie_fnd:1.4147,kntrie_nf:1.1482,kntrie_insert:3.1213,kntrie_erase:1.1901,kntrie_iter:1.6230,kntrie_mem:272496,map_fnd:8.0190,map_nf:7.7698,map_insert:8.0247,map_erase:4.5248,map_iter:1.4690,map_mem:2101872,umap_fnd:0.2699,umap_nf:0.3862,umap_insert:0.5964,umap_erase:0.4865,umap_iter:0.0762,umap_mem:1414784,kntrie_mempre:442000},
  {pattern:"sequential",N:65684,kntrie_fnd:2.1936,kntrie_nf:1.7927,kntrie_insert:3.7883,kntrie_erase:1.8570,kntrie_iter:2.0580,kntrie_mem:409528,map_fnd:16.7475,map_nf:17.6288,map_insert:14.6742,map_erase:10.5103,map_iter:3.4718,map_mem:3152832,umap_fnd:0.7215,umap_nf:1.0273,umap_insert:1.1456,umap_erase:1.4677,umap_iter:0.1458,umap_mem:2114872,kntrie_mempre:703384},
  {pattern:"sequential",N:98526,kntrie_fnd:3.4041,kntrie_nf:2.7371,kntrie_insert:7.0066,kntrie_erase:2.8416,kntrie_iter:3.7026,kntrie_mem:613320,map_fnd:30.6629,map_nf:28.3753,map_insert:26.5424,map_erase:18.2978,map_iter:5.7127,map_mem:4729248,umap_fnd:1.3029,umap_nf:1.6418,umap_insert:2.0140,umap_erase:2.2138,umap_iter:0.2112,umap_mem:3162488,kntrie_mempre:1049672},
  {pattern:"sequential",N:147789,kntrie_fnd:5.2420,kntrie_nf:4.2836,kntrie_insert:11.0110,kntrie_erase:4.4590,kntrie_iter:5.6523,kntrie_mem:919440,map_fnd:59.9116,map_nf:56.9370,map_insert:51.4505,map_erase:31.9903,map_iter:10.2376,map_mem:7093872,umap_fnd:2.2263,umap_nf:2.6615,umap_insert:3.7907,umap_erase:3.4764,umap_iter:0.3225,umap_mem:4729280,kntrie_mempre:1564816},
  {pattern:"sequential",N:221683,kntrie_fnd:8.0486,kntrie_nf:6.4248,kntrie_insert:16.5897,kntrie_erase:6.6583,kntrie_iter:8.3276,kntrie_mem:1378592,map_fnd:99.1546,map_nf:94.5972,map_insert:85.3289,map_erase:57.1893,map_iter:16.6653,map_mem:10640784,umap_fnd:3.4560,umap_nf:4.1807,umap_insert:6.9343,umap_erase:6.2688,umap_iter:0.4768,umap_mem:7215568,kntrie_mempre:2367792},
  {pattern:"sequential",N:332525,kntrie_fnd:14.1071,kntrie_nf:9.7839,kntrie_insert:25.7263,kntrie_erase:10.7928,kntrie_iter:12.4583,kntrie_mem:2068240,map_fnd:173.5031,map_nf:176.2159,map_insert:151.2464,map_erase:98.0330,map_iter:25.4550,map_mem:15961200,umap_fnd:5.7587,umap_nf:6.7022,umap_insert:12.9274,umap_erase:10.6377,umap_iter:0.7338,umap_mem:10789088,kntrie_mempre:3528400},
  {pattern:"sequential",N:498788,kntrie_fnd:23.7207,kntrie_nf:14.9620,kntrie_insert:42.9276,kntrie_erase:18.9840,kntrie_iter:18.6810,kntrie_mem:3102320,map_fnd:316.7727,map_nf:305.6237,map_insert:273.3102,map_erase:171.5470,map_iter:42.9246,map_mem:23941824,umap_fnd:8.1264,umap_nf:9.6339,umap_insert:18.2442,umap_erase:15.0109,umap_iter:1.1711,umap_mem:16132840,kntrie_mempre:5299712},
  {pattern:"sequential",N:748182,kntrie_fnd:44.6555,kntrie_nf:23.0651,kntrie_insert:82.4174,kntrie_erase:37.5439,kntrie_iter:28.6168,kntrie_mem:4653120,map_fnd:482.4728,map_nf:467.8362,map_insert:449.7462,map_erase:264.3120,map_iter:72.1786,map_mem:35912736,umap_fnd:12.5193,umap_nf:17.4376,umap_insert:29.1317,umap_erase:26.6410,umap_iter:1.5134,umap_mem:24124760,kntrie_mempre:7995680},
  {pattern:"sequential",N:1122274,kntrie_fnd:73.1801,kntrie_nf:38.7150,kntrie_insert:135.9195,kntrie_erase:70.4575,kntrie_iter:42.4310,kntrie_mem:6980400,umap_fnd:22.2399,umap_nf:24.0150,umap_insert:45.8206,umap_erase:37.4248,umap_iter:4.1459,umap_mem:36077144,kntrie_mempre:11938912},
  {pattern:"sequential",N:1683411,kntrie_fnd:142.0324,kntrie_nf:66.6573,kntrie_insert:238.8488,kntrie_erase:124.9237,kntrie_iter:64.0550,kntrie_mem:10470080,umap_fnd:40.7101,umap_nf:41.1720,umap_insert:76.4018,umap_erase:64.4386,umap_iter:7.4337,umap_mem:53952736,kntrie_mempre:17913072},
  {pattern:"sequential",N:2525116,kntrie_fnd:218.1867,kntrie_nf:133.0358,kntrie_insert:390.8795,kntrie_erase:224.3157,kntrie_iter:97.3499,kntrie_mem:15705304,umap_fnd:60.4511,umap_nf:55.1858,umap_insert:122.0340,umap_erase:88.7155,umap_iter:11.8862,umap_mem:82332776,kntrie_mempre:26920040},
  {pattern:"sequential",N:3787675,kntrie_fnd:392.9171,kntrie_nf:241.0520,kntrie_insert:708.5443,kntrie_erase:363.2676,kntrie_iter:145.5100,kntrie_mem:23557776,umap_fnd:100.3148,umap_nf:90.6533,umap_insert:192.9345,umap_erase:168.6231,umap_iter:18.3536,umap_mem:123112448,kntrie_mempre:40368064},
  {pattern:"sequential",N:5681512,kntrie_fnd:626.8353,kntrie_nf:393.6065,kntrie_insert:1212.1472,kntrie_erase:617.6105,kntrie_iter:219.5888,kntrie_mem:35336432,umap_fnd:212.5930,umap_nf:276.9413,umap_insert:358.6310,umap_erase:441.4842,umap_iter:28.3182,umap_mem:184095064,kntrie_mempre:60588320},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "kntrie", suffix: "mempre", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie +freelist" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
