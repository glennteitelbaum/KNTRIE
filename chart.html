<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64)</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0007,kntrie_nf:0.0007,kntrie_insert:0.0164,kntrie_erase:0.0086,kntrie_iter:0.0075,kntrie_mem:2056,map_fnd:0.0035,map_nf:0.0028,map_insert:0.0176,map_erase:0.0107,map_iter:0.0059,map_mem:4800,umap_fnd:0.0013,umap_nf:0.0019,umap_insert:0.0089,umap_erase:0.0067,umap_iter:0.0044,umap_mem:3224},
  {pattern:"random",N:150,kntrie_fnd:0.0011,kntrie_nf:0.0012,kntrie_insert:0.0176,kntrie_erase:0.0099,kntrie_iter:0.0084,kntrie_mem:4104,map_fnd:0.0056,map_nf:0.0054,map_insert:0.0305,map_erase:0.0150,map_iter:0.0064,map_mem:7200,umap_fnd:0.0019,umap_nf:0.0024,umap_insert:0.0111,umap_erase:0.0075,umap_iter:0.0044,umap_mem:4856},
  {pattern:"random",N:225,kntrie_fnd:0.0018,kntrie_nf:0.0017,kntrie_insert:0.0330,kntrie_erase:0.0115,kntrie_iter:0.0106,kntrie_mem:4104,map_fnd:0.0095,map_nf:0.0089,map_insert:0.0384,map_erase:0.0187,map_iter:0.0077,map_mem:10800,umap_fnd:0.0032,umap_nf:0.0044,umap_insert:0.0140,umap_erase:0.0109,umap_iter:0.0047,umap_mem:7216},
  {pattern:"random",N:337,kntrie_fnd:0.0032,kntrie_nf:0.0029,kntrie_insert:0.0352,kntrie_erase:0.0167,kntrie_iter:0.0146,kntrie_mem:8200,map_fnd:0.0152,map_nf:0.0152,map_insert:0.0459,map_erase:0.0309,map_iter:0.0088,map_mem:16176,umap_fnd:0.0044,umap_nf:0.0070,umap_insert:0.0171,umap_erase:0.0101,umap_iter:0.0048,umap_mem:10784},
  {pattern:"random",N:506,kntrie_fnd:0.0048,kntrie_nf:0.0045,kntrie_insert:0.0529,kntrie_erase:0.0167,kntrie_iter:0.0196,kntrie_mem:8200,map_fnd:0.0249,map_nf:0.0250,map_insert:0.0747,map_erase:0.0515,map_iter:0.0118,map_mem:24288,umap_fnd:0.0065,umap_nf:0.0097,umap_insert:0.0235,umap_erase:0.0125,umap_iter:0.0052,umap_mem:16472},
  {pattern:"random",N:759,kntrie_fnd:0.0082,kntrie_nf:0.0078,kntrie_insert:0.0573,kntrie_erase:0.0213,kntrie_iter:0.0281,kntrie_mem:16392,map_fnd:0.0416,map_nf:0.0422,map_insert:0.1039,map_erase:0.0489,map_iter:0.0095,map_mem:36432,umap_fnd:0.0104,umap_nf:0.0159,umap_insert:0.0262,umap_erase:0.0122,umap_iter:0.0015,umap_mem:24304},
  {pattern:"random",N:1139,kntrie_fnd:0.0133,kntrie_nf:0.0122,kntrie_insert:0.0767,kntrie_erase:0.0212,kntrie_iter:0.0405,kntrie_mem:32776,map_fnd:0.0704,map_nf:0.0711,map_insert:0.1331,map_erase:0.0709,map_iter:0.0138,map_mem:54672,umap_fnd:0.0156,umap_nf:0.0224,umap_insert:0.0367,umap_erase:0.0174,umap_iter:0.0025,umap_mem:36880},
  {pattern:"random",N:1708,kntrie_fnd:0.0190,kntrie_nf:0.0181,kntrie_insert:0.1136,kntrie_erase:0.0378,kntrie_iter:0.0607,kntrie_mem:32776,map_fnd:0.1212,map_nf:0.1179,map_insert:0.2117,map_erase:0.1080,map_iter:0.0223,map_mem:81984,umap_fnd:0.0243,umap_nf:0.0364,umap_insert:0.0535,umap_erase:0.0262,umap_iter:0.0047,umap_mem:54920},
  {pattern:"random",N:2562,kntrie_fnd:0.0362,kntrie_nf:0.0302,kntrie_insert:0.1963,kntrie_erase:0.0555,kntrie_iter:0.0989,kntrie_mem:65544,map_fnd:0.1999,map_nf:0.1953,map_insert:0.3212,map_erase:0.1770,map_iter:0.0316,map_mem:122976,umap_fnd:0.0359,umap_nf:0.0531,umap_insert:0.0745,umap_erase:0.0381,umap_iter:0.0079,umap_mem:83512},
  {pattern:"random",N:3844,kntrie_fnd:0.0513,kntrie_nf:0.0437,kntrie_insert:0.3487,kntrie_erase:0.0900,kntrie_iter:0.1484,kntrie_mem:65544,map_fnd:0.3357,map_nf:0.3224,map_insert:0.4967,map_erase:0.2684,map_iter:0.0476,map_mem:184512,umap_fnd:0.0577,umap_nf:0.0840,umap_insert:0.1128,umap_erase:0.0613,umap_iter:0.0136,umap_mem:124472},
  {pattern:"random",N:5766,kntrie_fnd:0.0689,kntrie_nf:0.0634,kntrie_insert:0.5586,kntrie_erase:0.3983,kntrie_iter:0.1919,kntrie_mem:131600,map_fnd:0.5421,map_nf:0.5394,map_insert:0.8223,map_erase:0.4442,map_iter:0.0741,map_mem:276768,umap_fnd:0.0924,umap_nf:0.1336,umap_insert:0.1844,umap_erase:0.0957,umap_iter:0.0230,umap_mem:186008},
  {pattern:"random",N:8649,kntrie_fnd:0.1378,kntrie_nf:0.1404,kntrie_insert:0.7663,kntrie_erase:0.7213,kntrie_iter:0.3078,kntrie_mem:214544,map_fnd:0.9179,map_nf:0.8824,map_insert:1.2824,map_erase:0.6896,map_iter:0.1186,map_mem:415152,umap_fnd:0.1399,umap_nf:0.1996,umap_insert:0.2706,umap_erase:0.1469,umap_iter:0.0346,umap_mem:277840},
  {pattern:"random",N:12974,kntrie_fnd:0.1900,kntrie_nf:0.1614,kntrie_insert:1.1145,kntrie_erase:0.8690,kntrie_iter:0.4663,kntrie_mem:274960,map_fnd:1.5497,map_nf:1.4772,map_insert:2.1208,map_erase:1.1335,map_iter:0.1886,map_mem:622752,umap_fnd:0.2200,umap_nf:0.3113,umap_insert:0.4183,umap_erase:0.2462,umap_iter:0.0566,umap_mem:415240},
  {pattern:"random",N:19461,kntrie_fnd:0.3226,kntrie_nf:0.2922,kntrie_insert:1.5691,kntrie_erase:1.0530,kntrie_iter:0.7493,kntrie_mem:503824,map_fnd:2.5777,map_nf:2.4127,map_insert:3.2971,map_erase:1.8008,map_iter:0.2791,map_mem:934128,umap_fnd:0.3243,umap_nf:0.4625,umap_insert:0.6109,umap_erase:0.3372,umap_iter:0.0893,umap_mem:633088},
  {pattern:"random",N:29192,kntrie_fnd:0.5231,kntrie_nf:0.4377,kntrie_insert:2.3619,kntrie_erase:1.4309,kntrie_iter:1.1377,kntrie_mem:568336,map_fnd:4.3816,map_nf:4.0805,map_insert:5.3249,map_erase:2.9799,map_iter:0.5416,map_mem:1401216,umap_fnd:0.5136,umap_nf:0.7168,umap_insert:0.9332,umap_erase:0.5266,umap_iter:0.1470,umap_mem:946424},
  {pattern:"random",N:43789,kntrie_fnd:0.9051,kntrie_nf:0.7673,kntrie_insert:3.6392,kntrie_erase:2.1148,kntrie_iter:1.8288,kntrie_mem:1053712,map_fnd:7.7951,map_nf:7.2587,map_insert:8.6172,map_erase:5.1212,map_iter:1.2193,map_mem:2101872,umap_fnd:0.7856,umap_nf:1.1364,umap_insert:1.4108,umap_erase:0.8529,umap_iter:0.2382,umap_mem:1414784},
  {pattern:"random",N:65684,kntrie_fnd:1.6670,kntrie_nf:1.5041,kntrie_insert:5.9457,kntrie_erase:2.6786,kntrie_iter:2.8345,kntrie_mem:1573904,map_fnd:13.8904,map_nf:13.1848,map_insert:14.4144,map_erase:8.7869,map_iter:2.2413,map_mem:3152832,umap_fnd:1.3443,umap_nf:1.8939,umap_insert:2.3633,umap_erase:1.4996,umap_iter:0.4441,umap_mem:2114872},
  {pattern:"random",N:98526,kntrie_fnd:3.0934,kntrie_nf:2.1676,kntrie_insert:9.0617,kntrie_erase:4.6209,kntrie_iter:4.3371,kntrie_mem:2102288,map_fnd:26.4440,map_nf:25.8663,map_insert:25.7369,map_erase:15.7027,map_iter:4.1315,map_mem:4729248,umap_fnd:2.2498,umap_nf:3.1442,umap_insert:4.4726,umap_erase:2.8851,umap_iter:0.9479,umap_mem:3162488},
  {pattern:"random",N:147789,kntrie_fnd:6.8897,kntrie_nf:4.3726,kntrie_insert:15.6680,kntrie_erase:6.8823,kntrie_iter:7.0408,kntrie_mem:4183056,map_fnd:46.3030,map_nf:45.1988,map_insert:44.2977,map_erase:27.4047,map_iter:6.8696,map_mem:7093872,umap_fnd:3.7411,umap_nf:5.0750,umap_insert:7.6976,umap_erase:4.9180,umap_iter:1.8571,umap_mem:4729280},
  {pattern:"random",N:221683,kntrie_fnd:9.4631,kntrie_nf:6.2337,kntrie_insert:23.0311,kntrie_erase:11.6988,kntrie_iter:10.6443,kntrie_mem:4199440,map_fnd:77.1394,map_nf:77.8610,map_insert:72.0685,map_erase:45.2723,map_iter:11.0246,map_mem:10640784,umap_fnd:5.4858,umap_nf:7.2773,umap_insert:11.7984,umap_erase:7.1936,umap_iter:2.9081,umap_mem:7215568},
  {pattern:"random",N:332525,kntrie_fnd:21.2055,kntrie_nf:15.9825,kntrie_insert:42.0560,kntrie_erase:21.3781,kntrie_iter:16.8883,kntrie_mem:8393744,map_fnd:141.1320,map_nf:140.0144,map_insert:128.3995,map_erase:80.0465,map_iter:19.1469,map_mem:15961200,umap_fnd:9.2930,umap_nf:12.0323,umap_insert:20.1371,umap_erase:13.5519,umap_iter:5.3285,umap_mem:10789088},
  {pattern:"random",N:498788,kntrie_fnd:32.1958,kntrie_nf:24.0740,kntrie_insert:78.9192,kntrie_erase:34.0948,kntrie_iter:25.4291,kntrie_mem:8524816,map_fnd:242.9533,map_nf:238.3075,map_insert:223.9449,map_erase:137.7113,map_iter:30.8029,map_mem:23941824,umap_fnd:15.3363,umap_nf:19.4008,umap_insert:33.5475,umap_erase:20.2244,umap_iter:9.3290,umap_mem:16132840},
  {pattern:"random",N:748182,kntrie_fnd:67.7689,kntrie_nf:51.8551,kntrie_insert:130.9653,kntrie_erase:60.7025,kntrie_iter:40.4102,kntrie_mem:16782352,map_fnd:408.3245,map_nf:402.7347,map_insert:370.8768,map_erase:228.9319,map_iter:47.3709,map_mem:35912736,umap_fnd:24.2107,umap_nf:30.0302,umap_insert:52.1395,umap_erase:31.5874,umap_iter:15.1003,umap_mem:24124760},
  {pattern:"random",N:1122274,kntrie_fnd:81.0191,kntrie_nf:66.6216,kntrie_insert:285.3989,kntrie_erase:66.6550,kntrie_iter:46.6964,kntrie_mem:27146000,umap_fnd:39.2194,umap_nf:48.0106,umap_insert:83.8443,umap_erase:53.6528,umap_iter:25.6295,umap_mem:36077144},
  {pattern:"random",N:1683411,kntrie_fnd:127.0993,kntrie_nf:105.2233,kntrie_insert:379.1442,kntrie_erase:253.9894,kntrie_iter:75.7570,kntrie_mem:37514256,umap_fnd:62.2104,umap_nf:73.6322,umap_insert:133.7257,umap_erase:79.9001,umap_iter:39.4967,umap_mem:53952736},
  {pattern:"random",N:2525116,kntrie_fnd:218.7151,kntrie_nf:184.5640,kntrie_insert:554.2276,kntrie_erase:437.7488,kntrie_iter:121.6597,kntrie_mem:62881040,umap_fnd:96.5609,umap_nf:112.1671,umap_insert:214.5886,umap_erase:130.2495,umap_iter:62.8835,umap_mem:82332776},
  {pattern:"random",N:3787675,kntrie_fnd:367.6105,kntrie_nf:296.7548,kntrie_insert:889.8729,kntrie_erase:662.3492,kntrie_iter:181.8234,kntrie_mem:81038352,umap_fnd:159.8942,umap_nf:177.2341,umap_insert:352.5425,umap_erase:234.2767,umap_iter:107.6400,umap_mem:123112448},
  {pattern:"random",N:5681512,kntrie_fnd:735.7760,kntrie_nf:545.2532,kntrie_insert:1345.9860,kntrie_erase:1132.1993,kntrie_iter:282.5734,kntrie_mem:135109648,umap_fnd:283.8367,umap_nf:306.1466,umap_insert:567.8775,umap_erase:407.7689,umap_iter:212.2413,umap_mem:184095064},
  {pattern:"sequential",N:100,kntrie_fnd:0.0007,kntrie_nf:0.0007,kntrie_insert:0.0094,kntrie_erase:0.0043,kntrie_iter:0.0027,kntrie_mem:2056,map_fnd:0.0036,map_nf:0.0037,map_insert:0.0118,map_erase:0.0069,map_iter:0.0015,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0007,umap_insert:0.0036,umap_erase:0.0016,umap_iter:0.0002,umap_mem:3224},
  {pattern:"sequential",N:150,kntrie_fnd:0.0011,kntrie_nf:0.0012,kntrie_insert:0.0109,kntrie_erase:0.0043,kntrie_iter:0.0042,kntrie_mem:4104,map_fnd:0.0059,map_nf:0.0063,map_insert:0.0187,map_erase:0.0091,map_iter:0.0020,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0011,umap_insert:0.0048,umap_erase:0.0020,umap_iter:0.0003,umap_mem:4856},
  {pattern:"sequential",N:225,kntrie_fnd:0.0017,kntrie_nf:0.0017,kntrie_insert:0.0157,kntrie_erase:0.0053,kntrie_iter:0.0062,kntrie_mem:4104,map_fnd:0.0096,map_nf:0.0098,map_insert:0.0274,map_erase:0.0130,map_iter:0.0028,map_mem:10800,umap_fnd:0.0008,umap_nf:0.0016,umap_insert:0.0062,umap_erase:0.0022,umap_iter:0.0004,umap_mem:7216},
  {pattern:"sequential",N:337,kntrie_fnd:0.0030,kntrie_nf:0.0027,kntrie_insert:0.0250,kntrie_erase:0.0088,kntrie_iter:0.0102,kntrie_mem:8200,map_fnd:0.0155,map_nf:0.0160,map_insert:0.0398,map_erase:0.0177,map_iter:0.0045,map_mem:16176,umap_fnd:0.0011,umap_nf:0.0023,umap_insert:0.0082,umap_erase:0.0026,umap_iter:0.0006,umap_mem:10784},
  {pattern:"sequential",N:506,kntrie_fnd:0.0045,kntrie_nf:0.0043,kntrie_insert:0.0370,kntrie_erase:0.0119,kntrie_iter:0.0147,kntrie_mem:8200,map_fnd:0.0239,map_nf:0.0252,map_insert:0.0591,map_erase:0.0291,map_iter:0.0063,map_mem:24288,umap_fnd:0.0017,umap_nf:0.0036,umap_insert:0.0116,umap_erase:0.0038,umap_iter:0.0009,umap_mem:16472},
  {pattern:"sequential",N:759,kntrie_fnd:0.0074,kntrie_nf:0.0071,kntrie_insert:0.0526,kntrie_erase:0.0194,kntrie_iter:0.0242,kntrie_mem:16392,map_fnd:0.0403,map_nf:0.0426,map_insert:0.0913,map_erase:0.0429,map_iter:0.0094,map_mem:36432,umap_fnd:0.0025,umap_nf:0.0050,umap_insert:0.0168,umap_erase:0.0051,umap_iter:0.0014,umap_mem:24304},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0117,kntrie_nf:0.0108,kntrie_insert:0.0814,kntrie_erase:0.0213,kntrie_iter:0.0391,kntrie_mem:32776,map_fnd:0.0688,map_nf:0.0709,map_insert:0.1333,map_erase:0.0651,map_iter:0.0134,map_mem:54672,umap_fnd:0.0037,umap_nf:0.0080,umap_insert:0.0229,umap_erase:0.0068,umap_iter:0.0021,umap_mem:36880},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0182,kntrie_nf:0.0183,kntrie_insert:0.1159,kntrie_erase:0.0388,kntrie_iter:0.0587,kntrie_mem:32776,map_fnd:0.1172,map_nf:0.1181,map_insert:0.2134,map_erase:0.1102,map_iter:0.0225,map_mem:81984,umap_fnd:0.0057,umap_nf:0.0126,umap_insert:0.0345,umap_erase:0.0114,umap_iter:0.0032,umap_mem:54920},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0334,kntrie_nf:0.0280,kntrie_insert:0.2016,kntrie_erase:0.0578,kntrie_iter:0.0989,kntrie_mem:65544,map_fnd:0.1960,map_nf:0.1918,map_insert:0.3340,map_erase:0.1701,map_iter:0.0332,map_mem:122976,umap_fnd:0.0083,umap_nf:0.0193,umap_insert:0.0464,umap_erase:0.0177,umap_iter:0.0047,umap_mem:83512},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0489,kntrie_nf:0.0415,kntrie_insert:0.2845,kntrie_erase:0.0882,kntrie_iter:0.1469,kntrie_mem:65544,map_fnd:0.3246,map_nf:0.3260,map_insert:0.5121,map_erase:0.2699,map_iter:0.0493,map_mem:184512,umap_fnd:0.0130,umap_nf:0.0290,umap_insert:0.0684,umap_erase:0.0276,umap_iter:0.0071,umap_mem:124472},
  {pattern:"sequential",N:5766,kntrie_fnd:0.1943,kntrie_nf:0.1659,kntrie_insert:0.5208,kntrie_erase:0.1343,kntrie_iter:0.1942,kntrie_mem:70960,map_fnd:0.5451,map_nf:0.5244,map_insert:0.8119,map_erase:0.4216,map_iter:0.0779,map_mem:276768,umap_fnd:0.0191,umap_nf:0.0420,umap_insert:0.1017,umap_erase:0.0410,umap_iter:0.0100,umap_mem:186008},
  {pattern:"sequential",N:8649,kntrie_fnd:0.2981,kntrie_nf:0.2656,kntrie_insert:0.7124,kntrie_erase:0.3252,kntrie_iter:0.2949,kntrie_mem:105792,map_fnd:0.8944,map_nf:0.8721,map_insert:1.2858,map_erase:0.6856,map_iter:0.1198,map_mem:415152,umap_fnd:0.0286,umap_nf:0.0636,umap_insert:0.1449,umap_erase:0.0674,umap_iter:0.0148,umap_mem:277840},
  {pattern:"sequential",N:12974,kntrie_fnd:0.4396,kntrie_nf:0.3683,kntrie_insert:0.9588,kntrie_erase:0.4816,kntrie_iter:0.4376,kntrie_mem:158816,map_fnd:1.5098,map_nf:1.4287,map_insert:2.0329,map_erase:1.0801,map_iter:0.1865,map_mem:622752,umap_fnd:0.0434,umap_nf:0.0922,umap_insert:0.2147,umap_erase:0.0962,umap_iter:0.0220,umap_mem:415240},
  {pattern:"sequential",N:19461,kntrie_fnd:0.6836,kntrie_nf:0.5670,kntrie_insert:1.3775,kntrie_erase:0.7812,kntrie_iter:0.6743,kntrie_mem:238048,map_fnd:2.5283,map_nf:2.5044,map_insert:3.3338,map_erase:1.8370,map_iter:0.2995,map_mem:934128,umap_fnd:0.0652,umap_nf:0.1512,umap_insert:0.3460,umap_erase:0.1633,umap_iter:0.0346,umap_mem:633088},
  {pattern:"sequential",N:29192,kntrie_fnd:1.0417,kntrie_nf:0.8622,kntrie_insert:1.9931,kntrie_erase:1.1365,kntrie_iter:1.0089,kntrie_mem:357056,map_fnd:4.4793,map_nf:4.3473,map_insert:5.4538,map_erase:2.9460,map_iter:0.6304,map_mem:1401216,umap_fnd:0.1227,umap_nf:0.2335,umap_insert:0.5019,umap_erase:0.2625,umap_iter:0.0525,umap_mem:946424},
  {pattern:"sequential",N:43789,kntrie_fnd:1.6718,kntrie_nf:1.3244,kntrie_insert:3.6434,kntrie_erase:2.0414,kntrie_iter:1.7254,kntrie_mem:535504,map_fnd:8.0875,map_nf:7.7930,map_insert:8.9574,map_erase:5.2843,map_iter:1.3060,map_mem:2101872,umap_fnd:0.2216,umap_nf:0.3714,umap_insert:0.7449,umap_erase:0.4699,umap_iter:0.0784,umap_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_fnd:2.5287,kntrie_nf:2.0488,kntrie_insert:5.2455,kntrie_erase:2.9286,kntrie_iter:2.6642,kntrie_mem:803768,map_fnd:14.3231,map_nf:13.9528,map_insert:15.2575,map_erase:9.0629,map_iter:2.3799,map_mem:3152832,umap_fnd:0.4330,umap_nf:0.6809,umap_insert:1.1824,umap_erase:1.0524,umap_iter:0.1210,umap_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_fnd:4.0885,kntrie_nf:3.2464,kntrie_insert:7.9587,kntrie_erase:4.6370,kntrie_iter:4.0262,kntrie_mem:1204168,map_fnd:24.7089,map_nf:23.9521,map_insert:25.2836,map_erase:15.0918,map_iter:3.9854,map_mem:4729248,umap_fnd:0.7519,umap_nf:1.0815,umap_insert:1.8784,umap_erase:1.5607,umap_iter:0.1786,umap_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_fnd:5.7912,kntrie_nf:4.6913,kntrie_insert:11.8673,kntrie_erase:7.1723,kntrie_iter:5.8366,kntrie_mem:1806096,map_fnd:43.6993,map_nf:42.5630,map_insert:42.8589,map_erase:26.3014,map_iter:6.5766,map_mem:7093872,umap_fnd:1.1842,umap_nf:1.7358,umap_insert:3.2564,umap_erase:2.6197,umap_iter:0.2900,umap_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_fnd:9.7896,kntrie_nf:7.1521,kntrie_insert:18.7071,kntrie_erase:10.9699,kntrie_iter:9.0697,kntrie_mem:2708512,map_fnd:75.7038,map_nf:76.0993,map_insert:72.0406,map_erase:45.1613,map_iter:10.9274,map_mem:10640784,umap_fnd:2.0279,umap_nf:2.9075,umap_insert:5.2802,umap_erase:4.8002,umap_iter:0.4532,umap_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_fnd:16.5819,kntrie_nf:11.5239,kntrie_insert:29.8189,kntrie_erase:17.9058,kntrie_iter:13.5251,kntrie_mem:4063360,map_fnd:134.0839,map_nf:132.9385,map_insert:124.0052,map_erase:80.1711,map_iter:18.4070,map_mem:15961200,umap_fnd:3.6514,umap_nf:5.0578,umap_insert:9.8195,umap_erase:8.0149,umap_iter:0.6996,umap_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_fnd:25.9338,kntrie_nf:16.9076,kntrie_insert:47.1826,kntrie_erase:33.4421,kntrie_iter:19.8013,kntrie_mem:6095232,map_fnd:227.7187,map_nf:228.1234,map_insert:212.3517,map_erase:131.9297,map_iter:29.0988,map_mem:23941824,umap_fnd:5.9424,umap_nf:7.6175,umap_insert:14.6629,umap_erase:12.0010,umap_iter:1.0610,umap_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_fnd:43.4297,kntrie_nf:27.6544,kntrie_insert:78.6854,kntrie_erase:56.6987,kntrie_iter:29.6981,kntrie_mem:9143504,map_fnd:382.3646,map_nf:386.9701,map_insert:364.8842,map_erase:222.5409,map_iter:47.2206,map_mem:35912736,umap_fnd:9.6318,umap_nf:12.5571,umap_insert:21.2620,umap_erase:19.4045,umap_iter:1.5903,umap_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_fnd:71.2482,kntrie_nf:45.6473,kntrie_insert:132.9353,kntrie_erase:93.2661,kntrie_iter:45.7291,kntrie_mem:13713968,umap_fnd:19.6635,umap_nf:22.0081,umap_insert:39.4975,umap_erase:32.4885,umap_iter:3.3429,umap_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_fnd:122.9495,kntrie_nf:79.6212,kntrie_insert:225.3206,kntrie_erase:157.8429,kntrie_iter:68.3176,kntrie_mem:20570672,umap_fnd:30.7226,umap_nf:32.6620,umap_insert:69.2733,umap_erase:55.6227,umap_iter:6.7666,umap_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_fnd:218.1330,kntrie_nf:141.9163,kntrie_insert:375.6186,kntrie_erase:260.0654,kntrie_iter:104.1101,kntrie_mem:30852840,umap_fnd:51.3228,umap_nf:51.7821,umap_insert:115.1612,umap_erase:90.9593,umap_iter:9.9221,umap_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_fnd:344.3549,kntrie_nf:239.9199,kntrie_insert:626.3489,kntrie_erase:429.8818,kntrie_iter:153.5701,kntrie_mem:46284208,umap_fnd:85.6848,umap_nf:89.7055,umap_insert:172.8977,umap_erase:153.6995,umap_iter:16.4798,umap_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_fnd:617.1634,kntrie_nf:398.1679,kntrie_insert:1081.0703,kntrie_erase:715.4371,kntrie_iter:244.8105,kntrie_mem:69425920,umap_fnd:157.3117,umap_nf:200.9883,umap_insert:306.5902,umap_erase:355.6629,umap_iter:28.9505,umap_mem:184095064},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
