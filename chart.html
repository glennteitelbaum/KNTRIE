<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64)</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0006,kntrie_insert:0.0117,kntrie_erase:0.0048,kntrie_iter:0.0027,kntrie_mem:2056,map_fnd:0.0033,map_nf:0.0027,map_insert:0.0125,map_erase:0.0079,map_iter:0.0015,map_mem:4800,umap_fnd:0.0013,umap_nf:0.0018,umap_insert:0.0042,umap_erase:0.0032,umap_iter:0.0002,umap_mem:3224},
  {pattern:"random",N:150,kntrie_fnd:0.0011,kntrie_nf:0.0010,kntrie_insert:0.0142,kntrie_erase:0.0060,kntrie_iter:0.0042,kntrie_mem:4104,map_fnd:0.0053,map_nf:0.0050,map_insert:0.0174,map_erase:0.0107,map_iter:0.0018,map_mem:7200,umap_fnd:0.0017,umap_nf:0.0022,umap_insert:0.0067,umap_erase:0.0038,umap_iter:0.0003,umap_mem:4856},
  {pattern:"random",N:225,kntrie_fnd:0.0016,kntrie_nf:0.0013,kntrie_insert:0.0187,kntrie_erase:0.0077,kntrie_iter:0.0059,kntrie_mem:4104,map_fnd:0.0085,map_nf:0.0086,map_insert:0.0247,map_erase:0.0130,map_iter:0.0027,map_mem:10800,umap_fnd:0.0029,umap_nf:0.0040,umap_insert:0.0085,umap_erase:0.0041,umap_iter:0.0005,umap_mem:7216},
  {pattern:"random",N:337,kntrie_fnd:0.0028,kntrie_nf:0.0023,kntrie_insert:0.0244,kntrie_erase:0.0102,kntrie_iter:0.0096,kntrie_mem:8200,map_fnd:0.0136,map_nf:0.0139,map_insert:0.0368,map_erase:0.0200,map_iter:0.0038,map_mem:16176,umap_fnd:0.0040,umap_nf:0.0063,umap_insert:0.0117,umap_erase:0.0058,umap_iter:0.0006,umap_mem:10784},
  {pattern:"random",N:506,kntrie_fnd:0.0042,kntrie_nf:0.0036,kntrie_insert:0.0475,kntrie_erase:0.0134,kntrie_iter:0.0142,kntrie_mem:8200,map_fnd:0.0220,map_nf:0.0228,map_insert:0.0551,map_erase:0.0298,map_iter:0.0057,map_mem:24288,umap_fnd:0.0058,umap_nf:0.0088,umap_insert:0.0163,umap_erase:0.0085,umap_iter:0.0008,umap_mem:16472},
  {pattern:"random",N:759,kntrie_fnd:0.0071,kntrie_nf:0.0062,kntrie_insert:0.0563,kntrie_erase:0.0219,kntrie_iter:0.0233,kntrie_mem:16392,map_fnd:0.0377,map_nf:0.0382,map_insert:0.0845,map_erase:0.0434,map_iter:0.0082,map_mem:36432,umap_fnd:0.0094,umap_nf:0.0144,umap_insert:0.0238,umap_erase:0.0127,umap_iter:0.0013,umap_mem:24304},
  {pattern:"random",N:1139,kntrie_fnd:0.0129,kntrie_nf:0.0109,kntrie_insert:0.0808,kntrie_erase:0.0214,kntrie_iter:0.0377,kntrie_mem:32776,map_fnd:0.0687,map_nf:0.0653,map_insert:0.1279,map_erase:0.0634,map_iter:0.0129,map_mem:54672,umap_fnd:0.0137,umap_nf:0.0206,umap_insert:0.0321,umap_erase:0.0156,umap_iter:0.0023,umap_mem:36880},
  {pattern:"random",N:1708,kntrie_fnd:0.0168,kntrie_nf:0.0149,kntrie_insert:0.1237,kntrie_erase:0.0365,kntrie_iter:0.0553,kntrie_mem:32776,map_fnd:0.1090,map_nf:0.1084,map_insert:0.2000,map_erase:0.1027,map_iter:0.0196,map_mem:81984,umap_fnd:0.0225,umap_nf:0.0332,umap_insert:0.0454,umap_erase:0.0228,umap_iter:0.0043,umap_mem:54920},
  {pattern:"random",N:2562,kntrie_fnd:0.0304,kntrie_nf:0.0249,kntrie_insert:0.1930,kntrie_erase:0.0641,kntrie_iter:0.0906,kntrie_mem:65544,map_fnd:0.1822,map_nf:0.1788,map_insert:0.3030,map_erase:0.1551,map_iter:0.0298,map_mem:122976,umap_fnd:0.0339,umap_nf:0.0499,umap_insert:0.0687,umap_erase:0.0361,umap_iter:0.0075,umap_mem:83512},
  {pattern:"random",N:3844,kntrie_fnd:0.0448,kntrie_nf:0.0406,kntrie_insert:0.3211,kntrie_erase:0.1111,kntrie_iter:0.1371,kntrie_mem:65544,map_fnd:0.2987,map_nf:0.2996,map_insert:0.4904,map_erase:0.2466,map_iter:0.0447,map_mem:184512,umap_fnd:0.0549,umap_nf:0.0761,umap_insert:0.1087,umap_erase:0.0550,umap_iter:0.0127,umap_mem:124472},
  {pattern:"random",N:5766,kntrie_fnd:0.0614,kntrie_nf:0.0582,kntrie_insert:0.5342,kntrie_erase:0.1587,kntrie_iter:0.1794,kntrie_mem:131600,map_fnd:0.5120,map_nf:0.4896,map_insert:0.7484,map_erase:0.4008,map_iter:0.0668,map_mem:276768,umap_fnd:0.0858,umap_nf:0.1211,umap_insert:0.1713,umap_erase:0.0845,umap_iter:0.0210,umap_mem:186008},
  {pattern:"random",N:8649,kntrie_fnd:0.1251,kntrie_nf:0.1307,kntrie_insert:0.6821,kntrie_erase:0.2432,kntrie_iter:0.2759,kntrie_mem:214544,map_fnd:0.8254,map_nf:0.8412,map_insert:1.1923,map_erase:0.6417,map_iter:0.1094,map_mem:415152,umap_fnd:0.1306,umap_nf:0.1824,umap_insert:0.2477,umap_erase:0.1348,umap_iter:0.0327,umap_mem:277840},
  {pattern:"random",N:12974,kntrie_fnd:0.1560,kntrie_nf:0.1381,kntrie_insert:0.9603,kntrie_erase:0.3425,kntrie_iter:0.4321,kntrie_mem:274960,map_fnd:1.3582,map_nf:1.3566,map_insert:1.8603,map_erase:1.0036,map_iter:0.1665,map_mem:622752,umap_fnd:0.2012,umap_nf:0.2904,umap_insert:0.3675,umap_erase:0.2000,umap_iter:0.0513,umap_mem:415240},
  {pattern:"random",N:19461,kntrie_fnd:0.2892,kntrie_nf:0.2642,kntrie_insert:1.4134,kntrie_erase:0.5079,kntrie_iter:0.6978,kntrie_mem:503824,map_fnd:2.3068,map_nf:2.2752,map_insert:3.0286,map_erase:1.6304,map_iter:0.2521,map_mem:934128,umap_fnd:0.3003,umap_nf:0.4156,umap_insert:0.5491,umap_erase:0.3013,umap_iter:0.0821,umap_mem:633088},
  {pattern:"random",N:29192,kntrie_fnd:0.4417,kntrie_nf:0.3948,kntrie_insert:2.0762,kntrie_erase:0.7600,kntrie_iter:1.0477,kntrie_mem:568336,map_fnd:4.2995,map_nf:4.0234,map_insert:4.8784,map_erase:2.7682,map_iter:0.5860,map_mem:1401216,umap_fnd:0.4718,umap_nf:0.6509,umap_insert:0.8893,umap_erase:0.4842,umap_iter:0.1387,umap_mem:946424},
  {pattern:"random",N:43789,kntrie_fnd:0.7879,kntrie_nf:0.6835,kntrie_insert:3.2640,kntrie_erase:1.3286,kntrie_iter:1.6780,kntrie_mem:1053712,map_fnd:9.7603,map_nf:9.0123,map_insert:8.9175,map_erase:5.9584,map_iter:2.1267,map_mem:2101872,umap_fnd:0.8035,umap_nf:1.0934,umap_insert:1.4522,umap_erase:0.9135,umap_iter:0.2442,umap_mem:1414784},
  {pattern:"random",N:65684,kntrie_fnd:1.6963,kntrie_nf:1.3726,kntrie_insert:5.4886,kntrie_erase:1.9017,kntrie_iter:2.6250,kntrie_mem:1573904,map_fnd:16.6808,map_nf:15.7959,map_insert:15.1007,map_erase:9.6704,map_iter:3.2319,map_mem:3152832,umap_fnd:1.3941,umap_nf:1.8407,umap_insert:2.4541,umap_erase:1.6841,umap_iter:0.5033,umap_mem:2114872},
  {pattern:"random",N:98526,kntrie_fnd:2.9816,kntrie_nf:1.8560,kntrie_insert:7.9472,kntrie_erase:3.9281,kntrie_iter:4.0352,kntrie_mem:2102288,map_fnd:35.6016,map_nf:33.0470,map_insert:26.8090,map_erase:20.0613,map_iter:5.9637,map_mem:4729248,umap_fnd:2.5516,umap_nf:3.2139,umap_insert:4.8166,umap_erase:3.5864,umap_iter:1.2270,umap_mem:3162488},
  {pattern:"random",N:147789,kntrie_fnd:8.9214,kntrie_nf:4.8332,kntrie_insert:15.4854,kntrie_erase:6.9946,kntrie_iter:6.6714,kntrie_mem:4183056,map_fnd:73.0640,map_nf:71.4506,map_insert:54.0535,map_erase:35.8729,map_iter:13.1778,map_mem:7093872,umap_fnd:4.2260,umap_nf:5.7991,umap_insert:9.2470,umap_erase:6.2386,umap_iter:2.5742,umap_mem:4729280},
  {pattern:"random",N:221683,kntrie_fnd:15.2666,kntrie_nf:7.3492,kntrie_insert:26.1423,kntrie_erase:14.6681,kntrie_iter:9.9130,kntrie_mem:4199440,map_fnd:127.7272,map_nf:132.0107,map_insert:95.7212,map_erase:63.9200,map_iter:23.9749,map_mem:10640784,umap_fnd:6.4188,umap_nf:7.9848,umap_insert:14.5696,umap_erase:9.3551,umap_iter:4.1440,umap_mem:7215568},
  {pattern:"random",N:332525,kntrie_fnd:29.7914,kntrie_nf:19.2752,kntrie_insert:48.0489,kntrie_erase:26.4999,kntrie_iter:15.7493,kntrie_mem:8393744,map_fnd:279.6131,map_nf:282.3342,map_insert:180.5351,map_erase:125.2572,map_iter:42.1758,map_mem:15961200,umap_fnd:10.4271,umap_nf:13.0082,umap_insert:25.2423,umap_erase:15.9615,umap_iter:7.9912,umap_mem:10789088},
  {pattern:"random",N:498788,kntrie_fnd:48.3567,kntrie_nf:27.4009,kntrie_insert:94.1595,kntrie_erase:48.6925,kntrie_iter:23.7085,kntrie_mem:8524816,map_fnd:559.9678,map_nf:541.9316,map_insert:324.3069,map_erase:239.4675,map_iter:77.2777,map_mem:23941824,umap_fnd:20.0382,umap_nf:23.4131,umap_insert:48.0589,umap_erase:30.7224,umap_iter:17.7497,umap_mem:16132840},
  {pattern:"random",N:748182,kntrie_fnd:131.9744,kntrie_nf:69.6573,kntrie_insert:168.5748,kntrie_erase:92.4346,kntrie_iter:38.1318,kntrie_mem:16782352,map_fnd:1008.2668,map_nf:994.8059,map_insert:711.9255,map_erase:442.9785,map_iter:141.0399,map_mem:35912736,umap_fnd:35.3890,umap_nf:38.3663,umap_insert:93.4102,umap_erase:51.2719,umap_iter:36.0817,umap_mem:24124760},
  {pattern:"random",N:1122274,kntrie_fnd:134.1705,kntrie_nf:104.8634,kntrie_insert:383.9613,kntrie_erase:68.4687,kntrie_iter:46.1062,kntrie_mem:27146000,umap_fnd:58.7662,umap_nf:69.2381,umap_insert:166.4780,umap_erase:107.5132,umap_iter:63.0841,umap_mem:36077144},
  {pattern:"random",N:1683411,kntrie_fnd:193.9990,kntrie_nf:174.0839,kntrie_insert:509.9510,kntrie_erase:228.3995,kntrie_iter:76.9471,kntrie_mem:37514256,umap_fnd:106.3121,umap_nf:125.2480,umap_insert:293.4316,umap_erase:179.2078,umap_iter:108.3183,umap_mem:53952736},
  {pattern:"random",N:2525116,kntrie_fnd:358.1024,kntrie_nf:300.7542,kntrie_insert:853.5964,kntrie_erase:407.9038,kntrie_iter:137.3476,kntrie_mem:62881040,umap_fnd:186.8570,umap_nf:208.3983,umap_insert:480.9194,umap_erase:315.6197,umap_iter:179.8505,umap_mem:82332776},
  {pattern:"sequential",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0005,kntrie_insert:0.0097,kntrie_erase:0.0041,kntrie_iter:0.0028,kntrie_mem:2056,map_fnd:0.0032,map_nf:0.0035,map_insert:0.0108,map_erase:0.0074,map_iter:0.0014,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0007,umap_insert:0.0027,umap_erase:0.0016,umap_iter:0.0002,umap_mem:3224},
  {pattern:"sequential",N:150,kntrie_fnd:0.0011,kntrie_nf:0.0009,kntrie_insert:0.0136,kntrie_erase:0.0060,kntrie_iter:0.0041,kntrie_mem:4104,map_fnd:0.0052,map_nf:0.0057,map_insert:0.0183,map_erase:0.0106,map_iter:0.0019,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0010,umap_insert:0.0047,umap_erase:0.0029,umap_iter:0.0003,umap_mem:4856},
  {pattern:"sequential",N:225,kntrie_fnd:0.0015,kntrie_nf:0.0013,kntrie_insert:0.0157,kntrie_erase:0.0068,kntrie_iter:0.0060,kntrie_mem:4104,map_fnd:0.0084,map_nf:0.0093,map_insert:0.0246,map_erase:0.0127,map_iter:0.0024,map_mem:10800,umap_fnd:0.0007,umap_nf:0.0014,umap_insert:0.0056,umap_erase:0.0026,umap_iter:0.0004,umap_mem:7216},
  {pattern:"sequential",N:337,kntrie_fnd:0.0027,kntrie_nf:0.0023,kntrie_insert:0.0290,kntrie_erase:0.0102,kntrie_iter:0.0097,kntrie_mem:8200,map_fnd:0.0143,map_nf:0.0150,map_insert:0.0376,map_erase:0.0186,map_iter:0.0037,map_mem:16176,umap_fnd:0.0011,umap_nf:0.0021,umap_insert:0.0082,umap_erase:0.0037,umap_iter:0.0006,umap_mem:10784},
  {pattern:"sequential",N:506,kntrie_fnd:0.0040,kntrie_nf:0.0035,kntrie_insert:0.0394,kntrie_erase:0.0136,kntrie_iter:0.0143,kntrie_mem:8200,map_fnd:0.0226,map_nf:0.0241,map_insert:0.0555,map_erase:0.0280,map_iter:0.0056,map_mem:24288,umap_fnd:0.0018,umap_nf:0.0035,umap_insert:0.0110,umap_erase:0.0048,umap_iter:0.0009,umap_mem:16472},
  {pattern:"sequential",N:759,kntrie_fnd:0.0070,kntrie_nf:0.0063,kntrie_insert:0.0533,kntrie_erase:0.0221,kntrie_iter:0.0230,kntrie_mem:16392,map_fnd:0.0383,map_nf:0.0408,map_insert:0.0857,map_erase:0.0441,map_iter:0.0085,map_mem:36432,umap_fnd:0.0027,umap_nf:0.0049,umap_insert:0.0160,umap_erase:0.0063,umap_iter:0.0013,umap_mem:24304},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0121,kntrie_nf:0.0099,kntrie_insert:0.0924,kntrie_erase:0.0219,kntrie_iter:0.0376,kntrie_mem:32776,map_fnd:0.0657,map_nf:0.0675,map_insert:0.1281,map_erase:0.0636,map_iter:0.0131,map_mem:54672,umap_fnd:0.0037,umap_nf:0.0076,umap_insert:0.0215,umap_erase:0.0068,umap_iter:0.0020,umap_mem:36880},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0176,kntrie_nf:0.0156,kntrie_insert:0.1183,kntrie_erase:0.0382,kntrie_iter:0.0558,kntrie_mem:32776,map_fnd:0.1109,map_nf:0.1152,map_insert:0.2080,map_erase:0.1002,map_iter:0.0199,map_mem:81984,umap_fnd:0.0058,umap_nf:0.0114,umap_insert:0.0303,umap_erase:0.0109,umap_iter:0.0031,umap_mem:54920},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0318,kntrie_nf:0.0263,kntrie_insert:0.1923,kntrie_erase:0.0609,kntrie_iter:0.0911,kntrie_mem:65544,map_fnd:0.1851,map_nf:0.1892,map_insert:0.3064,map_erase:0.1526,map_iter:0.0295,map_mem:122976,umap_fnd:0.0083,umap_nf:0.0190,umap_insert:0.0445,umap_erase:0.0172,umap_iter:0.0044,umap_mem:83512},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0437,kntrie_nf:0.0394,kntrie_insert:0.2717,kntrie_erase:0.0881,kntrie_iter:0.1359,kntrie_mem:65544,map_fnd:0.3016,map_nf:0.3049,map_insert:0.4871,map_erase:0.2415,map_iter:0.0450,map_mem:184512,umap_fnd:0.0130,umap_nf:0.0274,umap_insert:0.0646,umap_erase:0.0266,umap_iter:0.0064,umap_mem:124472},
  {pattern:"sequential",N:5766,kntrie_fnd:0.1763,kntrie_nf:0.1475,kntrie_insert:0.5242,kntrie_erase:0.1043,kntrie_iter:0.1681,kntrie_mem:70720,map_fnd:0.5040,map_nf:0.5062,map_insert:0.7520,map_erase:0.3958,map_iter:0.0698,map_mem:276768,umap_fnd:0.0195,umap_nf:0.0405,umap_insert:0.0935,umap_erase:0.0407,umap_iter:0.0095,umap_mem:186008},
  {pattern:"sequential",N:8649,kntrie_fnd:0.2657,kntrie_nf:0.2220,kntrie_insert:0.7152,kntrie_erase:0.2188,kntrie_iter:0.2508,kntrie_mem:105792,map_fnd:0.8271,map_nf:0.8322,map_insert:1.1993,map_erase:0.6322,map_iter:0.1046,map_mem:415152,umap_fnd:0.0297,umap_nf:0.0597,umap_insert:0.1394,umap_erase:0.0599,umap_iter:0.0139,umap_mem:277840},
  {pattern:"sequential",N:12974,kntrie_fnd:0.3982,kntrie_nf:0.3332,kntrie_insert:0.9092,kntrie_erase:0.3051,kntrie_iter:0.3809,kntrie_mem:158816,map_fnd:1.3506,map_nf:1.3587,map_insert:1.8805,map_erase:1.0110,map_iter:0.1623,map_mem:622752,umap_fnd:0.0410,umap_nf:0.0861,umap_insert:0.2018,umap_erase:0.0884,umap_iter:0.0206,umap_mem:415240},
  {pattern:"sequential",N:19461,kntrie_fnd:0.6170,kntrie_nf:0.5020,kntrie_insert:1.3718,kntrie_erase:0.4759,kntrie_iter:0.6091,kntrie_mem:238048,map_fnd:2.2989,map_nf:2.3164,map_insert:3.0332,map_erase:1.6133,map_iter:0.2690,map_mem:934128,umap_fnd:0.0687,umap_nf:0.1400,umap_insert:0.3020,umap_erase:0.1441,umap_iter:0.0306,umap_mem:633088},
  {pattern:"sequential",N:29192,kntrie_fnd:0.9288,kntrie_nf:0.7544,kntrie_insert:1.9903,kntrie_erase:0.7309,kntrie_iter:0.8524,kntrie_mem:357056,map_fnd:4.4003,map_nf:4.5018,map_insert:5.0679,map_erase:2.8034,map_iter:0.7758,map_mem:1401216,umap_fnd:0.0973,umap_nf:0.2110,umap_insert:0.4419,umap_erase:0.2093,umap_iter:0.0474,umap_mem:946424},
  {pattern:"sequential",N:43789,kntrie_fnd:1.4193,kntrie_nf:1.1606,kntrie_insert:3.4627,kntrie_erase:1.3082,kntrie_iter:1.5403,kntrie_mem:535264,map_fnd:9.1267,map_nf:9.2116,map_insert:8.4815,map_erase:5.2995,map_iter:1.7651,map_mem:2101872,umap_fnd:0.2970,umap_nf:0.4649,umap_insert:0.6811,umap_erase:0.5857,umap_iter:0.0875,umap_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_fnd:2.2011,kntrie_nf:1.7765,kntrie_insert:4.8834,kntrie_erase:2.0288,kntrie_iter:2.3535,kntrie_mem:803768,map_fnd:18.7246,map_nf:19.1998,map_insert:16.2079,map_erase:9.9027,map_iter:3.7460,map_mem:3152832,umap_fnd:0.6706,umap_nf:0.9150,umap_insert:1.1029,umap_erase:1.0586,umap_iter:0.1397,umap_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_fnd:3.3230,kntrie_nf:2.7665,kntrie_insert:7.3537,kntrie_erase:3.1863,kntrie_iter:3.5017,kntrie_mem:1204168,map_fnd:38.3172,map_nf:34.9963,map_insert:28.3572,map_erase:18.2155,map_iter:6.9489,map_mem:4729248,umap_fnd:1.1900,umap_nf:1.4930,umap_insert:1.8305,umap_erase:1.8914,umap_iter:0.1978,umap_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_fnd:6.0634,kntrie_nf:4.2222,kntrie_insert:11.8175,kntrie_erase:4.9439,kntrie_iter:5.3394,kntrie_mem:1806096,map_fnd:69.7549,map_nf:70.2749,map_insert:53.6927,map_erase:35.8112,map_iter:12.7300,map_mem:7093872,umap_fnd:1.9755,umap_nf:2.5581,umap_insert:4.0357,umap_erase:3.6584,umap_iter:0.3266,umap_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_fnd:10.0971,kntrie_nf:6.4340,kntrie_insert:18.9901,kntrie_erase:8.2741,kntrie_iter:7.9711,kntrie_mem:2708512,map_fnd:134.5955,map_nf:144.1371,map_insert:101.3748,map_erase:68.2503,map_iter:21.9429,map_mem:10640784,umap_fnd:3.8160,umap_nf:4.3759,umap_insert:8.0408,umap_erase:6.4867,umap_iter:0.6252,umap_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_fnd:17.6376,kntrie_nf:9.7055,kntrie_insert:32.5826,kntrie_erase:17.0167,kntrie_iter:11.9413,kntrie_mem:4063248,map_fnd:282.3237,map_nf:303.7836,map_insert:192.5522,map_erase:131.0742,map_iter:48.6133,map_mem:15961200,umap_fnd:5.8343,umap_nf:6.6921,umap_insert:11.7413,umap_erase:11.1011,umap_iter:1.1889,umap_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_fnd:32.5250,kntrie_nf:15.0436,kntrie_insert:56.2108,kntrie_erase:31.5716,kntrie_iter:18.0243,kntrie_mem:6094960,map_fnd:551.9454,map_nf:551.6818,map_insert:377.8865,map_erase:257.0862,map_iter:89.9279,map_mem:23941824,umap_fnd:11.9416,umap_nf:11.2424,umap_insert:20.2706,umap_erase:18.8367,umap_iter:2.6084,umap_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_fnd:60.5173,kntrie_nf:25.0353,kntrie_insert:105.3356,kntrie_erase:62.8318,kntrie_iter:27.3268,kntrie_mem:9142192,map_fnd:921.4431,map_nf:987.1626,map_insert:707.0415,map_erase:473.0426,map_iter:143.8526,map_mem:35912736,umap_fnd:22.2834,umap_nf:22.9203,umap_insert:35.7774,umap_erase:38.6596,umap_iter:4.0316,umap_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_fnd:127.2562,kntrie_nf:43.6448,kntrie_insert:199.9179,kntrie_erase:117.2207,kntrie_iter:41.7449,kntrie_mem:13713968,umap_fnd:37.8911,umap_nf:53.4064,umap_insert:62.4961,umap_erase:70.0438,umap_iter:5.9372,umap_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_fnd:255.3759,kntrie_nf:75.6996,kntrie_insert:372.0493,kntrie_erase:228.1225,kntrie_iter:65.3162,kntrie_mem:20570432,umap_fnd:69.7476,umap_nf:95.4989,umap_insert:108.7692,umap_erase:117.6095,umap_iter:8.9850,umap_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_fnd:380.9889,kntrie_nf:147.3715,kntrie_insert:670.9823,kntrie_erase:437.9086,kntrie_iter:94.2146,kntrie_mem:30852312,umap_fnd:111.5748,umap_nf:146.3388,umap_insert:231.2255,umap_erase:219.8697,umap_iter:13.1862,umap_mem:82332776},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
