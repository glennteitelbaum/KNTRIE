<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0079,kntrie_int32_erase:0.0029,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0095,kntrie_uint64_erase:0.0036,kntrie_uint64_mem:2056,map_int32_find:0.0035,map_int32_insert:0.0092,map_int32_erase:0.0052,map_int32_mem:4800,map_uint64_find:0.0033,map_uint64_insert:0.0107,map_uint64_erase:0.0061,map_uint64_mem:4800,umap_int32_find:0.0011,umap_int32_insert:0.0031,umap_int32_erase:0.0018,umap_int32_mem:3224,umap_uint64_find:0.0012,umap_uint64_insert:0.0041,umap_uint64_erase:0.0023,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0011,kntrie_int32_insert:0.0121,kntrie_int32_erase:0.0048,kntrie_int32_mem:3080,kntrie_uint64_find:0.0011,kntrie_uint64_insert:0.0103,kntrie_uint64_erase:0.0052,kntrie_uint64_mem:4104,map_int32_find:0.0058,map_int32_insert:0.0146,map_int32_erase:0.0077,map_int32_mem:7200,map_uint64_find:0.0054,map_uint64_insert:0.0152,map_uint64_erase:0.0082,map_uint64_mem:7200,umap_int32_find:0.0019,umap_int32_insert:0.0056,umap_int32_erase:0.0027,umap_int32_mem:4856,umap_uint64_find:0.0017,umap_uint64_insert:0.0056,umap_uint64_erase:0.0030,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0142,kntrie_int32_erase:0.0048,kntrie_int32_mem:3080,kntrie_uint64_find:0.0016,kntrie_uint64_insert:0.0138,kntrie_uint64_erase:0.0060,kntrie_uint64_mem:4104,map_int32_find:0.0094,map_int32_insert:0.0200,map_int32_erase:0.0104,map_int32_mem:10800,map_uint64_find:0.0089,map_uint64_insert:0.0218,map_uint64_erase:0.0112,map_uint64_mem:10800,umap_int32_find:0.0031,umap_int32_insert:0.0080,umap_int32_erase:0.0033,umap_int32_mem:7216,umap_uint64_find:0.0029,umap_uint64_insert:0.0076,umap_uint64_erase:0.0035,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0028,kntrie_int32_insert:0.0230,kntrie_int32_erase:0.0075,kntrie_int32_mem:6152,kntrie_uint64_find:0.0026,kntrie_uint64_insert:0.0234,kntrie_uint64_erase:0.0098,kntrie_uint64_mem:8200,map_int32_find:0.0153,map_int32_insert:0.0343,map_int32_erase:0.0153,map_int32_mem:16176,map_uint64_find:0.0145,map_uint64_insert:0.0340,map_uint64_erase:0.0181,map_uint64_mem:16176,umap_int32_find:0.0040,umap_int32_insert:0.0103,umap_int32_erase:0.0042,umap_int32_mem:10784,umap_uint64_find:0.0041,umap_uint64_insert:0.0115,umap_uint64_erase:0.0047,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0038,kntrie_int32_insert:0.0348,kntrie_int32_erase:0.0093,kntrie_int32_mem:6152,kntrie_uint64_find:0.0041,kntrie_uint64_insert:0.0326,kntrie_uint64_erase:0.0136,kntrie_uint64_mem:8200,map_int32_find:0.0230,map_int32_insert:0.0472,map_int32_erase:0.0232,map_int32_mem:24288,map_uint64_find:0.0235,map_uint64_insert:0.0514,map_uint64_erase:0.0260,map_uint64_mem:24288,umap_int32_find:0.0052,umap_int32_insert:0.0140,umap_int32_erase:0.0060,umap_int32_mem:16472,umap_uint64_find:0.0058,umap_uint64_insert:0.0154,umap_uint64_erase:0.0069,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0072,kntrie_int32_insert:0.0482,kntrie_int32_erase:0.0195,kntrie_int32_mem:12296,kntrie_uint64_find:0.0068,kntrie_uint64_insert:0.0505,kntrie_uint64_erase:0.0216,kntrie_uint64_mem:16392,map_int32_find:0.0410,map_int32_insert:0.0770,map_int32_erase:0.0393,map_int32_mem:36432,map_uint64_find:0.0396,map_uint64_insert:0.0822,map_uint64_erase:0.0399,map_uint64_mem:36432,umap_int32_find:0.0089,umap_int32_insert:0.0227,umap_int32_erase:0.0112,umap_int32_mem:24304,umap_uint64_find:0.0092,umap_uint64_insert:0.0220,umap_uint64_erase:0.0104,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0123,kntrie_int32_insert:0.0814,kntrie_int32_erase:0.0194,kntrie_int32_mem:24584,kntrie_uint64_find:0.0118,kntrie_uint64_insert:0.0798,kntrie_uint64_erase:0.0265,kntrie_uint64_mem:32776,map_int32_find:0.0679,map_int32_insert:0.1217,map_int32_erase:0.0573,map_int32_mem:54672,map_uint64_find:0.0679,map_uint64_insert:0.1203,map_uint64_erase:0.0607,map_uint64_mem:54672,umap_int32_find:0.0131,umap_int32_insert:0.0302,umap_int32_erase:0.0140,umap_int32_mem:36880,umap_uint64_find:0.0137,umap_uint64_insert:0.0317,umap_uint64_erase:0.0142,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0170,kntrie_int32_insert:0.1268,kntrie_int32_erase:0.0321,kntrie_int32_mem:24584,kntrie_uint64_find:0.0197,kntrie_uint64_insert:0.1114,kntrie_uint64_erase:0.0466,kntrie_uint64_mem:32776,map_int32_find:0.1012,map_int32_insert:0.1698,map_int32_erase:0.0850,map_int32_mem:81984,map_uint64_find:0.1194,map_uint64_insert:0.2027,map_uint64_erase:0.1041,map_uint64_mem:81984,umap_int32_find:0.0207,umap_int32_insert:0.0421,umap_int32_erase:0.0207,umap_int32_mem:54920,umap_uint64_find:0.0231,umap_uint64_insert:0.0450,umap_uint64_erase:0.0233,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0288,kntrie_int32_insert:0.1768,kntrie_int32_erase:0.0462,kntrie_int32_mem:49160,kntrie_uint64_find:0.0325,kntrie_uint64_insert:0.2072,kntrie_uint64_erase:0.0693,kntrie_uint64_mem:65544,map_int32_find:0.1704,map_int32_insert:0.2649,map_int32_erase:0.1329,map_int32_mem:122976,map_uint64_find:0.1790,map_uint64_insert:0.2941,map_uint64_erase:0.1531,map_uint64_mem:122976,umap_int32_find:0.0306,umap_int32_insert:0.0591,umap_int32_erase:0.0306,umap_int32_mem:83512,umap_uint64_find:0.0347,umap_uint64_insert:0.0669,umap_uint64_erase:0.0343,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0442,kntrie_int32_insert:0.2491,kntrie_int32_erase:0.0701,kntrie_int32_mem:49160,kntrie_uint64_find:0.0470,kntrie_uint64_insert:0.2948,kntrie_uint64_erase:0.1081,kntrie_uint64_mem:65544,map_int32_find:0.2785,map_int32_insert:0.4222,map_int32_erase:0.2175,map_int32_mem:184512,map_uint64_find:0.2943,map_uint64_insert:0.4472,map_uint64_erase:0.2311,map_uint64_mem:184512,umap_int32_find:0.0487,umap_int32_insert:0.0918,umap_int32_erase:0.0486,umap_int32_mem:124472,umap_uint64_find:0.0545,umap_uint64_insert:0.1001,umap_uint64_erase:0.0529,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0623,kntrie_int32_insert:0.4924,kntrie_int32_erase:1.8814,kntrie_int32_mem:100560,kntrie_uint64_find:0.0666,kntrie_uint64_insert:0.5877,kntrie_uint64_erase:1.9211,kntrie_uint64_mem:131600,map_int32_find:0.4796,map_int32_insert:0.7027,map_int32_erase:0.3632,map_int32_mem:276768,map_uint64_find:0.4824,map_uint64_insert:0.7162,map_uint64_erase:0.3621,map_uint64_mem:276768,umap_int32_find:0.0793,umap_int32_insert:0.1555,umap_int32_erase:0.0808,umap_int32_mem:186008,umap_uint64_find:0.0857,umap_uint64_insert:0.1548,umap_uint64_erase:0.0815,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1241,kntrie_int32_insert:0.6187,kntrie_int32_erase:4.4194,kntrie_int32_mem:157968,kntrie_uint64_find:0.1241,kntrie_uint64_insert:0.6406,kntrie_uint64_erase:4.4843,kntrie_uint64_mem:214544,map_int32_find:0.7634,map_int32_insert:1.0363,map_int32_erase:0.5655,map_int32_mem:415152,map_uint64_find:0.7629,map_uint64_insert:1.0699,map_uint64_erase:0.5679,map_uint64_mem:415152,umap_int32_find:0.1168,umap_int32_insert:0.2247,umap_int32_erase:0.1192,umap_int32_mem:277840,umap_uint64_find:0.1215,umap_uint64_insert:0.2199,umap_uint64_erase:0.1197,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.1549,kntrie_int32_insert:0.8456,kntrie_int32_erase:6.6252,kntrie_int32_mem:207888,kntrie_uint64_find:0.1732,kntrie_uint64_insert:0.9597,kntrie_uint64_erase:6.6746,kntrie_uint64_mem:274960,map_int32_find:1.2654,map_int32_insert:1.6613,map_int32_erase:0.9055,map_int32_mem:622752,map_uint64_find:1.3747,map_uint64_insert:1.8747,map_uint64_erase:1.0362,map_uint64_mem:622752,umap_int32_find:0.1867,umap_int32_insert:0.3405,umap_int32_erase:0.1861,umap_int32_mem:415240,umap_uint64_find:0.2042,umap_uint64_insert:0.3779,umap_uint64_erase:0.2023,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.2999,kntrie_int32_insert:1.3370,kntrie_int32_erase:10.7909,kntrie_int32_mem:380688,kntrie_uint64_find:0.2927,kntrie_uint64_insert:1.3024,kntrie_uint64_erase:9.9983,kntrie_uint64_mem:503824,map_int32_find:2.3842,map_int32_insert:2.9032,map_int32_erase:1.6412,map_int32_mem:934128,map_uint64_find:2.0655,map_uint64_insert:2.8495,map_uint64_erase:1.4626,map_uint64_mem:934128,umap_int32_find:0.2998,umap_int32_insert:0.5502,umap_int32_erase:0.3110,umap_int32_mem:633088,umap_uint64_find:0.3104,umap_uint64_insert:0.5759,umap_uint64_erase:0.2943,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.4542,kntrie_int32_insert:2.0295,kntrie_int32_erase:15.0963,kntrie_int32_mem:444432,kntrie_uint64_find:0.4591,kntrie_uint64_insert:1.9645,kntrie_uint64_erase:15.0455,kntrie_uint64_mem:568336,map_int32_find:4.5420,map_int32_insert:4.8278,map_int32_erase:2.8585,map_int32_mem:1401216,map_uint64_find:4.1169,map_uint64_insert:4.5970,map_uint64_erase:2.6911,map_uint64_mem:1401216,umap_int32_find:0.4579,umap_int32_insert:0.8401,umap_int32_erase:0.4925,umap_int32_mem:946424,umap_uint64_find:0.4441,umap_uint64_insert:0.7832,umap_uint64_erase:0.4374,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:0.7677,kntrie_int32_insert:3.0398,kntrie_int32_erase:24.6307,kntrie_int32_mem:791568,kntrie_uint64_find:0.8058,kntrie_uint64_insert:2.9159,kntrie_uint64_erase:22.8992,kntrie_uint64_mem:1053712,map_int32_find:9.0485,map_int32_insert:8.4822,map_int32_erase:5.3842,map_int32_mem:2101872,map_uint64_find:9.1931,map_uint64_insert:8.9340,map_uint64_erase:5.5064,map_uint64_mem:2101872,umap_int32_find:0.8071,umap_int32_insert:1.3798,umap_int32_erase:0.8331,umap_int32_mem:1414784,umap_uint64_find:0.8040,umap_uint64_insert:1.4022,umap_uint64_erase:0.8590,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.4513,kntrie_int32_insert:4.7126,kntrie_int32_erase:34.1655,kntrie_int32_mem:1163280,kntrie_uint64_find:1.8914,kntrie_uint64_insert:5.2975,kntrie_uint64_erase:36.0405,kntrie_uint64_mem:1573904,map_int32_find:15.5625,map_int32_insert:12.8389,map_int32_erase:8.4398,map_int32_mem:3152832,map_uint64_find:17.5723,map_uint64_insert:15.4986,map_uint64_erase:10.6425,map_uint64_mem:3152832,umap_int32_find:1.2887,umap_int32_insert:2.2498,umap_int32_erase:1.6212,umap_int32_mem:2114872,umap_uint64_find:1.4718,umap_uint64_insert:2.5496,umap_uint64_erase:1.7755,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.5210,kntrie_int32_insert:7.2148,kntrie_int32_erase:54.8911,kntrie_int32_mem:1578000,map_int32_find:31.8367,map_int32_insert:28.0003,map_int32_erase:18.0364,map_int32_mem:4729104,umap_int32_find:2.4546,umap_int32_insert:4.9367,umap_int32_erase:3.3452,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:3.3328,kntrie_uint64_insert:7.7909,kntrie_uint64_erase:55.8595,kntrie_uint64_mem:2102288,map_uint64_find:33.1904,map_uint64_insert:26.4371,map_uint64_erase:18.5673,map_uint64_mem:4729248,umap_uint64_find:2.5500,umap_uint64_insert:5.0678,umap_uint64_erase:3.3922,umap_uint64_mem:3162488},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0077,kntrie_int32_erase:0.0027,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0087,kntrie_uint64_erase:0.0038,kntrie_uint64_mem:2056,map_int32_find:0.0035,map_int32_insert:0.0098,map_int32_erase:0.0049,map_int32_mem:4800,map_uint64_find:0.0033,map_uint64_insert:0.0094,map_uint64_erase:0.0057,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0024,umap_int32_erase:0.0009,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0022,umap_uint64_erase:0.0010,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0011,kntrie_int32_insert:0.0104,kntrie_int32_erase:0.0045,kntrie_int32_mem:3080,kntrie_uint64_find:0.0010,kntrie_uint64_insert:0.0099,kntrie_uint64_erase:0.0050,kntrie_uint64_mem:4104,map_int32_find:0.0059,map_int32_insert:0.0150,map_int32_erase:0.0081,map_int32_mem:7200,map_uint64_find:0.0053,map_uint64_insert:0.0156,map_uint64_erase:0.0080,map_uint64_mem:7200,umap_int32_find:0.0005,umap_int32_insert:0.0041,umap_int32_erase:0.0018,umap_int32_mem:4856,umap_uint64_find:0.0004,umap_uint64_insert:0.0041,umap_uint64_erase:0.0020,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0143,kntrie_int32_erase:0.0046,kntrie_int32_mem:3080,kntrie_uint64_find:0.0016,kntrie_uint64_insert:0.0140,kntrie_uint64_erase:0.0058,kntrie_uint64_mem:4104,map_int32_find:0.0095,map_int32_insert:0.0223,map_int32_erase:0.0101,map_int32_mem:10800,map_uint64_find:0.0089,map_uint64_insert:0.0235,map_uint64_erase:0.0118,map_uint64_mem:10800,umap_int32_find:0.0007,umap_int32_insert:0.0051,umap_int32_erase:0.0014,umap_int32_mem:7216,umap_uint64_find:0.0007,umap_uint64_insert:0.0053,umap_uint64_erase:0.0016,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0027,kntrie_int32_insert:0.0211,kntrie_int32_erase:0.0075,kntrie_int32_mem:6152,kntrie_uint64_find:0.0027,kntrie_uint64_insert:0.0202,kntrie_uint64_erase:0.0090,kntrie_uint64_mem:8200,map_int32_find:0.0152,map_int32_insert:0.0336,map_int32_erase:0.0159,map_int32_mem:16176,map_uint64_find:0.0144,map_uint64_insert:0.0350,map_uint64_erase:0.0165,map_uint64_mem:16176,umap_int32_find:0.0010,umap_int32_insert:0.0076,umap_int32_erase:0.0019,umap_int32_mem:10784,umap_uint64_find:0.0010,umap_uint64_insert:0.0076,umap_uint64_erase:0.0027,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0041,kntrie_int32_insert:0.0355,kntrie_int32_erase:0.0113,kntrie_int32_mem:6152,kntrie_uint64_find:0.0063,kntrie_uint64_insert:0.0432,kntrie_uint64_erase:0.0149,kntrie_uint64_mem:8200,map_int32_find:0.0250,map_int32_insert:0.0517,map_int32_erase:0.0266,map_int32_mem:24288,map_uint64_find:0.0303,map_uint64_insert:0.0669,map_uint64_erase:0.0334,map_uint64_mem:24288,umap_int32_find:0.0015,umap_int32_insert:0.0108,umap_int32_erase:0.0030,umap_int32_mem:16472,umap_uint64_find:0.0017,umap_uint64_insert:0.0172,umap_uint64_erase:0.0053,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0070,kntrie_int32_insert:0.0429,kntrie_int32_erase:0.0171,kntrie_int32_mem:12296,kntrie_uint64_find:0.0066,kntrie_uint64_insert:0.0448,kntrie_uint64_erase:0.0209,kntrie_uint64_mem:16392,map_int32_find:0.0394,map_int32_insert:0.0772,map_int32_erase:0.0371,map_int32_mem:36432,map_uint64_find:0.0386,map_uint64_insert:0.0784,map_uint64_erase:0.0381,map_uint64_mem:36432,umap_int32_find:0.0023,umap_int32_insert:0.0150,umap_int32_erase:0.0047,umap_int32_mem:24304,umap_uint64_find:0.0023,umap_uint64_insert:0.0149,umap_uint64_erase:0.0049,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0113,kntrie_int32_insert:0.0734,kntrie_int32_erase:0.0172,kntrie_int32_mem:24584,kntrie_uint64_find:0.0110,kntrie_uint64_insert:0.0758,kntrie_uint64_erase:0.0244,kntrie_uint64_mem:32776,map_int32_find:0.0611,map_int32_insert:0.1112,map_int32_erase:0.0536,map_int32_mem:54672,map_uint64_find:0.0617,map_uint64_insert:0.1120,map_uint64_erase:0.0536,map_uint64_mem:54672,umap_int32_find:0.0032,umap_int32_insert:0.0197,umap_int32_erase:0.0055,umap_int32_mem:36880,umap_uint64_find:0.0032,umap_uint64_insert:0.0196,umap_uint64_erase:0.0060,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0180,kntrie_int32_insert:0.1210,kntrie_int32_erase:0.0349,kntrie_int32_mem:24584,kntrie_uint64_find:0.0175,kntrie_uint64_insert:0.1011,kntrie_uint64_erase:0.0433,kntrie_uint64_mem:32776,map_int32_find:0.1090,map_int32_insert:0.1829,map_int32_erase:0.0896,map_int32_mem:81984,map_uint64_find:0.1097,map_uint64_insert:0.1912,map_uint64_erase:0.0924,map_uint64_mem:81984,umap_int32_find:0.0050,umap_int32_insert:0.0293,umap_int32_erase:0.0095,umap_int32_mem:54920,umap_uint64_find:0.0050,umap_uint64_insert:0.0315,umap_uint64_erase:0.0099,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0313,kntrie_int32_insert:0.1741,kntrie_int32_erase:0.0472,kntrie_int32_mem:49160,kntrie_uint64_find:0.0305,kntrie_uint64_insert:0.1633,kntrie_uint64_erase:0.0635,kntrie_uint64_mem:65544,map_int32_find:0.1717,map_int32_insert:0.2720,map_int32_erase:0.1408,map_int32_mem:122976,map_uint64_find:0.1693,map_uint64_insert:0.2803,map_uint64_erase:0.1417,map_uint64_mem:122976,umap_int32_find:0.0072,umap_int32_insert:0.0407,umap_int32_erase:0.0145,umap_int32_mem:83512,umap_uint64_find:0.0072,umap_uint64_insert:0.0401,umap_uint64_erase:0.0143,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0433,kntrie_int32_insert:0.2317,kntrie_int32_erase:0.0704,kntrie_int32_mem:49160,kntrie_uint64_find:0.0483,kntrie_uint64_insert:0.2754,kntrie_uint64_erase:0.1070,kntrie_uint64_mem:65544,map_int32_find:0.2740,map_int32_insert:0.4212,map_int32_erase:0.2135,map_int32_mem:184512,map_uint64_find:0.2937,map_uint64_insert:0.4621,map_uint64_erase:0.2410,map_uint64_mem:184512,umap_int32_find:0.0109,umap_int32_insert:0.0570,umap_int32_erase:0.0223,umap_int32_mem:124472,umap_uint64_find:0.0119,umap_uint64_insert:0.0668,umap_uint64_erase:0.0252,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0765,kntrie_int32_insert:0.5054,kntrie_int32_erase:0.3146,kntrie_int32_mem:69888,kntrie_uint64_find:0.1723,kntrie_uint64_insert:0.4978,kntrie_uint64_erase:0.3039,kntrie_uint64_mem:70272,map_int32_find:0.5065,map_int32_insert:0.7314,map_int32_erase:0.3828,map_int32_mem:276768,map_uint64_find:0.4677,map_uint64_insert:0.6647,map_uint64_erase:0.3515,map_uint64_mem:276768,umap_int32_find:0.0180,umap_int32_insert:0.0917,umap_int32_erase:0.0383,umap_int32_mem:186008,umap_uint64_find:0.0166,umap_uint64_insert:0.0901,umap_uint64_erase:0.0348,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.1171,kntrie_int32_insert:0.5801,kntrie_int32_erase:0.8038,kntrie_int32_mem:104464,kntrie_uint64_find:0.2906,kntrie_uint64_insert:0.6151,kntrie_uint64_erase:0.8743,kntrie_uint64_mem:104736,map_int32_find:0.8295,map_int32_insert:1.1328,map_int32_erase:0.6152,map_int32_mem:415152,map_uint64_find:0.8323,map_uint64_insert:1.1953,map_uint64_erase:0.6436,map_uint64_mem:415152,umap_int32_find:0.0262,umap_int32_insert:0.1362,umap_int32_erase:0.0591,umap_int32_mem:277840,umap_uint64_find:0.0275,umap_uint64_insert:0.1345,umap_uint64_erase:0.0580,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.1720,kntrie_int32_insert:0.7670,kntrie_int32_erase:1.6850,kntrie_int32_mem:156736,kntrie_uint64_find:0.4195,kntrie_uint64_insert:0.8015,kntrie_uint64_erase:1.7224,kntrie_uint64_mem:156736,map_int32_find:1.3639,map_int32_insert:1.7921,map_int32_erase:0.9776,map_int32_mem:622752,map_uint64_find:1.3437,map_uint64_insert:1.8427,map_uint64_erase:0.9959,map_uint64_mem:622752,umap_int32_find:0.0384,umap_int32_insert:0.1911,umap_int32_erase:0.0850,umap_int32_mem:415240,umap_uint64_find:0.0384,umap_uint64_insert:0.1976,umap_uint64_erase:0.0990,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.2628,kntrie_int32_insert:1.0473,kntrie_int32_erase:3.5627,kntrie_int32_mem:235568,kntrie_uint64_find:0.6379,kntrie_uint64_insert:1.1255,kntrie_uint64_erase:3.6169,kntrie_uint64_mem:235808,map_int32_find:2.2601,map_int32_insert:2.8728,map_int32_erase:1.5663,map_int32_mem:934128,map_uint64_find:2.2930,map_uint64_insert:2.9790,map_uint64_erase:1.6276,map_uint64_mem:934128,umap_int32_find:0.0580,umap_int32_insert:0.2784,umap_int32_erase:0.1313,umap_int32_mem:633088,umap_uint64_find:0.0578,umap_uint64_insert:0.2789,umap_uint64_erase:0.1320,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.3780,kntrie_int32_insert:1.4221,kntrie_int32_erase:7.1671,kntrie_int32_mem:353696,kntrie_uint64_find:0.9662,kntrie_uint64_insert:1.5805,kntrie_uint64_erase:7.6686,kntrie_uint64_mem:353696,map_int32_find:4.1796,map_int32_insert:4.3298,map_int32_erase:2.6411,map_int32_mem:1401216,map_uint64_find:4.5171,map_uint64_insert:4.8082,map_uint64_erase:2.8955,map_uint64_mem:1401216,umap_int32_find:0.0896,umap_int32_insert:0.3960,umap_int32_erase:0.2150,umap_int32_mem:946424,umap_uint64_find:0.0992,umap_uint64_insert:0.4107,umap_uint64_erase:0.3061,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.6384,kntrie_int32_insert:2.2243,kntrie_int32_erase:16.5221,kntrie_int32_mem:529808,kntrie_uint64_find:1.4042,kntrie_uint64_insert:2.1684,kntrie_uint64_erase:15.5726,kntrie_uint64_mem:530304,map_int32_find:8.9131,map_int32_insert:8.5570,map_int32_erase:5.3700,map_int32_mem:2101872,map_uint64_find:7.9190,map_uint64_insert:7.5771,map_uint64_erase:4.7543,map_uint64_mem:2101872,umap_int32_find:0.2503,umap_int32_insert:0.6584,umap_int32_erase:0.4591,umap_int32_mem:1414784,umap_uint64_find:0.2049,umap_uint64_insert:0.5895,umap_uint64_erase:0.4572,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:1.0054,kntrie_int32_insert:3.7700,kntrie_int32_erase:71.4408,kntrie_int32_mem:796296,kntrie_uint64_find:2.2248,kntrie_uint64_insert:3.8169,kntrie_uint64_erase:69.1759,kntrie_uint64_mem:796584,map_int32_find:16.9908,map_int32_insert:14.0437,map_int32_erase:9.3812,map_int32_mem:3152832,map_uint64_find:16.4591,map_uint64_insert:15.1484,map_uint64_erase:10.0030,map_uint64_mem:3152832,umap_int32_find:0.5709,umap_int32_insert:1.0339,umap_int32_erase:1.1561,umap_int32_mem:2114872,umap_uint64_find:0.5508,umap_uint64_insert:1.0847,umap_uint64_erase:1.2118,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.5362,kntrie_int32_insert:5.8081,kntrie_int32_erase:125.2802,kntrie_int32_mem:1192592,kntrie_uint64_find:3.7361,kntrie_uint64_insert:6.3013,kntrie_uint64_erase:126.2652,kntrie_uint64_mem:1192880,map_int32_find:30.5769,map_int32_insert:25.3644,map_int32_erase:16.9730,map_int32_mem:4729248,map_uint64_find:34.1836,map_uint64_insert:28.4372,map_uint64_erase:18.9929,map_uint64_mem:4729248,umap_int32_find:1.0647,umap_int32_insert:1.8992,umap_int32_erase:2.1799,umap_int32_mem:3162488,umap_uint64_find:1.0780,umap_uint64_insert:1.9724,umap_uint64_erase:2.3053,umap_uint64_mem:3162488},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
