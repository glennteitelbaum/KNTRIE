<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0008,kntrie_int32_insert:0.0055,kntrie_int32_erase:0.0026,kntrie_int32_mem:1552,kntrie_uint64_find:0.0009,kntrie_uint64_insert:0.0066,kntrie_uint64_erase:0.0042,kntrie_uint64_mem:2064,map_int32_find:0.0013,map_int32_insert:0.0075,map_int32_erase:0.0044,map_int32_mem:4800,map_uint64_find:0.0013,map_uint64_insert:0.0085,map_uint64_erase:0.0056,map_uint64_mem:4800,umap_int32_find:0.0010,umap_int32_insert:0.0022,umap_int32_erase:0.0017,umap_int32_mem:3224,umap_uint64_find:0.0012,umap_uint64_insert:0.0026,umap_uint64_erase:0.0023,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0013,kntrie_int32_insert:0.0088,kntrie_int32_erase:0.0034,kntrie_int32_mem:3088,kntrie_uint64_find:0.0015,kntrie_uint64_insert:0.0089,kntrie_uint64_erase:0.0046,kntrie_uint64_mem:4112,map_int32_find:0.0023,map_int32_insert:0.0114,map_int32_erase:0.0068,map_int32_mem:7200,map_uint64_find:0.0023,map_uint64_insert:0.0128,map_uint64_erase:0.0081,map_uint64_mem:7200,umap_int32_find:0.0018,umap_int32_insert:0.0050,umap_int32_erase:0.0024,umap_int32_mem:4856,umap_uint64_find:0.0017,umap_uint64_insert:0.0054,umap_uint64_erase:0.0028,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0020,kntrie_int32_insert:0.0125,kntrie_int32_erase:0.0044,kntrie_int32_mem:3088,kntrie_uint64_find:0.0021,kntrie_uint64_insert:0.0153,kntrie_uint64_erase:0.0054,kntrie_uint64_mem:4112,map_int32_find:0.0036,map_int32_insert:0.0164,map_int32_erase:0.0090,map_int32_mem:10800,map_uint64_find:0.0036,map_uint64_insert:0.0182,map_uint64_erase:0.0106,map_uint64_mem:10800,umap_int32_find:0.0029,umap_int32_insert:0.0075,umap_int32_erase:0.0030,umap_int32_mem:7216,umap_uint64_find:0.0029,umap_uint64_insert:0.0073,umap_uint64_erase:0.0033,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0032,kntrie_int32_insert:0.0178,kntrie_int32_erase:0.0065,kntrie_int32_mem:6160,kntrie_uint64_find:0.0035,kntrie_uint64_insert:0.0204,kntrie_uint64_erase:0.0083,kntrie_uint64_mem:8208,map_int32_find:0.0058,map_int32_insert:0.0271,map_int32_erase:0.0140,map_int32_mem:16176,map_uint64_find:0.0057,map_uint64_insert:0.0278,map_uint64_erase:0.0163,map_uint64_mem:16176,umap_int32_find:0.0037,umap_int32_insert:0.0098,umap_int32_erase:0.0039,umap_int32_mem:10784,umap_uint64_find:0.0040,umap_uint64_insert:0.0102,umap_uint64_erase:0.0048,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0049,kntrie_int32_insert:0.0325,kntrie_int32_erase:0.0090,kntrie_int32_mem:6160,kntrie_uint64_find:0.0053,kntrie_uint64_insert:0.0327,kntrie_uint64_erase:0.0114,kntrie_uint64_mem:8208,map_int32_find:0.0092,map_int32_insert:0.0407,map_int32_erase:0.0225,map_int32_mem:24288,map_uint64_find:0.0095,map_uint64_insert:0.0419,map_uint64_erase:0.0254,map_uint64_mem:24288,umap_int32_find:0.0050,umap_int32_insert:0.0132,umap_int32_erase:0.0059,umap_int32_mem:16472,umap_uint64_find:0.0058,umap_uint64_insert:0.0147,umap_uint64_erase:0.0065,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0078,kntrie_int32_insert:0.0422,kntrie_int32_erase:0.0161,kntrie_int32_mem:12304,kntrie_uint64_find:0.0085,kntrie_uint64_insert:0.0462,kntrie_uint64_erase:0.0185,kntrie_uint64_mem:16400,map_int32_find:0.0153,map_int32_insert:0.0610,map_int32_erase:0.0377,map_int32_mem:36432,map_uint64_find:0.0151,map_uint64_insert:0.0643,map_uint64_erase:0.0388,map_uint64_mem:36432,umap_int32_find:0.0088,umap_int32_insert:0.0223,umap_int32_erase:0.0099,umap_int32_mem:24304,umap_uint64_find:0.0094,umap_uint64_insert:0.0214,umap_uint64_erase:0.0105,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0137,kntrie_int32_insert:0.0790,kntrie_int32_erase:0.0191,kntrie_int32_mem:24592,kntrie_uint64_find:0.0139,kntrie_uint64_insert:0.0763,kntrie_uint64_erase:0.0197,kntrie_uint64_mem:32784,map_int32_find:0.0269,map_int32_insert:0.1029,map_int32_erase:0.0583,map_int32_mem:54672,map_uint64_find:0.0266,map_uint64_insert:0.1005,map_uint64_erase:0.0596,map_uint64_mem:54672,umap_int32_find:0.0125,umap_int32_insert:0.0296,umap_int32_erase:0.0141,umap_int32_mem:36880,umap_uint64_find:0.0132,umap_uint64_insert:0.0301,umap_uint64_erase:0.0143,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0210,kntrie_int32_insert:0.1118,kntrie_int32_erase:0.0346,kntrie_int32_mem:24592,kntrie_uint64_find:0.0209,kntrie_uint64_insert:0.1082,kntrie_uint64_erase:0.0343,kntrie_uint64_mem:32784,map_int32_find:0.0449,map_int32_insert:0.1616,map_int32_erase:0.0904,map_int32_mem:81984,map_uint64_find:0.0419,map_uint64_insert:0.1620,map_uint64_erase:0.0969,map_uint64_mem:81984,umap_int32_find:0.0219,umap_int32_insert:0.0456,umap_int32_erase:0.0224,umap_int32_mem:54920,umap_uint64_find:0.0226,umap_uint64_insert:0.0437,umap_uint64_erase:0.0228,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0351,kntrie_int32_insert:0.1773,kntrie_int32_erase:0.0497,kntrie_int32_mem:49168,kntrie_uint64_find:0.0375,kntrie_uint64_insert:0.1787,kntrie_uint64_erase:0.0548,kntrie_uint64_mem:65552,map_int32_find:0.0720,map_int32_insert:0.2597,map_int32_erase:0.1398,map_int32_mem:122976,map_uint64_find:0.0690,map_uint64_insert:0.2549,map_uint64_erase:0.1417,map_uint64_mem:122976,umap_int32_find:0.0318,umap_int32_insert:0.0656,umap_int32_erase:0.0336,umap_int32_mem:83512,umap_uint64_find:0.0347,umap_uint64_insert:0.0652,umap_uint64_erase:0.0395,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0527,kntrie_int32_insert:0.2800,kntrie_int32_erase:0.0786,kntrie_int32_mem:49168,kntrie_uint64_find:0.0550,kntrie_uint64_insert:0.2615,kntrie_uint64_erase:0.0825,kntrie_uint64_mem:65552,map_int32_find:0.1227,map_int32_insert:0.4376,map_int32_erase:0.2268,map_int32_mem:184512,map_uint64_find:0.1150,map_uint64_insert:0.4062,map_uint64_erase:0.2267,map_uint64_mem:184512,umap_int32_find:0.0511,umap_int32_insert:0.0990,umap_int32_erase:0.0535,umap_int32_mem:124472,umap_uint64_find:0.0555,umap_uint64_insert:0.1039,umap_uint64_erase:0.0536,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0855,kntrie_int32_insert:0.5064,kntrie_int32_erase:0.1493,kntrie_int32_mem:100568,kntrie_uint64_find:0.0928,kntrie_uint64_insert:0.5269,kntrie_uint64_erase:0.1583,kntrie_uint64_mem:131608,map_int32_find:0.1951,map_int32_insert:0.7008,map_int32_erase:0.3801,map_int32_mem:276768,map_uint64_find:0.1865,map_uint64_insert:0.6773,map_uint64_erase:0.3723,map_uint64_mem:276768,umap_int32_find:0.0799,umap_int32_insert:0.1578,umap_int32_erase:0.0819,umap_int32_mem:186008,umap_uint64_find:0.0860,umap_uint64_insert:0.1577,umap_uint64_erase:0.0829,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1740,kntrie_int32_insert:0.7173,kntrie_int32_erase:0.2072,kntrie_int32_mem:157976,kntrie_uint64_find:0.1809,kntrie_uint64_insert:0.7053,kntrie_uint64_erase:0.2267,kntrie_uint64_mem:214552,map_int32_find:0.3363,map_int32_insert:1.1311,map_int32_erase:0.6089,map_int32_mem:415152,map_uint64_find:0.3261,map_uint64_insert:1.1054,map_uint64_erase:0.6037,map_uint64_mem:415152,umap_int32_find:0.1282,umap_int32_insert:0.2399,umap_int32_erase:0.1328,umap_int32_mem:277840,umap_uint64_find:0.1304,umap_uint64_insert:0.2373,umap_uint64_erase:0.1307,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.2245,kntrie_int32_insert:1.0098,kntrie_int32_erase:0.3360,kntrie_int32_mem:207896,kntrie_uint64_find:0.2354,kntrie_uint64_insert:0.9981,kntrie_uint64_erase:0.3403,kntrie_uint64_mem:274968,map_int32_find:0.5848,map_int32_insert:1.8101,map_int32_erase:1.0321,map_int32_mem:622752,map_uint64_find:0.5533,map_uint64_insert:1.7229,map_uint64_erase:1.0316,map_uint64_mem:622752,umap_int32_find:0.2039,umap_int32_insert:0.3643,umap_int32_erase:0.2096,umap_int32_mem:415240,umap_uint64_find:0.2002,umap_uint64_insert:0.3651,umap_uint64_erase:0.1963,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.3971,kntrie_int32_insert:1.4454,kntrie_int32_erase:0.4984,kntrie_int32_mem:380696,kntrie_uint64_find:0.4183,kntrie_uint64_insert:1.4862,kntrie_uint64_erase:0.5245,kntrie_uint64_mem:503832,map_int32_find:0.9185,map_int32_insert:2.8444,map_int32_erase:1.6288,map_int32_mem:934128,map_uint64_find:0.9255,map_uint64_insert:2.7321,map_uint64_erase:1.6916,map_uint64_mem:934128,umap_int32_find:0.2952,umap_int32_insert:0.5343,umap_int32_erase:0.3046,umap_int32_mem:633088,umap_uint64_find:0.3010,umap_uint64_insert:0.5628,umap_uint64_erase:0.3115,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.6160,kntrie_int32_insert:2.1555,kntrie_int32_erase:0.7441,kntrie_int32_mem:444440,kntrie_uint64_find:0.6416,kntrie_uint64_insert:2.2228,kntrie_uint64_erase:0.7755,kntrie_uint64_mem:568344,map_int32_find:1.6767,map_int32_insert:4.6291,map_int32_erase:2.8667,map_int32_mem:1401216,map_uint64_find:1.6425,map_uint64_insert:5.1105,map_uint64_erase:2.8257,map_uint64_mem:1401216,umap_int32_find:0.4547,umap_int32_insert:0.8096,umap_int32_erase:0.4606,umap_int32_mem:946424,umap_uint64_find:0.4847,umap_uint64_insert:0.8305,umap_uint64_erase:0.4982,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:1.0067,kntrie_int32_insert:3.1706,kntrie_int32_erase:1.1831,kntrie_int32_mem:791576,kntrie_uint64_find:1.1332,kntrie_uint64_insert:3.3651,kntrie_uint64_erase:1.2887,kntrie_uint64_mem:1053720,map_int32_find:3.1146,map_int32_insert:7.7227,map_int32_erase:5.4028,map_int32_mem:2101872,map_uint64_find:3.2493,map_uint64_insert:9.3441,map_uint64_erase:5.4353,map_uint64_mem:2101872,umap_int32_find:0.7376,umap_int32_insert:1.3114,umap_int32_erase:0.7900,umap_int32_mem:1414784,umap_uint64_find:0.8015,umap_uint64_insert:1.3453,umap_uint64_erase:0.8422,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.8797,kntrie_int32_insert:5.3713,kntrie_int32_erase:1.5994,kntrie_int32_mem:1163288,kntrie_uint64_find:2.3971,kntrie_uint64_insert:5.7963,kntrie_uint64_erase:2.0201,kntrie_uint64_mem:1573912,map_int32_find:5.6415,map_int32_insert:13.8367,map_int32_erase:9.2423,map_int32_mem:3152832,map_uint64_find:6.5741,map_uint64_insert:17.0401,map_uint64_erase:9.8051,map_uint64_mem:3152832,umap_int32_find:1.3408,umap_int32_insert:2.2368,umap_int32_erase:1.6041,umap_int32_mem:2114872,umap_uint64_find:1.4582,umap_uint64_insert:2.4621,umap_uint64_erase:1.6697,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.8555,kntrie_int32_insert:7.7303,kntrie_int32_erase:2.9356,kntrie_int32_mem:1578008,map_int32_find:10.4181,map_int32_insert:24.8062,map_int32_erase:16.3739,map_int32_mem:4729104,umap_int32_find:2.3201,umap_int32_insert:4.4595,umap_int32_erase:3.2602,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:4.7497,kntrie_uint64_insert:8.8797,kntrie_uint64_erase:3.7045,kntrie_uint64_mem:2102296,map_uint64_find:10.8167,map_uint64_insert:32.2344,map_uint64_erase:17.9044,map_uint64_mem:4729248,umap_uint64_find:2.4258,umap_uint64_insert:5.3171,umap_uint64_erase:3.2142,umap_uint64_mem:3162488},
  {pattern:"random",N:147785,kntrie_int32_find:6.7062,kntrie_int32_insert:12.4929,kntrie_int32_erase:4.3986,kntrie_int32_mem:3150872,map_int32_find:21.7984,map_int32_insert:46.7641,map_int32_erase:31.2117,map_int32_mem:7093680,umap_int32_find:3.8352,umap_int32_insert:8.8433,umap_int32_erase:5.5648,umap_int32_mem:4729184},
  {pattern:"random",N:147789,kntrie_uint64_find:10.0330,kntrie_uint64_insert:15.5903,kntrie_uint64_erase:6.4728,kntrie_uint64_mem:4183064,map_uint64_find:19.5421,map_uint64_insert:49.9907,map_uint64_erase:32.2601,map_uint64_mem:7093872,umap_uint64_find:3.9051,umap_uint64_insert:8.5871,umap_uint64_erase:5.2868,umap_uint64_mem:4729280},
  {pattern:"random",N:221675,kntrie_int32_find:9.9564,kntrie_int32_insert:19.2249,kntrie_int32_erase:8.2863,kntrie_int32_mem:3150872,map_int32_find:39.2743,map_int32_insert:85.6025,map_int32_erase:55.6414,map_int32_mem:10640400,umap_int32_find:6.4602,umap_int32_insert:21.2326,umap_int32_erase:8.6312,umap_int32_mem:7215376},
  {pattern:"random",N:221683,kntrie_uint64_find:14.5052,kntrie_uint64_insert:24.4057,kntrie_uint64_erase:11.8209,kntrie_uint64_mem:4199448,map_uint64_find:37.8095,map_uint64_insert:95.2370,map_uint64_erase:58.9170,map_uint64_mem:10640784,umap_uint64_find:6.3805,umap_uint64_insert:14.3470,umap_uint64_erase:9.0378,umap_uint64_mem:7215568},
  {pattern:"random",N:332509,kntrie_int32_find:22.3842,kntrie_int32_insert:37.0840,kntrie_int32_erase:17.0725,kntrie_int32_mem:6296600,map_int32_find:77.6168,map_int32_insert:157.3220,map_int32_erase:103.5337,map_int32_mem:15960432,umap_int32_find:10.1937,umap_int32_insert:24.9092,umap_int32_erase:15.1640,umap_int32_mem:10788704},
  {pattern:"random",N:332525,kntrie_uint64_find:31.9604,kntrie_uint64_insert:45.8547,kntrie_uint64_erase:22.0460,kntrie_uint64_mem:8393752,map_uint64_find:68.2880,map_uint64_insert:164.9461,map_uint64_erase:98.1758,map_uint64_mem:15961200,umap_uint64_find:9.8940,umap_uint64_insert:22.5243,umap_uint64_erase:14.0703,umap_uint64_mem:10789088},
  {pattern:"random",N:498753,kntrie_int32_find:36.6032,kntrie_int32_insert:68.9085,kntrie_int32_erase:27.9083,kntrie_int32_mem:6444056,map_int32_find:110.4672,map_int32_insert:252.9750,map_int32_erase:165.7563,map_int32_mem:23940144,umap_int32_find:15.8226,umap_int32_insert:38.2099,umap_int32_erase:23.8827,umap_int32_mem:16132000},
  {pattern:"random",N:498788,kntrie_uint64_find:48.0891,kntrie_uint64_insert:84.5965,kntrie_uint64_erase:37.5611,kntrie_uint64_mem:8524824,map_uint64_find:129.5650,map_uint64_insert:293.5525,map_uint64_erase:167.5288,map_uint64_mem:23941824,umap_uint64_find:16.3140,umap_uint64_insert:37.8512,umap_uint64_erase:23.8260,umap_uint64_mem:16132840},
  {pattern:"random",N:748117,kntrie_int32_find:79.9906,kntrie_int32_insert:114.0673,kntrie_int32_erase:53.0139,kntrie_int32_mem:12588056,map_int32_find:186.3537,map_int32_insert:418.0201,map_int32_erase:264.7094,map_int32_mem:35909616,umap_int32_find:24.7133,umap_int32_insert:58.8440,umap_int32_erase:37.6907,umap_int32_mem:24123200},
  {pattern:"random",N:748182,kntrie_uint64_find:107.0230,kntrie_uint64_insert:163.8688,kntrie_uint64_erase:75.4727,kntrie_uint64_mem:16782360,map_uint64_find:256.1166,map_uint64_insert:541.4744,map_uint64_erase:354.7368,map_uint64_mem:35912736,umap_uint64_find:28.1653,umap_uint64_insert:72.8036,umap_uint64_erase:44.9169,umap_uint64_mem:24124760},
  {pattern:"random",N:1122145,kntrie_int32_find:94.6568,kntrie_int32_insert:259.9836,kntrie_int32_erase:73.5366,kntrie_int32_mem:17446232,umap_int32_find:39.0087,umap_int32_insert:95.0647,umap_int32_erase:58.8487,umap_int32_mem:36074048},
  {pattern:"random",N:1122274,kntrie_uint64_find:123.9189,kntrie_uint64_insert:360.8167,kntrie_uint64_erase:102.2642,kntrie_uint64_mem:27146008,umap_uint64_find:44.3971,umap_uint64_insert:113.0428,umap_uint64_erase:66.8208,umap_uint64_mem:36077144},
  {pattern:"random",N:1683111,kntrie_int32_find:148.6239,kntrie_int32_insert:347.4478,kntrie_int32_erase:115.2511,kntrie_int32_mem:23942792,umap_int32_find:62.0023,umap_int32_insert:149.1311,umap_int32_erase:92.7956,umap_int32_mem:53945536},
  {pattern:"random",N:1683411,kntrie_uint64_find:202.3014,kntrie_uint64_insert:500.7117,kntrie_uint64_erase:168.0613,kntrie_uint64_mem:37514264,umap_uint64_find:73.6428,umap_uint64_insert:217.1845,umap_uint64_erase:127.6320,umap_uint64_mem:53952736},
  {pattern:"random",N:2524384,kntrie_int32_find:265.1943,kntrie_int32_insert:497.0451,kntrie_int32_erase:181.1173,kntrie_int32_mem:39793112,umap_int32_find:95.7164,umap_int32_insert:244.1149,umap_int32_erase:153.9297,umap_int32_mem:82315208},
  {pattern:"random",N:2525116,kntrie_uint64_find:399.1949,kntrie_uint64_insert:813.5133,kntrie_uint64_erase:345.3185,kntrie_uint64_mem:62881048,umap_uint64_find:120.1641,umap_uint64_insert:352.6410,umap_uint64_erase:208.1811,umap_uint64_mem:82332776},
  {pattern:"random",N:3786033,kntrie_int32_find:433.3608,kntrie_int32_insert:781.8799,kntrie_int32_erase:291.4626,kntrie_int32_mem:51091992,umap_int32_find:167.4890,umap_int32_insert:424.6968,umap_int32_erase:255.1976,umap_int32_mem:123073040},
  {pattern:"random",N:3787675,kntrie_uint64_find:532.8617,kntrie_uint64_insert:1020.1964,kntrie_uint64_erase:382.8401,kntrie_uint64_mem:81038360,umap_uint64_find:160.8442,umap_uint64_insert:436.8109,umap_uint64_erase:247.3031,umap_uint64_mem:123112448},
  {pattern:"random",N:5677748,kntrie_int32_find:733.6679,kntrie_int32_insert:1290.6525,kntrie_int32_erase:532.5341,kntrie_int32_mem:84892952,umap_int32_find:278.2691,umap_int32_insert:731.9314,umap_int32_erase:441.7552,umap_int32_mem:184004728},
  {pattern:"random",N:5681512,kntrie_uint64_find:1020.2711,kntrie_uint64_insert:1648.3081,kntrie_uint64_erase:757.4802,kntrie_uint64_mem:135109656,umap_uint64_find:278.1589,umap_uint64_insert:699.2410,umap_uint64_erase:446.5306,umap_uint64_mem:184095064},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0009,kntrie_int32_insert:0.0064,kntrie_int32_erase:0.0031,kntrie_int32_mem:1552,kntrie_uint64_find:0.0009,kntrie_uint64_insert:0.0067,kntrie_uint64_erase:0.0033,kntrie_uint64_mem:2064,map_int32_find:0.0013,map_int32_insert:0.0092,map_int32_erase:0.0054,map_int32_mem:4800,map_uint64_find:0.0012,map_uint64_insert:0.0080,map_uint64_erase:0.0053,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0011,umap_int32_erase:0.0008,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0013,umap_uint64_erase:0.0011,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0014,kntrie_int32_insert:0.0089,kntrie_int32_erase:0.0039,kntrie_int32_mem:3088,kntrie_uint64_find:0.0014,kntrie_uint64_insert:0.0093,kntrie_uint64_erase:0.0041,kntrie_uint64_mem:4112,map_int32_find:0.0024,map_int32_insert:0.0118,map_int32_erase:0.0067,map_int32_mem:7200,map_uint64_find:0.0023,map_uint64_insert:0.0133,map_uint64_erase:0.0080,map_uint64_mem:7200,umap_int32_find:0.0005,umap_int32_insert:0.0049,umap_int32_erase:0.0015,umap_int32_mem:4856,umap_uint64_find:0.0005,umap_uint64_insert:0.0036,umap_uint64_erase:0.0018,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0021,kntrie_int32_insert:0.0138,kntrie_int32_erase:0.0049,kntrie_int32_mem:3088,kntrie_uint64_find:0.0021,kntrie_uint64_insert:0.0136,kntrie_uint64_erase:0.0049,kntrie_uint64_mem:4112,map_int32_find:0.0038,map_int32_insert:0.0175,map_int32_erase:0.0102,map_int32_mem:10800,map_uint64_find:0.0033,map_uint64_insert:0.0177,map_uint64_erase:0.0118,map_uint64_mem:10800,umap_int32_find:0.0007,umap_int32_insert:0.0048,umap_int32_erase:0.0011,umap_int32_mem:7216,umap_uint64_find:0.0007,umap_uint64_insert:0.0050,umap_uint64_erase:0.0013,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0035,kntrie_int32_insert:0.0194,kntrie_int32_erase:0.0070,kntrie_int32_mem:6160,kntrie_uint64_find:0.0034,kntrie_uint64_insert:0.0205,kntrie_uint64_erase:0.0077,kntrie_uint64_mem:8208,map_int32_find:0.0064,map_int32_insert:0.0274,map_int32_erase:0.0158,map_int32_mem:16176,map_uint64_find:0.0059,map_uint64_insert:0.0270,map_uint64_erase:0.0172,map_uint64_mem:16176,umap_int32_find:0.0010,umap_int32_insert:0.0070,umap_int32_erase:0.0019,umap_int32_mem:10784,umap_uint64_find:0.0010,umap_uint64_insert:0.0093,umap_uint64_erase:0.0033,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0053,kntrie_int32_insert:0.0336,kntrie_int32_erase:0.0108,kntrie_int32_mem:6160,kntrie_uint64_find:0.0053,kntrie_uint64_insert:0.0371,kntrie_uint64_erase:0.0118,kntrie_uint64_mem:8208,map_int32_find:0.0102,map_int32_insert:0.0430,map_int32_erase:0.0242,map_int32_mem:24288,map_uint64_find:0.0096,map_uint64_insert:0.0423,map_uint64_erase:0.0257,map_uint64_mem:24288,umap_int32_find:0.0016,umap_int32_insert:0.0100,umap_int32_erase:0.0030,umap_int32_mem:16472,umap_uint64_find:0.0016,umap_uint64_insert:0.0101,umap_uint64_erase:0.0035,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0086,kntrie_int32_insert:0.0447,kntrie_int32_erase:0.0182,kntrie_int32_mem:12304,kntrie_uint64_find:0.0086,kntrie_uint64_insert:0.0445,kntrie_uint64_erase:0.0174,kntrie_uint64_mem:16400,map_int32_find:0.0168,map_int32_insert:0.0656,map_int32_erase:0.0357,map_int32_mem:36432,map_uint64_find:0.0154,map_uint64_insert:0.0651,map_uint64_erase:0.0383,map_uint64_mem:36432,umap_int32_find:0.0023,umap_int32_insert:0.0149,umap_int32_erase:0.0042,umap_int32_mem:24304,umap_uint64_find:0.0023,umap_uint64_insert:0.0156,umap_uint64_erase:0.0050,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0137,kntrie_int32_insert:0.0844,kntrie_int32_erase:0.0192,kntrie_int32_mem:24592,kntrie_uint64_find:0.0140,kntrie_uint64_insert:0.0804,kntrie_uint64_erase:0.0200,kntrie_uint64_mem:32784,map_int32_find:0.0281,map_int32_insert:0.1043,map_int32_erase:0.0556,map_int32_mem:54672,map_uint64_find:0.0268,map_uint64_insert:0.1025,map_uint64_erase:0.0566,map_uint64_mem:54672,umap_int32_find:0.0035,umap_int32_insert:0.0204,umap_int32_erase:0.0063,umap_int32_mem:36880,umap_uint64_find:0.0035,umap_uint64_insert:0.0224,umap_uint64_erase:0.0064,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0211,kntrie_int32_insert:0.1039,kntrie_int32_erase:0.0355,kntrie_int32_mem:24592,kntrie_uint64_find:0.0213,kntrie_uint64_insert:0.1059,kntrie_uint64_erase:0.0349,kntrie_uint64_mem:32784,map_int32_find:0.0461,map_int32_insert:0.1617,map_int32_erase:0.0894,map_int32_mem:81984,map_uint64_find:0.0431,map_uint64_insert:0.1605,map_uint64_erase:0.0896,map_uint64_mem:81984,umap_int32_find:0.0052,umap_int32_insert:0.0290,umap_int32_erase:0.0096,umap_int32_mem:54920,umap_uint64_find:0.0052,umap_uint64_insert:0.0293,umap_uint64_erase:0.0100,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0350,kntrie_int32_insert:0.1748,kntrie_int32_erase:0.0499,kntrie_int32_mem:49168,kntrie_uint64_find:0.0368,kntrie_uint64_insert:0.1712,kntrie_uint64_erase:0.0518,kntrie_uint64_mem:65552,map_int32_find:0.0748,map_int32_insert:0.2587,map_int32_erase:0.1405,map_int32_mem:122976,map_uint64_find:0.0712,map_uint64_insert:0.2727,map_uint64_erase:0.1424,map_uint64_mem:122976,umap_int32_find:0.0078,umap_int32_insert:0.0433,umap_int32_erase:0.0158,umap_int32_mem:83512,umap_uint64_find:0.0078,umap_uint64_insert:0.0447,umap_uint64_erase:0.0161,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0527,kntrie_int32_insert:0.2861,kntrie_int32_erase:0.0773,kntrie_int32_mem:49168,kntrie_uint64_find:0.0551,kntrie_uint64_insert:0.2769,kntrie_uint64_erase:0.0814,kntrie_uint64_mem:65552,map_int32_find:0.1281,map_int32_insert:0.4318,map_int32_erase:0.2391,map_int32_mem:184512,map_uint64_find:0.1247,map_uint64_insert:0.4185,map_uint64_erase:0.2418,map_uint64_mem:184512,umap_int32_find:0.0119,umap_int32_insert:0.0606,umap_int32_erase:0.0248,umap_int32_mem:124472,umap_uint64_find:0.0119,umap_uint64_insert:0.0638,umap_uint64_erase:0.0248,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0499,kntrie_int32_insert:0.4526,kntrie_int32_erase:0.0998,kntrie_int32_mem:69760,kntrie_uint64_find:0.0608,kntrie_uint64_insert:0.4772,kntrie_uint64_erase:0.1131,kntrie_uint64_mem:69760,map_int32_find:0.2035,map_int32_insert:0.6865,map_int32_erase:0.3789,map_int32_mem:276768,map_uint64_find:0.1996,map_uint64_insert:0.6786,map_uint64_erase:0.3752,map_uint64_mem:276768,umap_int32_find:0.0178,umap_int32_insert:0.0895,umap_int32_erase:0.0390,umap_int32_mem:186008,umap_uint64_find:0.0175,umap_uint64_insert:0.0960,umap_uint64_erase:0.0384,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.0774,kntrie_int32_insert:0.5581,kntrie_int32_erase:0.1559,kntrie_int32_mem:104368,kntrie_uint64_find:0.0937,kntrie_uint64_insert:0.5722,kntrie_uint64_erase:0.1738,kntrie_uint64_mem:104368,map_int32_find:0.3461,map_int32_insert:1.1335,map_int32_erase:0.6263,map_int32_mem:415152,map_uint64_find:0.3303,map_uint64_insert:1.0927,map_uint64_erase:0.6163,map_uint64_mem:415152,umap_int32_find:0.0270,umap_int32_insert:0.1326,umap_int32_erase:0.0599,umap_int32_mem:277840,umap_uint64_find:0.0267,umap_uint64_insert:0.1383,umap_uint64_erase:0.0593,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.1171,kntrie_int32_insert:0.7606,kntrie_int32_erase:0.2457,kntrie_int32_mem:156480,kntrie_uint64_find:0.1406,kntrie_uint64_insert:0.7741,kntrie_uint64_erase:0.2695,kntrie_uint64_mem:156480,map_int32_find:0.5653,map_int32_insert:1.7831,map_int32_erase:1.0141,map_int32_mem:622752,map_uint64_find:0.5625,map_uint64_insert:1.7168,map_uint64_erase:1.0120,map_uint64_mem:622752,umap_int32_find:0.0394,umap_int32_insert:0.1964,umap_int32_erase:0.0905,umap_int32_mem:415240,umap_uint64_find:0.0394,umap_uint64_insert:0.2029,umap_uint64_erase:0.0899,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.1791,kntrie_int32_insert:1.0716,kntrie_int32_erase:0.3803,kntrie_int32_mem:235584,kntrie_uint64_find:0.2132,kntrie_uint64_insert:1.1134,kntrie_uint64_erase:0.4216,kntrie_uint64_mem:235584,map_int32_find:0.9719,map_int32_insert:2.8571,map_int32_erase:1.6538,map_int32_mem:934128,map_uint64_find:0.9417,map_uint64_insert:2.9618,map_uint64_erase:1.6471,map_uint64_mem:934128,umap_int32_find:0.0596,umap_int32_insert:0.2856,umap_int32_erase:0.1414,umap_int32_mem:633088,umap_uint64_find:0.0591,umap_uint64_insert:0.2980,umap_uint64_erase:0.1339,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.2758,kntrie_int32_insert:1.4424,kntrie_int32_erase:0.5939,kntrie_int32_mem:353184,kntrie_uint64_find:0.3319,kntrie_uint64_insert:1.6048,kntrie_uint64_erase:0.6579,kntrie_uint64_mem:353184,map_int32_find:1.6692,map_int32_insert:4.6092,map_int32_erase:2.7519,map_int32_mem:1401216,map_uint64_find:1.7614,map_uint64_insert:4.5353,map_uint64_erase:2.8119,map_uint64_mem:1401216,umap_int32_find:0.0923,umap_int32_insert:0.4312,umap_int32_erase:0.2162,umap_int32_mem:946424,umap_uint64_find:0.0999,umap_uint64_insert:0.4489,umap_uint64_erase:0.2375,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.4419,kntrie_int32_insert:2.1392,kntrie_int32_erase:0.9283,kntrie_int32_mem:529824,kntrie_uint64_find:0.5264,kntrie_uint64_insert:2.2774,kntrie_uint64_erase:1.0248,kntrie_uint64_mem:529824,map_int32_find:3.0924,map_int32_insert:7.8479,map_int32_erase:5.0582,map_int32_mem:2101872,map_uint64_find:3.1373,map_uint64_insert:7.5998,map_uint64_erase:5.1902,map_uint64_mem:2101872,umap_int32_find:0.2140,umap_int32_insert:0.6493,umap_int32_erase:0.4340,umap_int32_mem:1414784,umap_uint64_find:0.2274,umap_uint64_insert:0.6556,umap_uint64_erase:0.5283,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:1.1014,kntrie_int32_insert:3.7591,kntrie_int32_erase:1.7799,kntrie_int32_mem:796264,kntrie_uint64_find:1.2035,kntrie_uint64_insert:4.0677,kntrie_uint64_erase:1.9336,kntrie_uint64_mem:796264,map_int32_find:6.3005,map_int32_insert:16.1211,map_int32_erase:9.8043,map_int32_mem:3152832,map_uint64_find:5.8786,map_uint64_insert:13.7976,map_uint64_erase:9.3545,map_uint64_mem:3152832,umap_int32_find:0.4916,umap_int32_insert:1.0988,umap_int32_erase:1.1874,umap_int32_mem:2114872,umap_uint64_find:0.4769,umap_uint64_insert:1.0360,umap_uint64_erase:1.0814,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.7751,kntrie_int32_insert:6.0849,kntrie_int32_erase:2.7568,kntrie_int32_mem:1192560,kntrie_uint64_find:1.8706,kntrie_uint64_insert:6.5306,kntrie_uint64_erase:2.9768,kntrie_uint64_mem:1192560,map_int32_find:10.8802,map_int32_insert:26.1289,map_int32_erase:17.0586,map_int32_mem:4729248,map_uint64_find:10.3809,map_uint64_insert:24.6889,map_uint64_erase:17.7137,map_uint64_mem:4729248,umap_int32_find:0.8968,umap_int32_insert:1.7394,umap_int32_erase:1.8784,umap_int32_mem:3162488,umap_uint64_find:0.8916,umap_uint64_insert:1.9245,umap_uint64_erase:1.9514,umap_uint64_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_int32_find:2.9212,kntrie_int32_insert:9.2140,kntrie_int32_erase:4.2369,kntrie_int32_mem:1789632,kntrie_uint64_find:3.4093,kntrie_uint64_insert:9.9234,kntrie_uint64_erase:4.6147,kntrie_uint64_mem:1789632,map_int32_find:19.9988,map_int32_insert:45.7828,map_int32_erase:30.1021,map_int32_mem:7093872,map_uint64_find:21.4879,map_uint64_insert:47.3288,map_uint64_erase:33.2042,map_uint64_mem:7093872,umap_int32_find:1.5157,umap_int32_insert:3.3473,umap_int32_erase:3.3417,umap_int32_mem:4729280,umap_uint64_find:1.5507,umap_uint64_insert:3.4063,umap_uint64_erase:3.2944,umap_uint64_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_int32_find:5.2363,kntrie_int32_insert:14.4510,kntrie_int32_erase:6.6273,kntrie_int32_mem:2683568,kntrie_uint64_find:6.4101,kntrie_uint64_insert:15.9429,kntrie_uint64_erase:7.3646,kntrie_uint64_mem:2683568,map_int32_find:36.3848,map_int32_insert:78.3585,map_int32_erase:55.9049,map_int32_mem:10640784,map_uint64_find:37.7418,map_uint64_insert:80.6526,map_uint64_erase:54.1244,map_uint64_mem:10640784,umap_int32_find:2.9531,umap_int32_insert:6.0974,umap_int32_erase:5.9637,umap_int32_mem:7215568,umap_uint64_find:2.5307,umap_uint64_insert:6.1038,umap_uint64_erase:5.4681,umap_uint64_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_int32_find:10.0207,kntrie_int32_insert:21.8076,kntrie_int32_erase:11.4409,kntrie_int32_mem:4026048,kntrie_uint64_find:11.1128,kntrie_uint64_insert:24.4417,kntrie_uint64_erase:12.4883,kntrie_uint64_mem:4026048,map_int32_find:71.0183,map_int32_insert:151.4992,map_int32_erase:99.3038,map_int32_mem:15961200,map_uint64_find:62.7018,map_uint64_insert:139.5040,map_uint64_erase:94.0021,map_uint64_mem:15961200,umap_int32_find:4.8557,umap_int32_insert:10.9864,umap_int32_erase:10.8828,umap_int32_mem:10789088,umap_uint64_find:4.1929,umap_uint64_insert:10.0025,umap_uint64_erase:9.6749,umap_uint64_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_int32_find:17.6154,kntrie_int32_insert:38.4507,kntrie_int32_erase:22.9502,kntrie_int32_mem:6039744,kntrie_uint64_find:19.2942,kntrie_uint64_insert:41.8314,kntrie_uint64_erase:24.1055,kntrie_uint64_mem:6039744,map_int32_find:120.2042,map_int32_insert:268.4843,map_int32_erase:168.5319,map_int32_mem:23941824,map_uint64_find:123.9777,map_uint64_insert:266.1530,map_uint64_erase:160.1768,map_uint64_mem:23941824,umap_int32_find:6.6253,umap_int32_insert:16.6167,umap_int32_erase:16.0970,umap_int32_mem:16132840,umap_uint64_find:6.6030,umap_uint64_insert:15.3764,umap_uint64_erase:14.7268,umap_uint64_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_int32_find:26.9283,kntrie_int32_insert:64.5794,kntrie_int32_erase:42.0646,kntrie_int32_mem:9059904,kntrie_uint64_find:30.6027,kntrie_uint64_insert:67.6231,kntrie_uint64_erase:43.1987,kntrie_uint64_mem:9059904,map_int32_find:188.7757,map_int32_insert:424.0244,map_int32_erase:268.1184,map_int32_mem:35912736,map_uint64_find:193.0489,map_uint64_insert:429.2133,map_uint64_erase:264.3477,map_uint64_mem:35912736,umap_int32_find:10.6615,umap_int32_insert:24.0060,umap_int32_erase:25.6730,umap_int32_mem:24124760,umap_uint64_find:10.6993,umap_uint64_insert:24.1820,umap_uint64_erase:24.2257,umap_uint64_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_int32_find:44.3236,kntrie_int32_insert:114.5704,kntrie_int32_erase:75.3296,kntrie_int32_mem:13589872,kntrie_uint64_find:51.1679,kntrie_uint64_insert:121.5244,kntrie_uint64_erase:77.3052,kntrie_uint64_mem:13589872,umap_int32_find:17.1732,umap_int32_insert:40.0257,umap_int32_erase:40.3915,umap_int32_mem:36077144,umap_uint64_find:18.7606,umap_uint64_insert:39.0279,umap_uint64_erase:40.0870,umap_uint64_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_int32_find:78.6501,kntrie_int32_insert:204.0238,kntrie_int32_erase:131.6483,kntrie_int32_mem:20384672,kntrie_uint64_find:88.1405,kntrie_uint64_insert:223.9068,kntrie_uint64_erase:135.8744,kntrie_uint64_mem:20384672,umap_int32_find:32.1917,umap_int32_insert:69.9495,umap_int32_erase:66.9232,umap_int32_mem:53952736,umap_uint64_find:30.1059,umap_uint64_insert:65.4844,umap_uint64_erase:61.8757,umap_uint64_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_int32_find:148.1323,kntrie_int32_insert:412.1527,kntrie_int32_erase:266.9211,kntrie_int32_mem:30577808,kntrie_uint64_find:156.8172,kntrie_uint64_insert:371.9084,kntrie_uint64_erase:235.0289,kntrie_uint64_mem:30577808,umap_int32_find:54.6250,umap_int32_insert:115.7263,umap_int32_erase:123.3140,umap_int32_mem:82332776,umap_uint64_find:49.9054,umap_uint64_insert:111.2657,umap_uint64_erase:101.3936,umap_uint64_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_int32_find:224.1483,kntrie_int32_insert:600.8584,kntrie_int32_erase:376.9801,kntrie_int32_mem:45867104,kntrie_uint64_find:276.2597,kntrie_uint64_insert:630.5660,kntrie_uint64_erase:394.8477,kntrie_uint64_mem:45867104,umap_int32_find:95.2841,umap_int32_insert:203.8388,umap_int32_erase:200.1514,umap_int32_mem:123112448,umap_uint64_find:90.8886,umap_uint64_insert:186.6738,umap_uint64_erase:178.0594,umap_uint64_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_int32_find:425.9522,kntrie_int32_insert:1083.6059,kntrie_int32_erase:660.5361,kntrie_int32_mem:68800928,kntrie_uint64_find:521.4396,kntrie_uint64_insert:1071.4114,kntrie_uint64_erase:655.1412,kntrie_uint64_mem:68800928,umap_int32_find:158.3938,umap_int32_insert:311.4176,umap_int32_erase:344.9736,umap_int32_mem:184095064,umap_uint64_find:156.6565,umap_uint64_insert:286.5981,umap_uint64_erase:331.1173,umap_uint64_mem:184095064},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
