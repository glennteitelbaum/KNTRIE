<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0007,kntrie_int32_insert:0.0053,kntrie_int32_erase:0.0023,kntrie_int32_mem:1544,kntrie_uint64_find:0.0007,kntrie_uint64_insert:0.0058,kntrie_uint64_erase:0.0036,kntrie_uint64_mem:2056,map_int32_find:0.0011,map_int32_insert:0.0074,map_int32_erase:0.0043,map_int32_mem:4800,map_uint64_find:0.0012,map_uint64_insert:0.0081,map_uint64_erase:0.0057,map_uint64_mem:4800,umap_int32_find:0.0010,umap_int32_insert:0.0019,umap_int32_erase:0.0013,umap_int32_mem:3224,umap_uint64_find:0.0011,umap_uint64_insert:0.0024,umap_uint64_erase:0.0022,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0011,kntrie_int32_insert:0.0080,kntrie_int32_erase:0.0030,kntrie_int32_mem:3080,kntrie_uint64_find:0.0011,kntrie_uint64_insert:0.0082,kntrie_uint64_erase:0.0044,kntrie_uint64_mem:4104,map_int32_find:0.0021,map_int32_insert:0.0109,map_int32_erase:0.0068,map_int32_mem:7200,map_uint64_find:0.0021,map_uint64_insert:0.0115,map_uint64_erase:0.0076,map_uint64_mem:7200,umap_int32_find:0.0017,umap_int32_insert:0.0048,umap_int32_erase:0.0021,umap_int32_mem:4856,umap_uint64_find:0.0015,umap_uint64_insert:0.0052,umap_uint64_erase:0.0028,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0117,kntrie_int32_erase:0.0044,kntrie_int32_mem:3080,kntrie_uint64_find:0.0016,kntrie_uint64_insert:0.0126,kntrie_uint64_erase:0.0044,kntrie_uint64_mem:4104,map_int32_find:0.0032,map_int32_insert:0.0161,map_int32_erase:0.0100,map_int32_mem:10800,map_uint64_find:0.0033,map_uint64_insert:0.0167,map_uint64_erase:0.0099,map_uint64_mem:10800,umap_int32_find:0.0030,umap_int32_insert:0.0083,umap_int32_erase:0.0035,umap_int32_mem:7216,umap_uint64_find:0.0026,umap_uint64_insert:0.0070,umap_uint64_erase:0.0030,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0028,kntrie_int32_insert:0.0176,kntrie_int32_erase:0.0066,kntrie_int32_mem:6152,kntrie_uint64_find:0.0027,kntrie_uint64_insert:0.0182,kntrie_uint64_erase:0.0074,kntrie_uint64_mem:8200,map_int32_find:0.0051,map_int32_insert:0.0253,map_int32_erase:0.0139,map_int32_mem:16176,map_uint64_find:0.0055,map_uint64_insert:0.0267,map_uint64_erase:0.0146,map_uint64_mem:16176,umap_int32_find:0.0037,umap_int32_insert:0.0100,umap_int32_erase:0.0038,umap_int32_mem:10784,umap_uint64_find:0.0036,umap_uint64_insert:0.0093,umap_uint64_erase:0.0040,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0042,kntrie_int32_insert:0.0289,kntrie_int32_erase:0.0083,kntrie_int32_mem:6152,kntrie_uint64_find:0.0040,kntrie_uint64_insert:0.0309,kntrie_uint64_erase:0.0093,kntrie_uint64_mem:8200,map_int32_find:0.0083,map_int32_insert:0.0387,map_int32_erase:0.0219,map_int32_mem:24288,map_uint64_find:0.0087,map_uint64_insert:0.0403,map_uint64_erase:0.0236,map_uint64_mem:24288,umap_int32_find:0.0050,umap_int32_insert:0.0132,umap_int32_erase:0.0055,umap_int32_mem:16472,umap_uint64_find:0.0051,umap_uint64_insert:0.0131,umap_uint64_erase:0.0063,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0070,kntrie_int32_insert:0.0408,kntrie_int32_erase:0.0156,kntrie_int32_mem:12296,kntrie_uint64_find:0.0068,kntrie_uint64_insert:0.0406,kntrie_uint64_erase:0.0170,kntrie_uint64_mem:16392,map_int32_find:0.0141,map_int32_insert:0.0604,map_int32_erase:0.0334,map_int32_mem:36432,map_uint64_find:0.0149,map_uint64_insert:0.0632,map_uint64_erase:0.0363,map_uint64_mem:36432,umap_int32_find:0.0081,umap_int32_insert:0.0202,umap_int32_erase:0.0092,umap_int32_mem:24304,umap_uint64_find:0.0082,umap_uint64_insert:0.0198,umap_uint64_erase:0.0100,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0116,kntrie_int32_insert:0.0690,kntrie_int32_erase:0.0174,kntrie_int32_mem:24584,kntrie_uint64_find:0.0122,kntrie_uint64_insert:0.0699,kntrie_uint64_erase:0.0180,kntrie_uint64_mem:32776,map_int32_find:0.0242,map_int32_insert:0.0913,map_int32_erase:0.0525,map_int32_mem:54672,map_uint64_find:0.0248,map_uint64_insert:0.0973,map_uint64_erase:0.0557,map_uint64_mem:54672,umap_int32_find:0.0117,umap_int32_insert:0.0273,umap_int32_erase:0.0131,umap_int32_mem:36880,umap_uint64_find:0.0121,umap_uint64_insert:0.0275,umap_uint64_erase:0.0130,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0177,kntrie_int32_insert:0.0988,kntrie_int32_erase:0.0310,kntrie_int32_mem:24584,kntrie_uint64_find:0.0176,kntrie_uint64_insert:0.1041,kntrie_uint64_erase:0.0306,kntrie_uint64_mem:32776,map_int32_find:0.0386,map_int32_insert:0.1444,map_int32_erase:0.0829,map_int32_mem:81984,map_uint64_find:0.0413,map_uint64_insert:0.1538,map_uint64_erase:0.0886,map_uint64_mem:81984,umap_int32_find:0.0202,umap_int32_insert:0.0426,umap_int32_erase:0.0199,umap_int32_mem:54920,umap_uint64_find:0.0205,umap_uint64_insert:0.0396,umap_uint64_erase:0.0215,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0297,kntrie_int32_insert:0.1561,kntrie_int32_erase:0.0456,kntrie_int32_mem:49160,kntrie_uint64_find:0.0314,kntrie_uint64_insert:0.1578,kntrie_uint64_erase:0.0473,kntrie_uint64_mem:65544,map_int32_find:0.0629,map_int32_insert:0.2394,map_int32_erase:0.1300,map_int32_mem:122976,map_uint64_find:0.0651,map_uint64_insert:0.2602,map_uint64_erase:0.1388,map_uint64_mem:122976,umap_int32_find:0.0295,umap_int32_insert:0.0604,umap_int32_erase:0.0314,umap_int32_mem:83512,umap_uint64_find:0.0303,umap_uint64_insert:0.0602,umap_uint64_erase:0.0318,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0445,kntrie_int32_insert:0.2497,kntrie_int32_erase:0.0732,kntrie_int32_mem:49160,kntrie_uint64_find:0.0472,kntrie_uint64_insert:0.2381,kntrie_uint64_erase:0.0726,kntrie_uint64_mem:65544,map_int32_find:0.1073,map_int32_insert:0.3890,map_int32_erase:0.2089,map_int32_mem:184512,map_uint64_find:0.1084,map_uint64_insert:0.4140,map_uint64_erase:0.2260,map_uint64_mem:184512,umap_int32_find:0.0472,umap_int32_insert:0.0925,umap_int32_erase:0.0480,umap_int32_mem:124472,umap_uint64_find:0.0486,umap_uint64_insert:0.0919,umap_uint64_erase:0.0496,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0733,kntrie_int32_insert:0.4400,kntrie_int32_erase:0.1372,kntrie_int32_mem:100560,kntrie_uint64_find:0.1004,kntrie_uint64_insert:0.4522,kntrie_uint64_erase:0.1381,kntrie_uint64_mem:131600,map_int32_find:0.1781,map_int32_insert:0.6119,map_int32_erase:0.3407,map_int32_mem:276768,map_uint64_find:0.1849,map_uint64_insert:0.6422,map_uint64_erase:0.3609,map_uint64_mem:276768,umap_int32_find:0.0745,umap_int32_insert:0.1429,umap_int32_erase:0.0764,umap_int32_mem:186008,umap_uint64_find:0.0765,umap_uint64_insert:0.1489,umap_uint64_erase:0.0755,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1480,kntrie_int32_insert:0.6305,kntrie_int32_erase:0.1862,kntrie_int32_mem:157968,kntrie_uint64_find:0.1763,kntrie_uint64_insert:0.6142,kntrie_uint64_erase:0.1941,kntrie_uint64_mem:214544,map_int32_find:0.3035,map_int32_insert:1.0143,map_int32_erase:0.5665,map_int32_mem:415152,map_uint64_find:0.3129,map_uint64_insert:1.1526,map_uint64_erase:0.5987,map_uint64_mem:415152,umap_int32_find:0.1167,umap_int32_insert:0.2210,umap_int32_erase:0.1202,umap_int32_mem:277840,umap_uint64_find:0.1164,umap_uint64_insert:0.2208,umap_uint64_erase:0.1220,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.1845,kntrie_int32_insert:0.8693,kntrie_int32_erase:0.2852,kntrie_int32_mem:207888,kntrie_uint64_find:0.2394,kntrie_uint64_insert:0.9320,kntrie_uint64_erase:0.3139,kntrie_uint64_mem:274960,map_int32_find:0.5011,map_int32_insert:1.6329,map_int32_erase:0.9131,map_int32_mem:622752,map_uint64_find:0.5191,map_uint64_insert:1.7045,map_uint64_erase:0.9856,map_uint64_mem:622752,umap_int32_find:0.1862,umap_int32_insert:0.3316,umap_int32_erase:0.1829,umap_int32_mem:415240,umap_uint64_find:0.1788,umap_uint64_insert:0.3238,umap_uint64_erase:0.1815,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.3209,kntrie_int32_insert:1.2488,kntrie_int32_erase:0.4132,kntrie_int32_mem:380688,kntrie_uint64_find:0.3893,kntrie_uint64_insert:1.2648,kntrie_uint64_erase:0.4496,kntrie_uint64_mem:503824,map_int32_find:0.8026,map_int32_insert:2.6142,map_int32_erase:1.4684,map_int32_mem:934128,map_uint64_find:0.8975,map_uint64_insert:2.7388,map_uint64_erase:1.6187,map_uint64_mem:934128,umap_int32_find:0.2712,umap_int32_insert:0.4880,umap_int32_erase:0.2690,umap_int32_mem:633088,umap_uint64_find:0.2705,umap_uint64_insert:0.4835,umap_uint64_erase:0.2834,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.5054,kntrie_int32_insert:1.8666,kntrie_int32_erase:0.6369,kntrie_int32_mem:444432,kntrie_uint64_find:0.6019,kntrie_uint64_insert:1.9541,kntrie_uint64_erase:0.6752,kntrie_uint64_mem:568336,map_int32_find:1.5127,map_int32_insert:4.4848,map_int32_erase:2.5823,map_int32_mem:1401216,map_uint64_find:1.6425,map_uint64_insert:5.1368,map_uint64_erase:2.9602,map_uint64_mem:1401216,umap_int32_find:0.4155,umap_int32_insert:0.7333,umap_int32_erase:0.4190,umap_int32_mem:946424,umap_uint64_find:0.4298,umap_uint64_insert:0.7684,umap_uint64_erase:0.4667,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:0.8586,kntrie_int32_insert:2.8622,kntrie_int32_erase:1.0453,kntrie_int32_mem:791568,kntrie_uint64_find:1.0095,kntrie_uint64_insert:2.9287,kntrie_uint64_erase:1.1088,kntrie_uint64_mem:1053712,map_int32_find:2.7995,map_int32_insert:7.1218,map_int32_erase:4.6892,map_int32_mem:2101872,map_uint64_find:3.0018,map_uint64_insert:9.6256,map_uint64_erase:5.2976,map_uint64_mem:2101872,umap_int32_find:0.7124,umap_int32_insert:1.2388,umap_int32_erase:0.7743,umap_int32_mem:1414784,umap_uint64_find:0.7127,umap_uint64_insert:1.1688,umap_uint64_erase:0.7692,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.5871,kntrie_int32_insert:4.7354,kntrie_int32_erase:1.4089,kntrie_int32_mem:1163280,kntrie_uint64_find:2.1676,kntrie_uint64_insert:4.9918,kntrie_uint64_erase:1.7393,kntrie_uint64_mem:1573904,map_int32_find:5.2803,map_int32_insert:12.6571,map_int32_erase:8.5666,map_int32_mem:3152832,map_uint64_find:5.3275,map_uint64_insert:17.3863,map_uint64_erase:9.6219,map_uint64_mem:3152832,umap_int32_find:1.2403,umap_int32_insert:2.1071,umap_int32_erase:1.4832,umap_int32_mem:2114872,umap_uint64_find:1.2747,umap_uint64_insert:2.2455,umap_uint64_erase:1.5661,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.4900,kntrie_int32_insert:6.7935,kntrie_int32_erase:2.5693,kntrie_int32_mem:1578000,map_int32_find:10.2830,map_int32_insert:23.7048,map_int32_erase:15.7128,map_int32_mem:4729104,umap_int32_find:2.1277,umap_int32_insert:3.9977,umap_int32_erase:2.8367,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:3.7189,kntrie_uint64_insert:7.2632,kntrie_uint64_erase:3.3328,kntrie_uint64_mem:2102288,map_uint64_find:10.7199,map_uint64_insert:29.6461,map_uint64_erase:18.7669,map_uint64_mem:4729248,umap_uint64_find:2.3095,umap_uint64_insert:4.7991,umap_uint64_erase:3.2462,umap_uint64_mem:3162488},
  {pattern:"random",N:147785,kntrie_int32_find:5.8173,kntrie_int32_insert:11.9335,kntrie_int32_erase:3.9290,kntrie_int32_mem:3150864,map_int32_find:19.8886,map_int32_insert:42.6329,map_int32_erase:30.0928,map_int32_mem:7093680,umap_int32_find:3.5292,umap_int32_insert:7.7522,umap_int32_erase:4.8944,umap_int32_mem:4729184},
  {pattern:"random",N:147789,kntrie_uint64_find:10.7839,kntrie_uint64_insert:14.2295,kntrie_uint64_erase:7.0627,kntrie_uint64_mem:4183056,map_uint64_find:21.4505,map_uint64_insert:61.4940,map_uint64_erase:34.3680,map_uint64_mem:7093872,umap_uint64_find:3.6340,umap_uint64_insert:7.6381,umap_uint64_erase:5.0100,umap_uint64_mem:4729280},
  {pattern:"random",N:221675,kntrie_int32_find:8.6830,kntrie_int32_insert:18.0698,kntrie_int32_erase:7.0548,kntrie_int32_mem:3150864,map_int32_find:39.0319,map_int32_insert:79.7677,map_int32_erase:57.5903,map_int32_mem:10640400,umap_int32_find:5.7572,umap_int32_insert:13.8393,umap_int32_erase:8.6430,umap_int32_mem:7215376},
  {pattern:"random",N:221683,kntrie_uint64_find:13.9660,kntrie_uint64_insert:22.0169,kntrie_uint64_erase:11.0009,kntrie_uint64_mem:4199440,map_uint64_find:37.8572,map_uint64_insert:87.1545,map_uint64_erase:55.1264,map_uint64_mem:10640784,umap_uint64_find:5.7882,umap_uint64_insert:13.3968,umap_uint64_erase:8.6611,umap_uint64_mem:7215568},
  {pattern:"random",N:332509,kntrie_int32_find:22.5353,kntrie_int32_insert:33.2388,kntrie_int32_erase:14.6315,kntrie_int32_mem:6296592,map_int32_find:70.7757,map_int32_insert:143.6413,map_int32_erase:94.1537,map_int32_mem:15960432,umap_int32_find:8.9590,umap_int32_insert:21.1236,umap_int32_erase:13.1711,umap_int32_mem:10788704},
  {pattern:"random",N:332525,kntrie_uint64_find:30.4420,kntrie_uint64_insert:40.3587,kntrie_uint64_erase:20.8782,kntrie_uint64_mem:8393744,map_uint64_find:63.5557,map_uint64_insert:153.0387,map_uint64_erase:95.0198,map_uint64_mem:15961200,umap_uint64_find:9.3645,umap_uint64_insert:21.4755,umap_uint64_erase:13.6668,umap_uint64_mem:10789088},
  {pattern:"random",N:498753,kntrie_int32_find:33.2374,kntrie_int32_insert:60.0132,kntrie_int32_erase:23.7274,kntrie_int32_mem:6444048,map_int32_find:115.9187,map_int32_insert:250.9995,map_int32_erase:170.6931,map_int32_mem:23940144,umap_int32_find:14.4157,umap_int32_insert:34.9338,umap_int32_erase:21.5691,umap_int32_mem:16132000},
  {pattern:"random",N:498788,kntrie_uint64_find:50.1868,kntrie_uint64_insert:86.1524,kntrie_uint64_erase:36.3771,kntrie_uint64_mem:8524816,map_uint64_find:114.0619,map_uint64_insert:274.1355,map_uint64_erase:159.3557,map_uint64_mem:23941824,umap_uint64_find:15.5629,umap_uint64_insert:36.5846,umap_uint64_erase:23.3964,umap_uint64_mem:16132840},
  {pattern:"random",N:748117,kntrie_int32_find:74.6719,kntrie_int32_insert:106.9133,kntrie_int32_erase:49.9224,kntrie_int32_mem:12588048,map_int32_find:185.5107,map_int32_insert:411.0629,map_int32_erase:264.7743,map_int32_mem:35909616,umap_int32_find:23.0348,umap_int32_insert:56.5361,umap_int32_erase:35.6699,umap_int32_mem:24123200},
  {pattern:"random",N:748182,kntrie_uint64_find:101.1952,kntrie_uint64_insert:151.5673,kntrie_uint64_erase:71.9837,kntrie_uint64_mem:16782352,map_uint64_find:214.6193,map_uint64_insert:437.6280,map_uint64_erase:298.4678,map_uint64_mem:35912736,umap_uint64_find:23.7737,umap_uint64_insert:59.9729,umap_uint64_erase:35.5171,umap_uint64_mem:24124760},
  {pattern:"random",N:1122145,kntrie_int32_find:103.5528,kntrie_int32_insert:270.9022,kntrie_int32_erase:74.7127,kntrie_int32_mem:17446224,umap_int32_find:38.2060,umap_int32_insert:98.5627,umap_int32_erase:60.7348,umap_int32_mem:36074048},
  {pattern:"random",N:1122274,kntrie_uint64_find:158.6738,kntrie_uint64_insert:303.6079,kntrie_uint64_erase:82.3072,kntrie_uint64_mem:27146000,umap_uint64_find:37.5072,umap_uint64_insert:91.3975,umap_uint64_erase:58.5215,umap_uint64_mem:36077144},
  {pattern:"random",N:1683111,kntrie_int32_find:141.6437,kntrie_int32_insert:331.4182,kntrie_int32_erase:107.2854,kntrie_int32_mem:23942784,umap_int32_find:64.1762,umap_int32_insert:172.2923,umap_int32_erase:104.3308,umap_int32_mem:53945536},
  {pattern:"random",N:1683411,kntrie_uint64_find:254.0329,kntrie_uint64_insert:417.5168,kntrie_uint64_erase:129.5752,kntrie_uint64_mem:37514256,umap_uint64_find:59.9550,umap_uint64_insert:147.5546,umap_uint64_erase:91.1438,umap_uint64_mem:53952736},
  {pattern:"random",N:2524384,kntrie_int32_find:244.1218,kntrie_int32_insert:463.3634,kntrie_int32_erase:178.3663,kntrie_int32_mem:39793104,umap_int32_find:90.3034,umap_int32_insert:223.7420,umap_int32_erase:138.1912,umap_int32_mem:82315208},
  {pattern:"random",N:2525116,kntrie_uint64_find:447.6470,kntrie_uint64_insert:610.6014,kntrie_uint64_erase:249.6367,kntrie_uint64_mem:62881040,umap_uint64_find:97.8507,umap_uint64_insert:260.3946,umap_uint64_erase:156.3170,umap_uint64_mem:82332776},
  {pattern:"random",N:3786033,kntrie_int32_find:393.6043,kntrie_int32_insert:693.2111,kntrie_int32_erase:269.6115,kntrie_int32_mem:51091984,umap_int32_find:154.1667,umap_int32_insert:368.0380,umap_int32_erase:235.4043,umap_int32_mem:123073040},
  {pattern:"random",N:3787675,kntrie_uint64_find:696.6974,kntrie_uint64_insert:923.8147,kntrie_uint64_erase:361.0553,kntrie_uint64_mem:81038352,umap_uint64_find:187.1678,umap_uint64_insert:485.1392,umap_uint64_erase:303.5921,umap_uint64_mem:123112448},
  {pattern:"random",N:5677748,kntrie_int32_find:738.6499,kntrie_int32_insert:1146.3486,kntrie_int32_erase:465.9110,kntrie_int32_mem:84892944,umap_int32_find:281.6853,umap_int32_insert:706.1544,umap_int32_erase:434.9043,umap_int32_mem:184004728},
  {pattern:"random",N:5681512,kntrie_uint64_find:1392.5120,kntrie_uint64_insert:1697.4096,kntrie_uint64_erase:804.5136,kntrie_uint64_mem:135109648,umap_uint64_find:295.4906,umap_uint64_insert:795.0154,umap_uint64_erase:440.5961,umap_uint64_mem:184095064},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0007,kntrie_int32_insert:0.0054,kntrie_int32_erase:0.0023,kntrie_int32_mem:1544,kntrie_uint64_find:0.0006,kntrie_uint64_insert:0.0055,kntrie_uint64_erase:0.0028,kntrie_uint64_mem:2056,map_int32_find:0.0011,map_int32_insert:0.0073,map_int32_erase:0.0042,map_int32_mem:4800,map_uint64_find:0.0011,map_uint64_insert:0.0077,map_uint64_erase:0.0051,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0010,umap_int32_erase:0.0006,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0011,umap_uint64_erase:0.0011,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0011,kntrie_int32_insert:0.0081,kntrie_int32_erase:0.0032,kntrie_int32_mem:3080,kntrie_uint64_find:0.0011,kntrie_uint64_insert:0.0083,kntrie_uint64_erase:0.0042,kntrie_uint64_mem:4104,map_int32_find:0.0021,map_int32_insert:0.0113,map_int32_erase:0.0066,map_int32_mem:7200,map_uint64_find:0.0021,map_uint64_insert:0.0115,map_uint64_erase:0.0072,map_uint64_mem:7200,umap_int32_find:0.0004,umap_int32_insert:0.0033,umap_int32_erase:0.0011,umap_int32_mem:4856,umap_uint64_find:0.0004,umap_uint64_insert:0.0038,umap_uint64_erase:0.0022,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0016,kntrie_int32_insert:0.0122,kntrie_int32_erase:0.0041,kntrie_int32_mem:3080,kntrie_uint64_find:0.0016,kntrie_uint64_insert:0.0123,kntrie_uint64_erase:0.0040,kntrie_uint64_mem:4104,map_int32_find:0.0032,map_int32_insert:0.0163,map_int32_erase:0.0095,map_int32_mem:10800,map_uint64_find:0.0032,map_uint64_insert:0.0172,map_uint64_erase:0.0097,map_uint64_mem:10800,umap_int32_find:0.0006,umap_int32_insert:0.0046,umap_int32_erase:0.0011,umap_int32_mem:7216,umap_uint64_find:0.0006,umap_uint64_insert:0.0047,umap_uint64_erase:0.0012,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0028,kntrie_int32_insert:0.0174,kntrie_int32_erase:0.0068,kntrie_int32_mem:6152,kntrie_uint64_find:0.0027,kntrie_uint64_insert:0.0180,kntrie_uint64_erase:0.0071,kntrie_uint64_mem:8200,map_int32_find:0.0054,map_int32_insert:0.0252,map_int32_erase:0.0144,map_int32_mem:16176,map_uint64_find:0.0056,map_uint64_insert:0.0261,map_uint64_erase:0.0148,map_uint64_mem:16176,umap_int32_find:0.0009,umap_int32_insert:0.0067,umap_int32_erase:0.0018,umap_int32_mem:10784,umap_uint64_find:0.0009,umap_uint64_insert:0.0063,umap_uint64_erase:0.0018,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0042,kntrie_int32_insert:0.0301,kntrie_int32_erase:0.0089,kntrie_int32_mem:6152,kntrie_uint64_find:0.0040,kntrie_uint64_insert:0.0300,kntrie_uint64_erase:0.0097,kntrie_uint64_mem:8200,map_int32_find:0.0089,map_int32_insert:0.0383,map_int32_erase:0.0219,map_int32_mem:24288,map_uint64_find:0.0089,map_uint64_insert:0.0404,map_uint64_erase:0.0236,map_uint64_mem:24288,umap_int32_find:0.0014,umap_int32_insert:0.0088,umap_int32_erase:0.0027,umap_int32_mem:16472,umap_uint64_find:0.0015,umap_uint64_insert:0.0099,umap_uint64_erase:0.0036,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0070,kntrie_int32_insert:0.0396,kntrie_int32_erase:0.0157,kntrie_int32_mem:12296,kntrie_uint64_find:0.0069,kntrie_uint64_insert:0.0404,kntrie_uint64_erase:0.0161,kntrie_uint64_mem:16392,map_int32_find:0.0141,map_int32_insert:0.0586,map_int32_erase:0.0331,map_int32_mem:36432,map_uint64_find:0.0152,map_uint64_insert:0.0671,map_uint64_erase:0.0369,map_uint64_mem:36432,umap_int32_find:0.0021,umap_int32_insert:0.0134,umap_int32_erase:0.0040,umap_int32_mem:24304,umap_uint64_find:0.0022,umap_uint64_insert:0.0138,umap_uint64_erase:0.0048,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0116,kntrie_int32_insert:0.0744,kntrie_int32_erase:0.0175,kntrie_int32_mem:24584,kntrie_uint64_find:0.0115,kntrie_uint64_insert:0.0760,kntrie_uint64_erase:0.0178,kntrie_uint64_mem:32776,map_int32_find:0.0247,map_int32_insert:0.0925,map_int32_erase:0.0517,map_int32_mem:54672,map_uint64_find:0.0253,map_uint64_insert:0.0976,map_uint64_erase:0.0567,map_uint64_mem:54672,umap_int32_find:0.0032,umap_int32_insert:0.0187,umap_int32_erase:0.0063,umap_int32_mem:36880,umap_uint64_find:0.0032,umap_uint64_insert:0.0202,umap_uint64_erase:0.0057,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0177,kntrie_int32_insert:0.0968,kntrie_int32_erase:0.0317,kntrie_int32_mem:24584,kntrie_uint64_find:0.0178,kntrie_uint64_insert:0.0938,kntrie_uint64_erase:0.0320,kntrie_uint64_mem:32776,map_int32_find:0.0405,map_int32_insert:0.1467,map_int32_erase:0.0816,map_int32_mem:81984,map_uint64_find:0.0417,map_uint64_insert:0.1629,map_uint64_erase:0.0880,map_uint64_mem:81984,umap_int32_find:0.0047,umap_int32_insert:0.0271,umap_int32_erase:0.0091,umap_int32_mem:54920,umap_uint64_find:0.0048,umap_uint64_insert:0.0289,umap_uint64_erase:0.0092,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0297,kntrie_int32_insert:0.1571,kntrie_int32_erase:0.0448,kntrie_int32_mem:49160,kntrie_uint64_find:0.0301,kntrie_uint64_insert:0.1566,kntrie_uint64_erase:0.0461,kntrie_uint64_mem:65544,map_int32_find:0.0656,map_int32_insert:0.2316,map_int32_erase:0.1359,map_int32_mem:122976,map_uint64_find:0.0670,map_uint64_insert:0.2493,map_uint64_erase:0.1389,map_uint64_mem:122976,umap_int32_find:0.0071,umap_int32_insert:0.0386,umap_int32_erase:0.0145,umap_int32_mem:83512,umap_uint64_find:0.0071,umap_uint64_insert:0.0415,umap_uint64_erase:0.0153,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0446,kntrie_int32_insert:0.2490,kntrie_int32_erase:0.0694,kntrie_int32_mem:49160,kntrie_uint64_find:0.0453,kntrie_uint64_insert:0.2453,kntrie_uint64_erase:0.0724,kntrie_uint64_mem:65544,map_int32_find:0.1170,map_int32_insert:0.3790,map_int32_erase:0.2179,map_int32_mem:184512,map_uint64_find:0.1163,map_uint64_insert:0.4050,map_uint64_erase:0.2290,map_uint64_mem:184512,umap_int32_find:0.0107,umap_int32_insert:0.0555,umap_int32_erase:0.0227,umap_int32_mem:124472,umap_uint64_find:0.0110,umap_uint64_insert:0.0603,umap_uint64_erase:0.0229,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0459,kntrie_int32_insert:0.3988,kntrie_int32_erase:0.0888,kntrie_int32_mem:69752,kntrie_uint64_find:0.0555,kntrie_uint64_insert:0.4066,kntrie_uint64_erase:0.0989,kntrie_uint64_mem:69752,map_int32_find:0.1882,map_int32_insert:0.6343,map_int32_erase:0.3425,map_int32_mem:276768,map_uint64_find:0.1953,map_uint64_insert:0.6687,map_uint64_erase:0.3732,map_uint64_mem:276768,umap_int32_find:0.0163,umap_int32_insert:0.0824,umap_int32_erase:0.0355,umap_int32_mem:186008,umap_uint64_find:0.0165,umap_uint64_insert:0.0867,umap_uint64_erase:0.0359,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.0713,kntrie_int32_insert:0.5195,kntrie_int32_erase:0.1404,kntrie_int32_mem:104360,kntrie_uint64_find:0.0869,kntrie_uint64_insert:0.5303,kntrie_uint64_erase:0.1544,kntrie_uint64_mem:104360,map_int32_find:0.3167,map_int32_insert:1.0320,map_int32_erase:0.5657,map_int32_mem:415152,map_uint64_find:0.3129,map_uint64_insert:1.0721,map_uint64_erase:0.5999,map_uint64_mem:415152,umap_int32_find:0.0245,umap_int32_insert:0.1222,umap_int32_erase:0.0541,umap_int32_mem:277840,umap_uint64_find:0.0247,umap_uint64_insert:0.1279,umap_uint64_erase:0.0557,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.1079,kntrie_int32_insert:0.6878,kntrie_int32_erase:0.2153,kntrie_int32_mem:156472,kntrie_uint64_find:0.1286,kntrie_uint64_insert:0.6901,kntrie_uint64_erase:0.2361,kntrie_uint64_mem:156472,map_int32_find:0.5151,map_int32_insert:1.6663,map_int32_erase:0.9343,map_int32_mem:622752,map_uint64_find:0.5155,map_uint64_insert:1.7020,map_uint64_erase:0.9657,map_uint64_mem:622752,umap_int32_find:0.0360,umap_int32_insert:0.1773,umap_int32_erase:0.0814,umap_int32_mem:415240,umap_uint64_find:0.0365,umap_uint64_insert:0.1863,umap_uint64_erase:0.0831,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.1655,kntrie_int32_insert:0.9516,kntrie_int32_erase:0.3365,kntrie_int32_mem:235576,kntrie_uint64_find:0.1998,kntrie_uint64_insert:0.9831,kntrie_uint64_erase:0.3676,kntrie_uint64_mem:235576,map_int32_find:0.8457,map_int32_insert:2.6758,map_int32_erase:1.5053,map_int32_mem:934128,map_uint64_find:0.8745,map_uint64_insert:2.7650,map_uint64_erase:1.5308,map_uint64_mem:934128,umap_int32_find:0.0542,umap_int32_insert:0.2647,umap_int32_erase:0.1264,umap_int32_mem:633088,umap_uint64_find:0.0725,umap_uint64_insert:0.3048,umap_uint64_erase:0.2048,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.2548,kntrie_int32_insert:1.3247,kntrie_int32_erase:0.5234,kntrie_int32_mem:353176,kntrie_uint64_find:0.3132,kntrie_uint64_insert:1.4232,kntrie_uint64_erase:0.5836,kntrie_uint64_mem:353176,map_int32_find:1.6763,map_int32_insert:4.4570,map_int32_erase:2.7143,map_int32_mem:1401216,map_uint64_find:1.6368,map_uint64_insert:4.5954,map_uint64_erase:2.9940,map_uint64_mem:1401216,umap_int32_find:0.1019,umap_int32_insert:0.3983,umap_int32_erase:0.2182,umap_int32_mem:946424,umap_uint64_find:0.1432,umap_uint64_insert:0.4244,umap_uint64_erase:0.3146,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.4069,kntrie_int32_insert:1.9344,kntrie_int32_erase:0.8358,kntrie_int32_mem:529816,kntrie_uint64_find:0.4997,kntrie_uint64_insert:2.0622,kntrie_uint64_erase:0.9221,kntrie_uint64_mem:529816,map_int32_find:2.9200,map_int32_insert:7.7779,map_int32_erase:4.7833,map_int32_mem:2101872,map_uint64_find:2.8658,map_uint64_insert:7.4557,map_uint64_erase:5.1066,map_uint64_mem:2101872,umap_int32_find:0.1976,umap_int32_insert:0.6079,umap_int32_erase:0.4060,umap_int32_mem:1414784,umap_uint64_find:0.2188,umap_uint64_insert:0.6314,umap_uint64_erase:0.5113,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:1.0080,kntrie_int32_insert:3.2280,kntrie_int32_erase:1.4954,kntrie_int32_mem:796256,kntrie_uint64_find:1.1110,kntrie_uint64_insert:3.4630,kntrie_uint64_erase:1.6427,kntrie_uint64_mem:796256,map_int32_find:5.4048,map_int32_insert:13.4149,map_int32_erase:8.7366,map_int32_mem:3152832,map_uint64_find:5.7021,map_uint64_insert:13.6563,map_uint64_erase:9.4440,map_uint64_mem:3152832,umap_int32_find:0.4379,umap_int32_insert:0.9363,umap_int32_erase:0.9637,umap_int32_mem:2114872,umap_uint64_find:0.4814,umap_uint64_insert:1.0174,umap_uint64_erase:1.1158,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.5647,kntrie_int32_insert:5.1696,kntrie_int32_erase:2.3099,kntrie_int32_mem:1192552,kntrie_uint64_find:1.7808,kntrie_uint64_insert:5.5420,kntrie_uint64_erase:2.5029,kntrie_uint64_mem:1192552,map_int32_find:9.7950,map_int32_insert:23.6626,map_int32_erase:16.9541,map_int32_mem:4729248,map_uint64_find:10.3380,map_uint64_insert:26.0075,map_uint64_erase:16.8042,map_uint64_mem:4729248,umap_int32_find:0.8701,umap_int32_insert:1.5784,umap_int32_erase:1.8192,umap_int32_mem:3162488,umap_uint64_find:0.8447,umap_uint64_insert:1.6578,umap_uint64_erase:1.8694,umap_uint64_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_int32_find:2.5386,kntrie_int32_insert:7.9475,kntrie_int32_erase:3.5441,kntrie_int32_mem:1789624,kntrie_uint64_find:2.8915,kntrie_uint64_insert:8.2437,kntrie_uint64_erase:3.8871,kntrie_uint64_mem:1789624,map_int32_find:20.4001,map_int32_insert:43.8469,map_int32_erase:30.9362,map_int32_mem:7093872,map_uint64_find:20.2264,map_uint64_insert:46.9486,map_uint64_erase:29.8283,map_uint64_mem:7093872,umap_int32_find:1.4473,umap_int32_insert:3.0932,umap_int32_erase:3.1119,umap_int32_mem:4729280,umap_uint64_find:1.4442,umap_uint64_insert:3.2051,umap_uint64_erase:3.3380,umap_uint64_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_int32_find:4.8882,kntrie_int32_insert:12.3600,kntrie_int32_erase:5.6698,kntrie_int32_mem:2683560,kntrie_uint64_find:6.0426,kntrie_uint64_insert:13.3398,kntrie_uint64_erase:6.1957,kntrie_uint64_mem:2683560,map_int32_find:39.6587,map_int32_insert:77.9514,map_int32_erase:59.3789,map_int32_mem:10640784,map_uint64_find:38.9800,map_uint64_insert:91.1265,map_uint64_erase:57.6020,map_uint64_mem:10640784,umap_int32_find:2.4759,umap_int32_insert:5.6943,umap_int32_erase:5.0295,umap_int32_mem:7215568,umap_uint64_find:2.5287,umap_uint64_insert:5.6811,umap_uint64_erase:5.2757,umap_uint64_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_int32_find:9.2921,kntrie_int32_insert:19.9781,kntrie_int32_erase:10.1334,kntrie_int32_mem:4026040,kntrie_uint64_find:10.6583,kntrie_uint64_insert:22.9275,kntrie_uint64_erase:11.0213,kntrie_uint64_mem:4026040,map_int32_find:65.0816,map_int32_insert:146.4740,map_int32_erase:93.4268,map_int32_mem:15961200,map_uint64_find:62.6888,map_uint64_insert:140.2567,map_uint64_erase:91.9292,map_uint64_mem:15961200,umap_int32_find:4.0122,umap_int32_insert:9.4961,umap_int32_erase:9.2754,umap_int32_mem:10789088,umap_uint64_find:4.4041,umap_uint64_insert:9.7850,umap_uint64_erase:10.0980,umap_uint64_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_int32_find:17.5990,kntrie_int32_insert:37.4499,kntrie_int32_erase:20.9321,kntrie_int32_mem:6039736,kntrie_uint64_find:18.0366,kntrie_uint64_insert:35.3082,kntrie_uint64_erase:20.9443,kntrie_uint64_mem:6039736,map_int32_find:128.6761,map_int32_insert:275.6364,map_int32_erase:175.7152,map_int32_mem:23941824,map_uint64_find:112.3657,map_uint64_insert:252.8786,map_uint64_erase:158.9917,map_uint64_mem:23941824,umap_int32_find:7.9554,umap_int32_insert:18.5554,umap_int32_erase:18.1084,umap_int32_mem:16132840,umap_uint64_find:7.3095,umap_uint64_insert:15.1673,umap_uint64_erase:16.2912,umap_uint64_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_int32_find:29.1807,kntrie_int32_insert:64.5687,kntrie_int32_erase:44.0173,kntrie_int32_mem:9059896,kntrie_uint64_find:29.5157,kntrie_uint64_insert:62.0919,kntrie_uint64_erase:39.4360,kntrie_uint64_mem:9059896,map_int32_find:205.4025,map_int32_insert:490.2726,map_int32_erase:300.0119,map_int32_mem:35912736,map_uint64_find:192.6874,map_uint64_insert:432.4615,map_uint64_erase:280.8103,map_uint64_mem:35912736,umap_int32_find:10.8994,umap_int32_insert:24.2464,umap_int32_erase:27.2160,umap_int32_mem:24124760,umap_uint64_find:11.9209,umap_uint64_insert:23.2495,umap_uint64_erase:26.2483,umap_uint64_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_int32_find:48.6531,kntrie_int32_insert:116.5309,kntrie_int32_erase:82.8716,kntrie_int32_mem:13589864,kntrie_uint64_find:50.9378,kntrie_uint64_insert:111.0395,kntrie_uint64_erase:74.1381,kntrie_uint64_mem:13589864,umap_int32_find:20.0080,umap_int32_insert:45.8538,umap_int32_erase:45.4021,umap_int32_mem:36077144,umap_uint64_find:19.1107,umap_uint64_insert:39.0785,umap_uint64_erase:40.8963,umap_uint64_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_int32_find:81.8164,kntrie_int32_insert:213.6912,kntrie_int32_erase:149.0595,kntrie_int32_mem:20384664,kntrie_uint64_find:84.9673,kntrie_uint64_insert:194.0897,kntrie_uint64_erase:128.7263,kntrie_uint64_mem:20384664,umap_int32_find:33.5639,umap_int32_insert:72.5086,umap_int32_erase:71.7320,umap_int32_mem:53952736,umap_uint64_find:36.4055,umap_uint64_insert:73.3589,umap_uint64_erase:75.0447,umap_uint64_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_int32_find:162.2493,kntrie_int32_insert:393.4491,kntrie_int32_erase:255.6808,kntrie_int32_mem:30577800,kntrie_uint64_find:203.3630,kntrie_uint64_insert:407.1493,kntrie_uint64_erase:257.2902,kntrie_uint64_mem:30577800,umap_int32_find:53.4519,umap_int32_insert:116.6523,umap_int32_erase:115.8678,umap_int32_mem:82332776,umap_uint64_find:63.1996,umap_uint64_insert:114.1027,umap_uint64_erase:120.6403,umap_uint64_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_int32_find:274.9300,kntrie_int32_insert:648.9735,kntrie_int32_erase:423.1394,kntrie_int32_mem:45867096,kntrie_uint64_find:354.1540,kntrie_uint64_insert:661.5082,kntrie_uint64_erase:433.3361,kntrie_uint64_mem:45867096,umap_int32_find:92.2584,umap_int32_insert:190.3349,umap_int32_erase:181.8196,umap_int32_mem:123112448,umap_uint64_find:108.8058,umap_uint64_insert:213.6487,umap_uint64_erase:219.6840,umap_uint64_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_int32_find:449.6064,kntrie_int32_insert:1172.7404,kntrie_int32_erase:732.6161,kntrie_int32_mem:68800920,kntrie_uint64_find:526.2303,kntrie_uint64_insert:985.8224,kntrie_uint64_erase:647.7581,kntrie_uint64_mem:68800920,umap_int32_find:140.2206,umap_int32_insert:267.9900,umap_int32_erase:264.4597,umap_int32_mem:184095064,umap_uint64_find:161.1822,umap_uint64_insert:310.1654,umap_uint64_erase:292.8936,umap_uint64_mem:184095064},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
