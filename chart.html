<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64)</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0005,kntrie_insert:0.0122,kntrie_erase:0.0047,kntrie_iter:0.0023,kntrie_mem:2056,map_fnd:0.0031,map_nf:0.0026,map_insert:0.0117,map_erase:0.0064,map_iter:0.0013,map_mem:4800,umap_fnd:0.0013,umap_nf:0.0018,umap_insert:0.0042,umap_erase:0.0024,umap_iter:0.0002,umap_mem:3224},
  {pattern:"random",N:150,kntrie_fnd:0.0010,kntrie_nf:0.0009,kntrie_insert:0.0140,kntrie_erase:0.0055,kntrie_iter:0.0037,kntrie_mem:4104,map_fnd:0.0051,map_nf:0.0049,map_insert:0.0169,map_erase:0.0096,map_iter:0.0017,map_mem:7200,umap_fnd:0.0019,umap_nf:0.0021,umap_insert:0.0061,umap_erase:0.0027,umap_iter:0.0003,umap_mem:4856},
  {pattern:"random",N:225,kntrie_fnd:0.0015,kntrie_nf:0.0013,kntrie_insert:0.0173,kntrie_erase:0.0066,kntrie_iter:0.0055,kntrie_mem:4104,map_fnd:0.0083,map_nf:0.0080,map_insert:0.0228,map_erase:0.0117,map_iter:0.0023,map_mem:10800,umap_fnd:0.0030,umap_nf:0.0040,umap_insert:0.0077,umap_erase:0.0039,umap_iter:0.0004,umap_mem:7216},
  {pattern:"random",N:337,kntrie_fnd:0.0026,kntrie_nf:0.0023,kntrie_insert:0.0219,kntrie_erase:0.0088,kntrie_iter:0.0092,kntrie_mem:8200,map_fnd:0.0132,map_nf:0.0134,map_insert:0.0344,map_erase:0.0179,map_iter:0.0033,map_mem:16176,umap_fnd:0.0042,umap_nf:0.0063,umap_insert:0.0112,umap_erase:0.0052,umap_iter:0.0006,umap_mem:10784},
  {pattern:"random",N:506,kntrie_fnd:0.0039,kntrie_nf:0.0034,kntrie_insert:0.0406,kntrie_erase:0.0116,kntrie_iter:0.0135,kntrie_mem:8200,map_fnd:0.0222,map_nf:0.0225,map_insert:0.0538,map_erase:0.0279,map_iter:0.0052,map_mem:24288,umap_fnd:0.0061,umap_nf:0.0088,umap_insert:0.0159,umap_erase:0.0076,umap_iter:0.0008,umap_mem:16472},
  {pattern:"random",N:759,kntrie_fnd:0.0067,kntrie_nf:0.0060,kntrie_insert:0.0517,kntrie_erase:0.0209,kntrie_iter:0.0224,kntrie_mem:16392,map_fnd:0.0361,map_nf:0.0372,map_insert:0.0810,map_erase:0.0429,map_iter:0.0077,map_mem:36432,umap_fnd:0.0097,umap_nf:0.0143,umap_insert:0.0231,umap_erase:0.0106,umap_iter:0.0013,umap_mem:24304},
  {pattern:"random",N:1139,kntrie_fnd:0.0110,kntrie_nf:0.0099,kntrie_insert:0.0698,kntrie_erase:0.0194,kntrie_iter:0.0365,kntrie_mem:32776,map_fnd:0.0633,map_nf:0.0635,map_insert:0.1187,map_erase:0.0610,map_iter:0.0121,map_mem:54672,umap_fnd:0.0143,umap_nf:0.0201,umap_insert:0.0305,umap_erase:0.0143,umap_iter:0.0022,umap_mem:36880},
  {pattern:"random",N:1708,kntrie_fnd:0.0167,kntrie_nf:0.0150,kntrie_insert:0.1083,kntrie_erase:0.0358,kntrie_iter:0.0548,kntrie_mem:32776,map_fnd:0.1076,map_nf:0.1048,map_insert:0.1836,map_erase:0.0962,map_iter:0.0186,map_mem:81984,umap_fnd:0.0229,umap_nf:0.0331,umap_insert:0.0449,umap_erase:0.0226,umap_iter:0.0044,umap_mem:54920},
  {pattern:"random",N:2562,kntrie_fnd:0.0292,kntrie_nf:0.0260,kntrie_insert:0.1781,kntrie_erase:0.0589,kntrie_iter:0.0892,kntrie_mem:65544,map_fnd:0.1778,map_nf:0.1741,map_insert:0.2880,map_erase:0.1509,map_iter:0.0287,map_mem:122976,umap_fnd:0.0350,umap_nf:0.0492,umap_insert:0.0646,umap_erase:0.0341,umap_iter:0.0074,umap_mem:83512},
  {pattern:"random",N:3844,kntrie_fnd:0.0453,kntrie_nf:0.0391,kntrie_insert:0.3268,kntrie_erase:0.0890,kntrie_iter:0.1338,kntrie_mem:65544,map_fnd:0.2999,map_nf:0.2928,map_insert:0.4426,map_erase:0.2438,map_iter:0.0444,map_mem:184512,umap_fnd:0.0560,umap_nf:0.0760,umap_insert:0.1031,umap_erase:0.0548,umap_iter:0.0126,umap_mem:124472},
  {pattern:"random",N:5766,kntrie_fnd:0.0621,kntrie_nf:0.0565,kntrie_insert:0.5336,kntrie_erase:0.1565,kntrie_iter:0.1677,kntrie_mem:131600,map_fnd:0.4819,map_nf:0.4820,map_insert:0.7171,map_erase:0.3932,map_iter:0.0656,map_mem:276768,umap_fnd:0.0875,umap_nf:0.1222,umap_insert:0.1600,umap_erase:0.0842,umap_iter:0.0208,umap_mem:186008},
  {pattern:"random",N:8649,kntrie_fnd:0.1255,kntrie_nf:0.1256,kntrie_insert:0.6766,kntrie_erase:0.2332,kntrie_iter:0.2650,kntrie_mem:214544,map_fnd:0.8226,map_nf:0.8152,map_insert:1.1201,map_erase:0.6353,map_iter:0.1039,map_mem:415152,umap_fnd:0.1331,umap_nf:0.1812,umap_insert:0.2402,umap_erase:0.1320,umap_iter:0.0327,umap_mem:277840},
  {pattern:"random",N:12974,kntrie_fnd:0.1562,kntrie_nf:0.1377,kntrie_insert:0.9737,kntrie_erase:0.3428,kntrie_iter:0.4133,kntrie_mem:274960,map_fnd:1.3624,map_nf:1.3373,map_insert:1.7905,map_erase:1.0014,map_iter:0.1592,map_mem:622752,umap_fnd:0.2050,umap_nf:0.2845,umap_insert:0.3578,umap_erase:0.2063,umap_iter:0.0511,umap_mem:415240},
  {pattern:"random",N:19461,kntrie_fnd:0.2877,kntrie_nf:0.2559,kntrie_insert:1.4059,kntrie_erase:0.5159,kntrie_iter:0.6562,kntrie_mem:503824,map_fnd:2.2615,map_nf:2.2258,map_insert:2.8522,map_erase:1.6481,map_iter:0.2631,map_mem:934128,umap_fnd:0.3043,umap_nf:0.4249,umap_insert:0.5336,umap_erase:0.3027,umap_iter:0.0809,umap_mem:633088},
  {pattern:"random",N:29192,kntrie_fnd:0.4469,kntrie_nf:0.3913,kntrie_insert:2.1046,kntrie_erase:0.7881,kntrie_iter:0.9968,kntrie_mem:568336,map_fnd:4.5286,map_nf:4.1429,map_insert:4.7293,map_erase:2.9011,map_iter:0.8370,map_mem:1401216,umap_fnd:0.4929,umap_nf:0.6644,umap_insert:0.8648,umap_erase:0.4864,umap_iter:0.1369,umap_mem:946424},
  {pattern:"random",N:43789,kntrie_fnd:0.7853,kntrie_nf:0.6849,kntrie_insert:3.1981,kntrie_erase:1.3285,kntrie_iter:1.6083,kntrie_mem:1053712,map_fnd:9.1267,map_nf:8.0190,map_insert:8.2842,map_erase:5.7252,map_iter:1.8789,map_mem:2101872,umap_fnd:0.8440,umap_nf:1.1142,umap_insert:1.4619,umap_erase:0.9567,umap_iter:0.2427,umap_mem:1414784},
  {pattern:"random",N:65684,kntrie_fnd:1.7123,kntrie_nf:1.3194,kntrie_insert:5.4768,kntrie_erase:2.0276,kntrie_iter:2.5343,kntrie_mem:1573904,map_fnd:17.2492,map_nf:17.1513,map_insert:14.3879,map_erase:10.7347,map_iter:3.3345,map_mem:3152832,umap_fnd:1.5294,umap_nf:2.0225,umap_insert:2.6040,umap_erase:1.9930,umap_iter:0.5216,umap_mem:2114872},
  {pattern:"random",N:98526,kntrie_fnd:3.3339,kntrie_nf:1.8591,kntrie_insert:8.1852,kntrie_erase:3.8459,kntrie_iter:3.9012,kntrie_mem:2102288,map_fnd:29.0261,map_nf:27.7937,map_insert:26.4893,map_erase:16.8858,map_iter:5.2170,map_mem:4729248,umap_fnd:2.4417,umap_nf:3.0586,umap_insert:4.5260,umap_erase:3.1965,umap_iter:1.1212,umap_mem:3162488},
  {pattern:"random",N:147789,kntrie_fnd:7.5800,kntrie_nf:4.4575,kntrie_insert:14.5746,kntrie_erase:6.3771,kntrie_iter:6.3577,kntrie_mem:4183056,map_fnd:53.9562,map_nf:52.5808,map_insert:44.3568,map_erase:30.4575,map_iter:9.2822,map_mem:7093872,umap_fnd:4.0237,umap_nf:5.1120,umap_insert:8.2924,umap_erase:5.4047,umap_iter:2.2233,umap_mem:4729280},
  {pattern:"random",N:221683,kntrie_fnd:11.6101,kntrie_nf:6.7029,kntrie_insert:24.1148,kntrie_erase:12.4691,kntrie_iter:9.5695,kntrie_mem:4199440,map_fnd:101.7824,map_nf:99.8681,map_insert:88.3083,map_erase:56.7403,map_iter:16.7856,map_mem:10640784,umap_fnd:6.4668,umap_nf:8.3626,umap_insert:14.3128,umap_erase:9.4155,umap_iter:4.1147,umap_mem:7215568},
  {pattern:"random",N:332525,kntrie_fnd:26.8443,kntrie_nf:17.6483,kntrie_insert:45.6697,kntrie_erase:22.5591,kntrie_iter:15.2005,kntrie_mem:8393744,map_fnd:184.8013,map_nf:184.3743,map_insert:143.1391,map_erase:96.6227,map_iter:26.7646,map_mem:15961200,umap_fnd:10.3120,umap_nf:12.6815,umap_insert:22.9277,umap_erase:14.8205,umap_iter:6.9728,umap_mem:10789088},
  {pattern:"random",N:498788,kntrie_fnd:45.4011,kntrie_nf:29.9521,kntrie_insert:97.4419,kntrie_erase:44.0664,kntrie_iter:22.7171,kntrie_mem:8524816,map_fnd:377.3332,map_nf:385.2359,map_insert:301.5427,map_erase:197.7562,map_iter:51.3365,map_mem:23941824,umap_fnd:18.1045,umap_nf:21.6345,umap_insert:42.6992,umap_erase:27.2810,umap_iter:13.7804,umap_mem:16132840},
  {pattern:"random",N:748182,kntrie_fnd:101.5959,kntrie_nf:69.6894,kntrie_insert:168.2763,kntrie_erase:85.2412,kntrie_iter:36.2278,kntrie_mem:16782352,map_fnd:687.8687,map_nf:718.8333,map_insert:527.1355,map_erase:352.3573,map_iter:97.7008,map_mem:35912736,umap_fnd:26.9853,umap_nf:32.5332,umap_insert:63.2275,umap_erase:40.6778,umap_iter:21.3816,umap_mem:24124760},
  {pattern:"random",N:1122274,kntrie_fnd:95.8371,kntrie_nf:81.8480,kntrie_insert:356.3062,kntrie_erase:56.3519,kntrie_iter:42.2050,kntrie_mem:27146000,umap_fnd:45.9904,umap_nf:53.0580,umap_insert:115.3948,umap_erase:69.4295,umap_iter:40.0081,umap_mem:36077144},
  {pattern:"random",N:1683411,kntrie_fnd:149.4592,kntrie_nf:121.3112,kntrie_insert:464.6100,kntrie_erase:167.6014,kntrie_iter:73.7150,kntrie_mem:37514256,umap_fnd:75.5498,umap_nf:85.7250,umap_insert:188.3492,umap_erase:118.9804,umap_iter:67.8815,umap_mem:53952736},
  {pattern:"random",N:2525116,kntrie_fnd:320.5184,kntrie_nf:261.3482,kntrie_insert:729.8182,kntrie_erase:328.1202,kntrie_iter:112.7965,kntrie_mem:62881040,umap_fnd:137.8347,umap_nf:139.1770,umap_insert:332.3697,umap_erase:221.2929,umap_iter:140.5258,umap_mem:82332776},
  {pattern:"random",N:3787675,kntrie_fnd:517.2616,kntrie_nf:394.2857,kntrie_insert:1111.8283,kntrie_erase:485.5696,kntrie_iter:172.1507,kntrie_mem:81038352,umap_fnd:248.2611,umap_nf:291.9179,umap_insert:604.4353,umap_erase:409.0501,umap_iter:272.7359,umap_mem:123112448},
  {pattern:"random",N:5681512,kntrie_fnd:909.3298,kntrie_nf:667.3337,kntrie_insert:1734.1531,kntrie_erase:856.9495,kntrie_iter:273.0299,kntrie_mem:135109648,umap_fnd:384.1966,umap_nf:451.9863,umap_insert:997.2521,umap_erase:698.7926,umap_iter:404.1911,umap_mem:184095064},
  {pattern:"sequential",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0005,kntrie_insert:0.0092,kntrie_erase:0.0040,kntrie_iter:0.0023,kntrie_mem:2056,map_fnd:0.0032,map_nf:0.0034,map_insert:0.0094,map_erase:0.0061,map_iter:0.0012,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0006,umap_insert:0.0036,umap_erase:0.0017,umap_iter:0.0002,umap_mem:3224},
  {pattern:"sequential",N:150,kntrie_fnd:0.0010,kntrie_nf:0.0009,kntrie_insert:0.0110,kntrie_erase:0.0050,kntrie_iter:0.0039,kntrie_mem:4104,map_fnd:0.0052,map_nf:0.0056,map_insert:0.0168,map_erase:0.0086,map_iter:0.0016,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0010,umap_insert:0.0042,umap_erase:0.0019,umap_iter:0.0003,umap_mem:4856},
  {pattern:"sequential",N:225,kntrie_fnd:0.0015,kntrie_nf:0.0013,kntrie_insert:0.0138,kntrie_erase:0.0059,kntrie_iter:0.0055,kntrie_mem:4104,map_fnd:0.0085,map_nf:0.0089,map_insert:0.0240,map_erase:0.0114,map_iter:0.0022,map_mem:10800,umap_fnd:0.0007,umap_nf:0.0014,umap_insert:0.0055,umap_erase:0.0018,umap_iter:0.0004,umap_mem:7216},
  {pattern:"sequential",N:337,kntrie_fnd:0.0026,kntrie_nf:0.0023,kntrie_insert:0.0230,kntrie_erase:0.0087,kntrie_iter:0.0091,kntrie_mem:8200,map_fnd:0.0136,map_nf:0.0144,map_insert:0.0347,map_erase:0.0170,map_iter:0.0033,map_mem:16176,umap_fnd:0.0010,umap_nf:0.0021,umap_insert:0.0075,umap_erase:0.0027,umap_iter:0.0006,umap_mem:10784},
  {pattern:"sequential",N:506,kntrie_fnd:0.0040,kntrie_nf:0.0034,kntrie_insert:0.0360,kntrie_erase:0.0118,kntrie_iter:0.0137,kntrie_mem:8200,map_fnd:0.0218,map_nf:0.0234,map_insert:0.0526,map_erase:0.0266,map_iter:0.0051,map_mem:24288,umap_fnd:0.0016,umap_nf:0.0034,umap_insert:0.0106,umap_erase:0.0039,umap_iter:0.0008,umap_mem:16472},
  {pattern:"sequential",N:759,kntrie_fnd:0.0067,kntrie_nf:0.0060,kntrie_insert:0.0495,kntrie_erase:0.0194,kntrie_iter:0.0224,kntrie_mem:16392,map_fnd:0.0367,map_nf:0.0396,map_insert:0.0808,map_erase:0.0412,map_iter:0.0078,map_mem:36432,umap_fnd:0.0024,umap_nf:0.0048,umap_insert:0.0150,umap_erase:0.0052,umap_iter:0.0013,umap_mem:24304},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0112,kntrie_nf:0.0101,kntrie_insert:0.0866,kntrie_erase:0.0216,kntrie_iter:0.0365,kntrie_mem:32776,map_fnd:0.0652,map_nf:0.0667,map_insert:0.1192,map_erase:0.0626,map_iter:0.0127,map_mem:54672,umap_fnd:0.0035,umap_nf:0.0076,umap_insert:0.0203,umap_erase:0.0063,umap_iter:0.0020,umap_mem:36880},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0168,kntrie_nf:0.0152,kntrie_insert:0.1060,kntrie_erase:0.0357,kntrie_iter:0.0547,kntrie_mem:32776,map_fnd:0.1086,map_nf:0.1125,map_insert:0.1885,map_erase:0.0986,map_iter:0.0194,map_mem:81984,umap_fnd:0.0054,umap_nf:0.0113,umap_insert:0.0295,umap_erase:0.0119,umap_iter:0.0030,umap_mem:54920},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0305,kntrie_nf:0.0263,kntrie_insert:0.1894,kntrie_erase:0.0586,kntrie_iter:0.0892,kntrie_mem:65544,map_fnd:0.1840,map_nf:0.1864,map_insert:0.2934,map_erase:0.1609,map_iter:0.0289,map_mem:122976,umap_fnd:0.0080,umap_nf:0.0188,umap_insert:0.0466,umap_erase:0.0164,umap_iter:0.0044,umap_mem:83512},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0449,kntrie_nf:0.0392,kntrie_insert:0.2681,kntrie_erase:0.0838,kntrie_iter:0.1339,kntrie_mem:65544,map_fnd:0.3059,map_nf:0.3022,map_insert:0.4717,map_erase:0.2454,map_iter:0.0465,map_mem:184512,umap_fnd:0.0121,umap_nf:0.0275,umap_insert:0.0620,umap_erase:0.0264,umap_iter:0.0064,umap_mem:124472},
  {pattern:"sequential",N:5766,kntrie_fnd:0.1803,kntrie_nf:0.1537,kntrie_insert:0.5282,kntrie_erase:0.0981,kntrie_iter:0.1821,kntrie_mem:70720,map_fnd:0.4984,map_nf:0.5014,map_insert:0.7193,map_erase:0.4046,map_iter:0.0685,map_mem:276768,umap_fnd:0.0186,umap_nf:0.0407,umap_insert:0.0941,umap_erase:0.0414,umap_iter:0.0095,umap_mem:186008},
  {pattern:"sequential",N:8649,kntrie_fnd:0.2654,kntrie_nf:0.2230,kntrie_insert:0.7158,kntrie_erase:0.2155,kntrie_iter:0.2711,kntrie_mem:105792,map_fnd:0.8222,map_nf:0.8119,map_insert:1.1354,map_erase:0.6465,map_iter:0.1048,map_mem:415152,umap_fnd:0.0293,umap_nf:0.0599,umap_insert:0.1307,umap_erase:0.0603,umap_iter:0.0139,umap_mem:277840},
  {pattern:"sequential",N:12974,kntrie_fnd:0.4066,kntrie_nf:0.3350,kntrie_insert:0.9449,kntrie_erase:0.3131,kntrie_iter:0.4283,kntrie_mem:158816,map_fnd:1.3745,map_nf:1.3484,map_insert:1.8163,map_erase:1.0148,map_iter:0.1640,map_mem:622752,umap_fnd:0.0397,umap_nf:0.0886,umap_insert:0.1964,umap_erase:0.0934,umap_iter:0.0206,umap_mem:415240},
  {pattern:"sequential",N:19461,kntrie_fnd:0.6133,kntrie_nf:0.5034,kntrie_insert:1.2961,kntrie_erase:0.4825,kntrie_iter:0.6145,kntrie_mem:238048,map_fnd:2.4333,map_nf:2.4004,map_insert:2.9580,map_erase:1.7148,map_iter:0.2713,map_mem:934128,umap_fnd:0.0652,umap_nf:0.1428,umap_insert:0.2929,umap_erase:0.1595,umap_iter:0.0306,umap_mem:633088},
  {pattern:"sequential",N:29192,kntrie_fnd:0.9183,kntrie_nf:0.7532,kntrie_insert:1.8803,kntrie_erase:0.7278,kntrie_iter:0.9123,kntrie_mem:357056,map_fnd:4.2928,map_nf:4.1323,map_insert:4.6839,map_erase:2.8539,map_iter:0.6729,map_mem:1401216,umap_fnd:0.1066,umap_nf:0.2138,umap_insert:0.4446,umap_erase:0.2263,umap_iter:0.0487,umap_mem:946424},
  {pattern:"sequential",N:43789,kntrie_fnd:1.4262,kntrie_nf:1.1633,kntrie_insert:3.3501,kntrie_erase:1.3007,kntrie_iter:1.6025,kntrie_mem:535264,map_fnd:8.9813,map_nf:8.9590,map_insert:8.0690,map_erase:5.5630,map_iter:1.8986,map_mem:2101872,umap_fnd:0.3277,umap_nf:0.4561,umap_insert:0.6854,umap_erase:0.5561,umap_iter:0.0901,umap_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_fnd:2.2019,kntrie_nf:1.7769,kntrie_insert:4.9099,kntrie_erase:2.0132,kntrie_iter:2.4142,kntrie_mem:803768,map_fnd:18.2573,map_nf:18.3588,map_insert:15.1654,map_erase:10.1796,map_iter:3.5558,map_mem:3152832,umap_fnd:0.7695,umap_nf:0.9644,umap_insert:1.0934,umap_erase:1.4380,umap_iter:0.1373,umap_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_fnd:3.3693,kntrie_nf:2.7161,kntrie_insert:7.5460,kntrie_erase:3.0613,kntrie_iter:3.5755,kntrie_mem:1204168,map_fnd:31.5047,map_nf:32.0678,map_insert:26.6574,map_erase:18.0235,map_iter:6.0531,map_mem:4729248,umap_fnd:1.3018,umap_nf:1.6223,umap_insert:1.9408,umap_erase:2.4096,umap_iter:0.2076,umap_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_fnd:5.3558,kntrie_nf:4.1382,kntrie_insert:11.4280,kntrie_erase:4.6881,kntrie_iter:5.3541,kntrie_mem:1806096,map_fnd:60.0698,map_nf:58.7228,map_insert:48.4053,map_erase:32.9841,map_iter:10.8192,map_mem:7093872,umap_fnd:2.1956,umap_nf:2.6715,umap_insert:3.9581,umap_erase:3.4238,umap_iter:0.3251,umap_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_fnd:9.9122,kntrie_nf:6.3566,kntrie_insert:18.4502,kntrie_erase:8.0230,kntrie_iter:8.0587,kntrie_mem:2708512,map_fnd:109.7283,map_nf:110.2798,map_insert:87.8108,map_erase:59.6959,map_iter:19.2303,map_mem:10640784,umap_fnd:3.5937,umap_nf:4.3359,umap_insert:7.3735,umap_erase:6.6113,umap_iter:0.4830,umap_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_fnd:17.4367,kntrie_nf:9.7507,kntrie_insert:31.3350,kntrie_erase:15.1032,kntrie_iter:12.1779,kntrie_mem:4063248,map_fnd:204.2939,map_nf:213.5648,map_insert:162.6068,map_erase:107.7774,map_iter:29.5142,map_mem:15961200,umap_fnd:5.7164,umap_nf:6.9178,umap_insert:11.4716,umap_erase:11.1557,umap_iter:0.7358,umap_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_fnd:29.7908,kntrie_nf:15.3846,kntrie_insert:55.4181,kntrie_erase:30.7518,kntrie_iter:18.8844,kntrie_mem:6094960,map_fnd:359.0746,map_nf:379.0614,map_insert:275.6539,map_erase:172.6580,map_iter:46.1946,map_mem:23941824,umap_fnd:7.8109,umap_nf:9.9123,umap_insert:16.6921,umap_erase:16.0196,umap_iter:1.1057,umap_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_fnd:48.2190,kntrie_nf:25.1777,kntrie_insert:104.7655,kntrie_erase:52.2238,kntrie_iter:27.5416,kntrie_mem:9142192,map_fnd:647.4067,map_nf:711.6082,map_insert:470.4573,map_erase:336.0269,map_iter:84.5673,map_mem:35912736,umap_fnd:13.4474,umap_nf:16.2676,umap_insert:26.3759,umap_erase:26.6179,umap_iter:2.4235,umap_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_fnd:83.9165,kntrie_nf:41.2323,kntrie_insert:163.9577,kntrie_erase:95.5964,kntrie_iter:41.3491,kntrie_mem:13713968,umap_fnd:24.9007,umap_nf:25.2815,umap_insert:48.0756,umap_erase:42.8934,umap_iter:4.9402,umap_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_fnd:147.6350,kntrie_nf:74.1749,kntrie_insert:281.0433,kntrie_erase:172.3486,kntrie_iter:62.5761,kntrie_mem:20570432,umap_fnd:44.9104,umap_nf:43.4205,umap_insert:81.2440,umap_erase:80.4789,umap_iter:7.7057,umap_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_fnd:310.9201,kntrie_nf:162.2445,kntrie_insert:502.5191,kntrie_erase:299.8733,kntrie_iter:95.7782,kntrie_mem:30852312,umap_fnd:76.4126,umap_nf:78.7690,umap_insert:134.7524,umap_erase:154.7015,umap_iter:12.0088,umap_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_fnd:570.5071,kntrie_nf:288.2190,kntrie_insert:908.1698,kntrie_erase:547.4774,kntrie_iter:145.0687,kntrie_mem:46283712,umap_fnd:146.2816,umap_nf:180.2606,umap_insert:237.3302,umap_erase:318.4586,umap_iter:18.3665,umap_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_fnd:871.4037,kntrie_nf:464.1937,kntrie_insert:1619.0787,kntrie_erase:851.0922,kntrie_iter:220.6453,kntrie_mem:69425392,umap_fnd:235.5868,umap_nf:337.2320,umap_insert:342.8356,umap_erase:547.6293,umap_iter:26.7232,umap_mem:184095064},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
