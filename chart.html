<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64 &rarr; i32)</h2>
  <p class="sub">Log-log &middot; Per-entry &middot; Lower is better &middot; FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0007,kntrie_nf:0.0007,kntrie_insert:0.0119,kntrie_erase:0.0067,kntrie_iter:0.0027,kntrie_mem:1544,map_fnd:0.0034,map_nf:0.0025,map_insert:0.0113,map_erase:0.0067,map_iter:0.0012,map_mem:4800,umap_fnd:0.0012,umap_nf:0.0018,umap_insert:0.0041,umap_erase:0.0028,umap_iter:0.0002,umap_mem:3224,kntrie_mempre:2024},
  {pattern:"random",N:150,kntrie_fnd:0.0012,kntrie_nf:0.0010,kntrie_insert:0.0126,kntrie_erase:0.0070,kntrie_iter:0.0042,kntrie_mem:3080,map_fnd:0.0056,map_nf:0.0045,map_insert:0.0171,map_erase:0.0093,map_iter:0.0017,map_mem:7200,umap_fnd:0.0017,umap_nf:0.0021,umap_insert:0.0061,umap_erase:0.0032,umap_iter:0.0003,umap_mem:4856,kntrie_mempre:3560},
  {pattern:"random",N:225,kntrie_fnd:0.0017,kntrie_nf:0.0016,kntrie_insert:0.0167,kntrie_erase:0.0074,kntrie_iter:0.0060,kntrie_mem:3080,map_fnd:0.0091,map_nf:0.0081,map_insert:0.0245,map_erase:0.0122,map_iter:0.0022,map_mem:10800,umap_fnd:0.0029,umap_nf:0.0039,umap_insert:0.0085,umap_erase:0.0040,umap_iter:0.0004,umap_mem:7216,kntrie_mempre:3560},
  {pattern:"random",N:337,kntrie_fnd:0.0029,kntrie_nf:0.0025,kntrie_insert:0.0251,kntrie_erase:0.0103,kntrie_iter:0.0094,kntrie_mem:6152,map_fnd:0.0147,map_nf:0.0134,map_insert:0.0347,map_erase:0.0181,map_iter:0.0031,map_mem:16176,umap_fnd:0.0039,umap_nf:0.0062,umap_insert:0.0114,umap_erase:0.0055,umap_iter:0.0006,umap_mem:10784,kntrie_mempre:6632},
  {pattern:"random",N:506,kntrie_fnd:0.0044,kntrie_nf:0.0040,kntrie_insert:0.0414,kntrie_erase:0.0143,kntrie_iter:0.0142,kntrie_mem:6152,map_fnd:0.0245,map_nf:0.0218,map_insert:0.0527,map_erase:0.0278,map_iter:0.0048,map_mem:24288,umap_fnd:0.0056,umap_nf:0.0086,umap_insert:0.0160,umap_erase:0.0078,umap_iter:0.0008,umap_mem:16472,kntrie_mempre:6632},
  {pattern:"random",N:759,kntrie_fnd:0.0072,kntrie_nf:0.0064,kntrie_insert:0.0549,kntrie_erase:0.0218,kntrie_iter:0.0230,kntrie_mem:12296,map_fnd:0.0398,map_nf:0.0368,map_insert:0.0796,map_erase:0.0414,map_iter:0.0075,map_mem:36432,umap_fnd:0.0091,umap_nf:0.0142,umap_insert:0.0232,umap_erase:0.0113,umap_iter:0.0013,umap_mem:24304,kntrie_mempre:12776},
  {pattern:"random",N:1139,kntrie_fnd:0.0123,kntrie_nf:0.0103,kntrie_insert:0.0790,kntrie_erase:0.0210,kntrie_iter:0.0369,kntrie_mem:24584,map_fnd:0.0673,map_nf:0.0635,map_insert:0.1204,map_erase:0.0614,map_iter:0.0117,map_mem:54672,umap_fnd:0.0132,umap_nf:0.0196,umap_insert:0.0315,umap_erase:0.0142,umap_iter:0.0022,umap_mem:36880,kntrie_mempre:25064},
  {pattern:"random",N:1708,kntrie_fnd:0.0188,kntrie_nf:0.0153,kntrie_insert:0.1147,kntrie_erase:0.0377,kntrie_iter:0.0554,kntrie_mem:24584,map_fnd:0.1083,map_nf:0.1060,map_insert:0.1992,map_erase:0.1003,map_iter:0.0186,map_mem:81984,umap_fnd:0.0216,umap_nf:0.0324,umap_insert:0.0469,umap_erase:0.0233,umap_iter:0.0043,umap_mem:54920,kntrie_mempre:25064},
  {pattern:"random",N:2562,kntrie_fnd:0.0326,kntrie_nf:0.0271,kntrie_insert:0.1927,kntrie_erase:0.0569,kntrie_iter:0.0902,kntrie_mem:49160,map_fnd:0.1801,map_nf:0.1770,map_insert:0.2891,map_erase:0.1548,map_iter:0.0286,map_mem:122976,umap_fnd:0.0328,umap_nf:0.0491,umap_insert:0.0671,umap_erase:0.0355,umap_iter:0.0076,umap_mem:83512,kntrie_mempre:49640},
  {pattern:"random",N:3844,kntrie_fnd:0.0476,kntrie_nf:0.0396,kntrie_insert:0.2716,kntrie_erase:0.0856,kntrie_iter:0.1354,kntrie_mem:49160,map_fnd:0.2945,map_nf:0.2893,map_insert:0.4521,map_erase:0.2389,map_iter:0.0419,map_mem:184512,umap_fnd:0.0526,umap_nf:0.0747,umap_insert:0.1112,umap_erase:0.0556,umap_iter:0.0128,umap_mem:124472,kntrie_mempre:49640},
  {pattern:"random",N:5766,kntrie_fnd:0.0635,kntrie_nf:0.0559,kntrie_insert:0.5200,kntrie_erase:0.1679,kntrie_iter:0.1793,kntrie_mem:100192,map_fnd:0.4829,map_nf:0.4803,map_insert:0.7173,map_erase:0.3934,map_iter:0.0648,map_mem:276768,umap_fnd:0.0823,umap_nf:0.1217,umap_insert:0.1615,umap_erase:0.0851,umap_iter:0.0206,umap_mem:186008,kntrie_mempre:124320},
  {pattern:"random",N:8649,kntrie_fnd:0.1284,kntrie_nf:0.1279,kntrie_insert:0.7165,kntrie_erase:0.2234,kntrie_iter:0.2810,kntrie_mem:162192,map_fnd:0.8211,map_nf:0.8293,map_insert:1.1660,map_erase:0.6457,map_iter:0.1049,map_mem:415152,umap_fnd:0.1274,umap_nf:0.1775,umap_insert:0.2477,umap_erase:0.1366,umap_iter:0.0324,umap_mem:277840,kntrie_mempre:192848},
  {pattern:"random",N:12974,kntrie_fnd:0.1627,kntrie_nf:0.1373,kntrie_insert:0.9956,kntrie_erase:0.3693,kntrie_iter:0.4421,kntrie_mem:207504,map_fnd:1.3524,map_nf:1.3689,map_insert:1.8433,map_erase:1.0012,map_iter:0.1603,map_mem:622752,umap_fnd:0.1973,umap_nf:0.2792,umap_insert:0.3691,umap_erase:0.1993,umap_iter:0.0511,umap_mem:415240,kntrie_mempre:235520},
  {pattern:"random",N:19461,kntrie_fnd:0.2954,kntrie_nf:0.2501,kntrie_insert:1.4392,kntrie_erase:0.5161,kntrie_iter:0.6854,kntrie_mem:379152,map_fnd:2.2489,map_nf:2.3073,map_insert:2.9275,map_erase:1.6000,map_iter:0.2589,map_mem:934128,umap_fnd:0.2921,umap_nf:0.4097,umap_insert:0.5429,umap_erase:0.2961,umap_iter:0.0805,umap_mem:633088,kntrie_mempre:409456},
  {pattern:"random",N:29192,kntrie_fnd:0.4047,kntrie_nf:0.3300,kntrie_insert:1.8542,kntrie_erase:0.7107,kntrie_iter:0.9344,kntrie_mem:427536,map_fnd:4.0189,map_nf:3.8439,map_insert:4.7456,map_erase:2.7475,map_iter:0.7054,map_mem:1401216,umap_fnd:0.4609,umap_nf:0.6125,umap_insert:0.8531,umap_erase:0.4204,umap_iter:0.1408,umap_mem:946424,kntrie_mempre:459104},
  {pattern:"random",N:43789,kntrie_fnd:0.6889,kntrie_nf:0.5849,kntrie_insert:2.8205,kntrie_erase:1.0999,kntrie_iter:1.4705,kntrie_mem:791568,map_fnd:7.8806,map_nf:7.3022,map_insert:7.1516,map_erase:4.8398,map_iter:1.6278,map_mem:2101872,umap_fnd:0.7139,umap_nf:0.9738,umap_insert:1.2952,umap_erase:0.8075,umap_iter:0.2109,umap_mem:1414784,kntrie_mempre:821056},
  {pattern:"random",N:65684,kntrie_fnd:1.4906,kntrie_nf:1.3531,kntrie_insert:5.5437,kntrie_erase:1.8556,kntrie_iter:2.6344,kntrie_mem:1181712,map_fnd:15.8583,map_nf:14.5431,map_insert:14.7789,map_erase:9.3377,map_iter:3.0742,map_mem:3152832,umap_fnd:1.3542,umap_nf:1.7907,umap_insert:2.4299,umap_erase:1.6188,umap_iter:0.4225,umap_mem:2114872,kntrie_mempre:1210656},
  {pattern:"random",N:98526,kntrie_fnd:2.3585,kntrie_nf:1.8298,kntrie_insert:8.0562,kntrie_erase:3.4154,kntrie_iter:4.0735,kntrie_mem:1578000,map_fnd:29.1166,map_nf:27.4090,map_insert:27.8775,map_erase:18.2150,map_iter:4.9413,map_mem:4729248,umap_fnd:2.3984,umap_nf:3.1677,umap_insert:4.6639,umap_erase:3.2166,umap_iter:1.1481,umap_mem:3162488,kntrie_mempre:1607216},
  {pattern:"random",N:147789,kntrie_fnd:8.5189,kntrie_nf:4.9086,kntrie_insert:15.2141,kntrie_erase:6.3464,kntrie_iter:6.6161,kntrie_mem:3138576,map_fnd:59.1883,map_nf:53.1943,map_insert:48.0919,map_erase:31.0347,map_iter:10.1234,map_mem:7093872,umap_fnd:4.1198,umap_nf:5.4887,umap_insert:8.9741,umap_erase:5.8744,umap_iter:2.4540,umap_mem:4729280,kntrie_mempre:3167920},
  {pattern:"random",N:221683,kntrie_fnd:12.4573,kntrie_nf:6.5454,kntrie_insert:23.8991,kntrie_erase:11.4607,kntrie_iter:9.8677,kntrie_mem:3150864,map_fnd:93.3753,map_nf:98.7656,map_insert:80.6699,map_erase:54.1529,map_iter:16.3330,map_mem:10640784,umap_fnd:6.1705,umap_nf:7.9491,umap_insert:14.2549,umap_erase:8.9065,umap_iter:4.0310,umap_mem:7215568,kntrie_mempre:3178560},
  {pattern:"random",N:332525,kntrie_fnd:26.0041,kntrie_nf:18.4575,kntrie_insert:39.4220,kntrie_erase:20.9202,kntrie_iter:12.9798,kntrie_mem:6296592,umap_fnd:10.0070,umap_nf:11.5482,umap_insert:22.1531,umap_erase:14.1180,umap_iter:7.0679,umap_mem:10789088,kntrie_mempre:6326352},
  {pattern:"random",N:498788,kntrie_fnd:40.5893,kntrie_nf:26.9074,kntrie_insert:85.0574,kntrie_erase:35.7304,kntrie_iter:23.7877,kntrie_mem:6394896,umap_fnd:17.2608,umap_nf:20.9097,umap_insert:43.6417,umap_erase:25.0774,umap_iter:13.4848,umap_mem:16132840,kntrie_mempre:6424048},
  {pattern:"random",N:748182,kntrie_fnd:80.5673,kntrie_nf:62.1682,kntrie_insert:141.2346,kntrie_erase:69.8008,kntrie_iter:37.6610,kntrie_mem:12588048,umap_fnd:25.1797,umap_nf:31.2619,umap_insert:64.4637,umap_erase:35.4651,umap_iter:19.7790,umap_mem:24124760,kntrie_mempre:12618080},
  {pattern:"random",N:1122274,kntrie_fnd:77.7870,kntrie_nf:73.3093,kntrie_insert:304.4902,kntrie_erase:119.3558,kntrie_iter:44.5599,kntrie_mem:20952504,umap_fnd:38.3606,umap_nf:47.6123,umap_insert:94.9040,umap_erase:56.6649,umap_iter:31.6334,umap_mem:36077144,kntrie_mempre:21568440},
  {pattern:"random",N:1683411,kntrie_fnd:133.2094,kntrie_nf:106.3897,kntrie_insert:407.3628,kntrie_erase:182.8032,kntrie_iter:74.0390,kntrie_mem:28480560,umap_fnd:74.6300,umap_nf:79.2336,umap_insert:157.7896,umap_erase:110.3381,umap_iter:70.2723,umap_mem:53952736,kntrie_mempre:34870096},
  {pattern:"random",N:2525116,kntrie_fnd:273.5632,kntrie_nf:249.2124,kntrie_insert:608.5398,kntrie_erase:349.5254,kntrie_iter:122.9771,kntrie_mem:47490264,umap_fnd:114.6519,umap_nf:137.7618,umap_insert:318.6036,umap_erase:213.6708,umap_iter:122.9116,umap_mem:82332776,kntrie_mempre:54213080},
  {pattern:"random",N:3787675,kntrie_fnd:429.7479,kntrie_nf:350.3305,kntrie_insert:971.0835,kntrie_erase:385.9836,kntrie_iter:180.3087,kntrie_mem:61108240,umap_fnd:192.7415,umap_nf:224.2159,umap_insert:437.5116,umap_erase:331.8817,umap_iter:189.3065,umap_mem:123112448,kntrie_mempre:67854496},
  {pattern:"random",N:5681512,kntrie_fnd:751.3671,kntrie_nf:662.6685,kntrie_insert:1565.0497,kntrie_erase:776.0849,kntrie_iter:288.1872,kntrie_mem:101661712,umap_fnd:328.4347,umap_nf:349.4430,umap_insert:819.5443,umap_erase:555.1543,umap_iter:321.0741,umap_mem:184095064,kntrie_mempre:108438000},
  {pattern:"sequential",N:100,kntrie_fnd:0.0006,kntrie_nf:0.0007,kntrie_insert:0.0108,kntrie_erase:0.0056,kntrie_iter:0.0024,kntrie_mem:1544,map_fnd:0.0034,map_nf:0.0034,map_insert:0.0104,map_erase:0.0062,map_iter:0.0012,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0007,umap_insert:0.0020,umap_erase:0.0017,umap_iter:0.0002,umap_mem:3224,kntrie_mempre:2024},
  {pattern:"sequential",N:150,kntrie_fnd:0.0011,kntrie_nf:0.0010,kntrie_insert:0.0129,kntrie_erase:0.0058,kntrie_iter:0.0040,kntrie_mem:3080,map_fnd:0.0056,map_nf:0.0056,map_insert:0.0169,map_erase:0.0088,map_iter:0.0015,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0010,umap_insert:0.0043,umap_erase:0.0025,umap_iter:0.0003,umap_mem:4856,kntrie_mempre:3560},
  {pattern:"sequential",N:225,kntrie_fnd:0.0017,kntrie_nf:0.0016,kntrie_insert:0.0150,kntrie_erase:0.0068,kntrie_iter:0.0058,kntrie_mem:3080,map_fnd:0.0092,map_nf:0.0093,map_insert:0.0238,map_erase:0.0122,map_iter:0.0021,map_mem:10800,umap_fnd:0.0007,umap_nf:0.0014,umap_insert:0.0055,umap_erase:0.0020,umap_iter:0.0004,umap_mem:7216,kntrie_mempre:3560},
  {pattern:"sequential",N:337,kntrie_fnd:0.0029,kntrie_nf:0.0025,kntrie_insert:0.0247,kntrie_erase:0.0105,kntrie_iter:0.0094,kntrie_mem:6152,map_fnd:0.0150,map_nf:0.0151,map_insert:0.0352,map_erase:0.0175,map_iter:0.0032,map_mem:16176,umap_fnd:0.0010,umap_nf:0.0021,umap_insert:0.0074,umap_erase:0.0027,umap_iter:0.0006,umap_mem:10784,kntrie_mempre:6632},
  {pattern:"sequential",N:506,kntrie_fnd:0.0044,kntrie_nf:0.0037,kntrie_insert:0.0374,kntrie_erase:0.0135,kntrie_iter:0.0138,kntrie_mem:6152,map_fnd:0.0235,map_nf:0.0237,map_insert:0.0528,map_erase:0.0260,map_iter:0.0047,map_mem:24288,umap_fnd:0.0016,umap_nf:0.0034,umap_insert:0.0107,umap_erase:0.0042,umap_iter:0.0008,umap_mem:16472,kntrie_mempre:6632},
  {pattern:"sequential",N:759,kntrie_fnd:0.0071,kntrie_nf:0.0065,kntrie_insert:0.0512,kntrie_erase:0.0200,kntrie_iter:0.0228,kntrie_mem:12296,map_fnd:0.0392,map_nf:0.0393,map_insert:0.0801,map_erase:0.0400,map_iter:0.0076,map_mem:36432,umap_fnd:0.0024,umap_nf:0.0048,umap_insert:0.0148,umap_erase:0.0052,umap_iter:0.0013,umap_mem:24304,kntrie_mempre:12776},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0122,kntrie_nf:0.0102,kntrie_insert:0.0808,kntrie_erase:0.0206,kntrie_iter:0.0369,kntrie_mem:24584,map_fnd:0.0661,map_nf:0.0661,map_insert:0.1187,map_erase:0.0616,map_iter:0.0114,map_mem:54672,umap_fnd:0.0035,umap_nf:0.0076,umap_insert:0.0204,umap_erase:0.0065,umap_iter:0.0020,umap_mem:36880,kntrie_mempre:25064},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0184,kntrie_nf:0.0157,kntrie_insert:0.1104,kntrie_erase:0.0361,kntrie_iter:0.0553,kntrie_mem:24584,map_fnd:0.1092,map_nf:0.1094,map_insert:0.1853,map_erase:0.0958,map_iter:0.0183,map_mem:81984,umap_fnd:0.0052,umap_nf:0.0114,umap_insert:0.0292,umap_erase:0.0103,umap_iter:0.0031,umap_mem:54920,kntrie_mempre:25064},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0312,kntrie_nf:0.0263,kntrie_insert:0.1873,kntrie_erase:0.0571,kntrie_iter:0.0902,kntrie_mem:49160,map_fnd:0.1809,map_nf:0.1827,map_insert:0.2900,map_erase:0.1518,map_iter:0.0278,map_mem:122976,umap_fnd:0.0078,umap_nf:0.0180,umap_insert:0.0420,umap_erase:0.0161,umap_iter:0.0044,umap_mem:83512,kntrie_mempre:49640},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0469,kntrie_nf:0.0402,kntrie_insert:0.3004,kntrie_erase:0.0865,kntrie_iter:0.1353,kntrie_mem:49160,map_fnd:0.2979,map_nf:0.3013,map_insert:0.4631,map_erase:0.2440,map_iter:0.0425,map_mem:184512,umap_fnd:0.0121,umap_nf:0.0269,umap_insert:0.0595,umap_erase:0.0248,umap_iter:0.0064,umap_mem:124472,kntrie_mempre:49640},
  {pattern:"sequential",N:5766,kntrie_fnd:0.1774,kntrie_nf:0.1498,kntrie_insert:0.5299,kntrie_erase:0.1312,kntrie_iter:0.1858,kntrie_mem:36128,map_fnd:0.4863,map_nf:0.4920,map_insert:0.7216,map_erase:0.3944,map_iter:0.0664,map_mem:276768,umap_fnd:0.0181,umap_nf:0.0399,umap_insert:0.0885,umap_erase:0.0385,umap_iter:0.0094,umap_mem:186008,kntrie_mempre:36592},
  {pattern:"sequential",N:8649,kntrie_fnd:0.2694,kntrie_nf:0.2234,kntrie_insert:0.6706,kntrie_erase:0.1939,kntrie_iter:0.2781,kntrie_mem:53952,map_fnd:0.8122,map_nf:0.8375,map_insert:1.1519,map_erase:0.6187,map_iter:0.1036,map_mem:415152,umap_fnd:0.0282,umap_nf:0.0598,umap_insert:0.1329,umap_erase:0.0606,umap_iter:0.0140,umap_mem:277840,kntrie_mempre:60144},
  {pattern:"sequential",N:12974,kntrie_fnd:0.4061,kntrie_nf:0.3380,kntrie_insert:0.8715,kntrie_erase:0.2802,kntrie_iter:0.4144,kntrie_mem:81008,map_fnd:1.3474,map_nf:1.3724,map_insert:1.8136,map_erase:1.0091,map_iter:0.1616,map_mem:622752,umap_fnd:0.0396,umap_nf:0.0859,umap_insert:0.1962,umap_erase:0.0892,umap_iter:0.0206,umap_mem:415240,kntrie_mempre:118320},
  {pattern:"sequential",N:19461,kntrie_fnd:0.6316,kntrie_nf:0.5443,kntrie_insert:1.3520,kntrie_erase:0.4376,kntrie_iter:0.6995,kntrie_mem:121280,map_fnd:2.8187,map_nf:2.5579,map_insert:3.4230,map_erase:1.7187,map_iter:0.3334,map_mem:934128,umap_fnd:0.0633,umap_nf:0.1414,umap_insert:0.3174,umap_erase:0.1415,umap_iter:0.0316,umap_mem:633088,kntrie_mempre:193792},
  {pattern:"sequential",N:29192,kntrie_fnd:0.9274,kntrie_nf:0.7600,kntrie_insert:1.7818,kntrie_erase:0.6555,kntrie_iter:0.9557,kntrie_mem:181936,map_fnd:4.0831,map_nf:4.4096,map_insert:4.7914,map_erase:2.7644,map_iter:0.6197,map_mem:1401216,umap_fnd:0.1078,umap_nf:0.2166,umap_insert:0.4630,umap_erase:0.2416,umap_iter:0.0505,umap_mem:946424,kntrie_mempre:314544},
  {pattern:"sequential",N:43789,kntrie_fnd:1.4175,kntrie_nf:1.1513,kntrie_insert:3.1507,kntrie_erase:1.1880,kntrie_iter:1.6373,kntrie_mem:272496,map_fnd:8.4923,map_nf:8.6045,map_insert:8.0743,map_erase:5.1885,map_iter:1.6761,map_mem:2101872,umap_fnd:0.2731,umap_nf:0.4272,umap_insert:0.6673,umap_erase:0.5130,umap_iter:0.0790,umap_mem:1414784,kntrie_mempre:442000},
  {pattern:"sequential",N:65684,kntrie_fnd:2.1704,kntrie_nf:1.7777,kntrie_insert:4.6171,kntrie_erase:1.8230,kntrie_iter:2.4377,kntrie_mem:409528,map_fnd:16.2028,map_nf:16.2442,map_insert:14.4915,map_erase:9.5716,map_iter:3.3595,map_mem:3152832,umap_fnd:0.6597,umap_nf:0.8796,umap_insert:1.0620,umap_erase:1.2430,umap_iter:0.1333,umap_mem:2114872,kntrie_mempre:703384},
  {pattern:"sequential",N:98526,kntrie_fnd:3.3409,kntrie_nf:2.7712,kntrie_insert:7.0597,kntrie_erase:2.8222,kntrie_iter:3.7110,kntrie_mem:613320,map_fnd:28.5856,map_nf:29.1000,map_insert:26.2766,map_erase:16.5867,map_iter:5.9074,map_mem:4729248,umap_fnd:1.2949,umap_nf:1.5553,umap_insert:1.8677,umap_erase:2.0590,umap_iter:0.2014,umap_mem:3162488,kntrie_mempre:1049672},
  {pattern:"sequential",N:147789,kntrie_fnd:5.1199,kntrie_nf:4.1859,kntrie_insert:10.7346,kntrie_erase:4.2676,kntrie_iter:5.5258,kntrie_mem:919440,map_fnd:51.2496,map_nf:51.8022,map_insert:44.7302,map_erase:29.5339,map_iter:8.7062,map_mem:7093872,umap_fnd:1.9660,umap_nf:2.3229,umap_insert:3.6251,umap_erase:3.3378,umap_iter:0.2974,umap_mem:4729280,kntrie_mempre:1564816},
  {pattern:"sequential",N:221683,kntrie_fnd:8.1652,kntrie_nf:6.4116,kntrie_insert:16.6040,kntrie_erase:6.5925,kntrie_iter:8.5146,kntrie_mem:1378592,map_fnd:93.6671,map_nf:93.0048,map_insert:81.2164,map_erase:53.5429,map_iter:15.3059,map_mem:10640784,umap_fnd:3.2512,umap_nf:4.1336,umap_insert:6.8778,umap_erase:5.7376,umap_iter:0.4496,umap_mem:7215568,kntrie_mempre:2367792},
  {pattern:"sequential",N:332525,kntrie_fnd:14.5430,kntrie_nf:9.9045,kntrie_insert:25.9890,kntrie_erase:11.0559,kntrie_iter:12.6007,kntrie_mem:2068240,umap_fnd:5.0749,umap_nf:6.2596,umap_insert:10.3662,umap_erase:9.4037,umap_iter:0.8356,umap_mem:10789088,kntrie_mempre:3528400},
  {pattern:"sequential",N:498788,kntrie_fnd:25.1592,kntrie_nf:15.1824,kntrie_insert:44.8247,kntrie_erase:20.3582,kntrie_iter:19.1313,kntrie_mem:3102320,umap_fnd:9.6697,umap_nf:9.4410,umap_insert:17.9836,umap_erase:15.4883,umap_iter:1.8654,umap_mem:16132840,kntrie_mempre:5299712},
  {pattern:"sequential",N:748182,kntrie_fnd:41.1926,kntrie_nf:23.4479,kntrie_insert:74.2694,kntrie_erase:34.9255,kntrie_iter:28.1595,kntrie_mem:4653120,umap_fnd:15.1026,umap_nf:15.1482,umap_insert:29.7519,umap_erase:22.6133,umap_iter:2.9993,umap_mem:24124760,kntrie_mempre:7995680},
  {pattern:"sequential",N:1122274,kntrie_fnd:75.8446,kntrie_nf:38.2962,kntrie_insert:132.0983,kntrie_erase:67.6266,kntrie_iter:42.8254,kntrie_mem:6980400,umap_fnd:24.2420,umap_nf:23.7724,umap_insert:50.0164,umap_erase:36.9568,umap_iter:5.0533,umap_mem:36077144,kntrie_mempre:11938912},
  {pattern:"sequential",N:1683411,kntrie_fnd:144.6200,kntrie_nf:66.4037,kntrie_insert:258.0578,kntrie_erase:130.7970,kntrie_iter:60.6621,kntrie_mem:10470080,umap_fnd:49.2793,umap_nf:44.3720,umap_insert:83.6084,umap_erase:82.2690,umap_iter:8.8954,umap_mem:53952736,kntrie_mempre:17913072},
  {pattern:"sequential",N:2525116,kntrie_fnd:219.9499,kntrie_nf:111.6334,kntrie_insert:393.0100,kntrie_erase:210.4328,kntrie_iter:78.1371,kntrie_mem:15705304,umap_fnd:72.1327,umap_nf:68.9626,umap_insert:126.9741,umap_erase:131.3392,umap_iter:12.5195,umap_mem:82332776,kntrie_mempre:26920040},
  {pattern:"sequential",N:3787675,kntrie_fnd:416.0340,kntrie_nf:247.6320,kntrie_insert:663.3997,kntrie_erase:389.1248,kntrie_iter:148.0267,kntrie_mem:23557776,umap_fnd:127.2093,umap_nf:158.2415,umap_insert:218.3489,umap_erase:337.2329,umap_iter:19.7925,umap_mem:123112448,kntrie_mempre:40368064},
  {pattern:"sequential",N:5681512,kntrie_fnd:611.7373,kntrie_nf:398.1916,kntrie_insert:1222.3163,kntrie_erase:566.5937,kntrie_iter:218.9213,kntrie_mem:35336432,umap_fnd:200.2165,umap_nf:176.6938,umap_insert:307.6601,umap_erase:342.0839,umap_iter:27.9843,umap_mem:184095064,kntrie_mempre:60588320},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "kntrie", suffix: "mempre", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie +freelist" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
