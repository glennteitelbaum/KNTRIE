<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0004,kntrie_int32_insert:0.0020,kntrie_int32_erase:0.0013,kntrie_int32_mem:4816,kntrie_uint64_find:0.0005,kntrie_uint64_insert:0.0025,kntrie_uint64_erase:0.0009,kntrie_uint64_mem:4880,map_int32_find:0.0005,map_int32_insert:0.0036,map_int32_erase:0.0019,map_int32_mem:4800,map_uint64_find:0.0005,map_uint64_insert:0.0046,map_uint64_erase:0.0037,map_uint64_mem:4800,umap_int32_find:0.0004,umap_int32_insert:0.0013,umap_int32_erase:0.0011,umap_int32_mem:3224,umap_uint64_find:0.0005,umap_uint64_insert:0.0015,umap_uint64_erase:0.0008,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0006,kntrie_int32_insert:0.0033,kntrie_int32_erase:0.0018,kntrie_int32_mem:5984,kntrie_uint64_find:0.0008,kntrie_uint64_insert:0.0037,kntrie_uint64_erase:0.0017,kntrie_uint64_mem:6208,map_int32_find:0.0010,map_int32_insert:0.0060,map_int32_erase:0.0039,map_int32_mem:7200,map_uint64_find:0.0010,map_uint64_insert:0.0076,map_uint64_erase:0.0056,map_uint64_mem:7200,umap_int32_find:0.0007,umap_int32_insert:0.0050,umap_int32_erase:0.0016,umap_int32_mem:4856,umap_uint64_find:0.0007,umap_uint64_insert:0.0042,umap_uint64_erase:0.0018,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0008,kntrie_int32_insert:0.0060,kntrie_int32_erase:0.0025,kntrie_int32_mem:7464,kntrie_uint64_find:0.0011,kntrie_uint64_insert:0.0059,kntrie_uint64_erase:0.0023,kntrie_uint64_mem:8016,map_int32_find:0.0015,map_int32_insert:0.0112,map_int32_erase:0.0057,map_int32_mem:10800,map_uint64_find:0.0015,map_uint64_insert:0.0116,map_uint64_erase:0.0060,map_uint64_mem:10800,umap_int32_find:0.0011,umap_int32_insert:0.0074,umap_int32_erase:0.0021,umap_int32_mem:7216,umap_uint64_find:0.0011,umap_uint64_insert:0.0064,umap_uint64_erase:0.0023,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0015,kntrie_int32_insert:0.0112,kntrie_int32_erase:0.0038,kntrie_int32_mem:9488,kntrie_uint64_find:0.0016,kntrie_uint64_insert:0.0102,kntrie_uint64_erase:0.0048,kntrie_uint64_mem:10448,map_int32_find:0.0025,map_int32_insert:0.0239,map_int32_erase:0.0119,map_int32_mem:16176,map_uint64_find:0.0025,map_uint64_insert:0.0254,map_uint64_erase:0.0118,map_uint64_mem:16176,umap_int32_find:0.0016,umap_int32_insert:0.0103,umap_int32_erase:0.0030,umap_int32_mem:10784,umap_uint64_find:0.0016,umap_uint64_insert:0.0101,umap_uint64_erase:0.0039,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0022,kntrie_int32_insert:0.0205,kntrie_int32_erase:0.0082,kntrie_int32_mem:12224,kntrie_uint64_find:0.0025,kntrie_uint64_insert:0.0189,kntrie_uint64_erase:0.0072,kntrie_uint64_mem:13664,map_int32_find:0.0053,map_int32_insert:0.0468,map_int32_erase:0.0200,map_int32_mem:24288,map_uint64_find:0.0059,map_uint64_insert:0.0425,map_uint64_erase:0.0207,map_uint64_mem:24288,umap_int32_find:0.0023,umap_int32_insert:0.0149,umap_int32_erase:0.0046,umap_int32_mem:16472,umap_uint64_find:0.0023,umap_uint64_insert:0.0131,umap_uint64_erase:0.0042,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0038,kntrie_int32_insert:0.0343,kntrie_int32_erase:0.0142,kntrie_int32_mem:15824,kntrie_uint64_find:0.0039,kntrie_uint64_insert:0.0327,kntrie_uint64_erase:0.0123,kntrie_uint64_mem:18160,map_int32_find:0.0099,map_int32_insert:0.0631,map_int32_erase:0.0333,map_int32_mem:36432,map_uint64_find:0.0107,map_uint64_insert:0.0668,map_uint64_erase:0.0347,map_uint64_mem:36432,umap_int32_find:0.0036,umap_int32_insert:0.0268,umap_int32_erase:0.0117,umap_int32_mem:24304,umap_uint64_find:0.0035,umap_uint64_insert:0.0214,umap_uint64_erase:0.0069,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0060,kntrie_int32_insert:0.0676,kntrie_int32_erase:0.0212,kntrie_int32_mem:20824,kntrie_uint64_find:0.0059,kntrie_uint64_insert:0.0552,kntrie_uint64_erase:0.0202,kntrie_uint64_mem:24544,map_int32_find:0.0221,map_int32_insert:0.0997,map_int32_erase:0.0512,map_int32_mem:54672,map_uint64_find:0.0218,map_uint64_insert:0.1059,map_uint64_erase:0.0599,map_uint64_mem:54672,umap_int32_find:0.0051,umap_int32_insert:0.0319,umap_int32_erase:0.0108,umap_int32_mem:36880,umap_uint64_find:0.0052,umap_uint64_insert:0.0305,umap_uint64_erase:0.0112,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0133,kntrie_int32_insert:0.0957,kntrie_int32_erase:0.0343,kntrie_int32_mem:28320,kntrie_uint64_find:0.0123,kntrie_uint64_insert:0.0918,kntrie_uint64_erase:0.0338,kntrie_uint64_mem:34384,map_int32_find:0.0385,map_int32_insert:0.1586,map_int32_erase:0.0823,map_int32_mem:81984,map_uint64_find:0.0377,map_uint64_insert:0.1723,map_uint64_erase:0.0892,map_uint64_mem:81984,umap_int32_find:0.0081,umap_int32_insert:0.0450,umap_int32_erase:0.0184,umap_int32_mem:54920,umap_uint64_find:0.0090,umap_uint64_insert:0.0471,umap_uint64_erase:0.0254,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0323,kntrie_int32_insert:0.1574,kntrie_int32_erase:0.0552,kntrie_int32_mem:39680,kntrie_uint64_find:0.0308,kntrie_uint64_insert:0.1439,kntrie_uint64_erase:0.0517,kntrie_uint64_mem:49104,map_int32_find:0.0671,map_int32_insert:0.2576,map_int32_erase:0.1350,map_int32_mem:122976,map_uint64_find:0.0671,map_uint64_insert:0.2800,map_uint64_erase:0.1403,map_uint64_mem:122976,umap_int32_find:0.0118,umap_int32_insert:0.0685,umap_int32_erase:0.0294,umap_int32_mem:83512,umap_uint64_find:0.0123,umap_uint64_insert:0.0704,umap_uint64_erase:0.0292,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0810,kntrie_int32_insert:0.2317,kntrie_int32_erase:0.0796,kntrie_int32_mem:56080,kntrie_uint64_find:0.0659,kntrie_uint64_insert:0.2281,kntrie_uint64_erase:0.0831,kntrie_uint64_mem:71840,map_int32_find:0.1094,map_int32_insert:0.4113,map_int32_erase:0.2406,map_int32_mem:184512,map_uint64_find:0.1082,map_uint64_insert:0.4332,map_uint64_erase:0.2334,map_uint64_mem:184512,umap_int32_find:0.0187,umap_int32_insert:0.1055,umap_int32_erase:0.0495,umap_int32_mem:124472,umap_uint64_find:0.0191,umap_uint64_insert:0.1082,umap_uint64_erase:0.0502,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.1082,kntrie_int32_insert:0.3557,kntrie_int32_erase:0.1356,kntrie_int32_mem:82336,kntrie_uint64_find:0.1160,kntrie_uint64_insert:0.3497,kntrie_uint64_erase:0.1277,kntrie_uint64_mem:104832,map_int32_find:0.1921,map_int32_insert:0.6664,map_int32_erase:0.3727,map_int32_mem:276768,map_uint64_find:0.2007,map_uint64_insert:0.7630,map_uint64_erase:0.3985,map_uint64_mem:276768,umap_int32_find:0.0298,umap_int32_insert:0.1606,umap_int32_erase:0.0794,umap_int32_mem:186008,umap_uint64_find:0.0300,umap_uint64_insert:0.1609,umap_uint64_erase:0.0793,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.2004,kntrie_int32_insert:0.5210,kntrie_int32_erase:0.1936,kntrie_int32_mem:118592,kntrie_uint64_find:0.2255,kntrie_uint64_insert:0.5387,kntrie_uint64_erase:0.1999,kntrie_uint64_mem:156416,map_int32_find:0.3529,map_int32_insert:1.1262,map_int32_erase:0.6130,map_int32_mem:415152,map_uint64_find:0.3448,map_uint64_insert:1.1999,map_uint64_erase:0.6398,map_uint64_mem:415152,umap_int32_find:0.0739,umap_int32_insert:0.2440,umap_int32_erase:0.1225,umap_int32_mem:277840,umap_uint64_find:0.0639,umap_uint64_insert:0.2465,umap_uint64_erase:0.1243,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.3364,kntrie_int32_insert:0.7737,kntrie_int32_erase:0.2975,kntrie_int32_mem:177984,kntrie_uint64_find:0.3618,kntrie_uint64_insert:0.7845,kntrie_uint64_erase:0.3077,kntrie_uint64_mem:228608,map_int32_find:0.6005,map_int32_insert:1.9272,map_int32_erase:1.0117,map_int32_mem:622752,map_uint64_find:0.6011,map_uint64_insert:2.0200,map_uint64_erase:1.0554,map_uint64_mem:622752,umap_int32_find:0.1666,umap_int32_insert:0.3769,umap_int32_erase:0.1823,umap_int32_mem:415240,umap_uint64_find:0.1653,umap_uint64_insert:0.3826,umap_uint64_erase:0.1889,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.5284,kntrie_int32_insert:1.1553,kntrie_int32_erase:0.4609,kntrie_int32_mem:260736,kntrie_uint64_find:0.5990,kntrie_uint64_insert:1.2169,kntrie_uint64_erase:0.4822,kntrie_uint64_mem:348928,map_int32_find:0.9842,map_int32_insert:2.9121,map_int32_erase:1.6092,map_int32_mem:934128,map_uint64_find:1.0035,map_uint64_insert:3.2550,map_uint64_erase:1.7559,map_uint64_mem:934128,umap_int32_find:0.2690,umap_int32_insert:0.5523,umap_int32_erase:0.2800,umap_int32_mem:633088,umap_uint64_find:0.2678,umap_uint64_insert:0.5607,umap_uint64_erase:0.2776,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.8476,kntrie_int32_insert:1.7191,kntrie_int32_erase:0.7355,kntrie_int32_mem:391936,kntrie_uint64_find:0.9420,kntrie_uint64_insert:1.8193,kntrie_uint64_erase:0.7898,kntrie_uint64_mem:511488,map_int32_find:1.7601,map_int32_insert:4.8669,map_int32_erase:2.7230,map_int32_mem:1401216,map_uint64_find:1.8654,map_uint64_insert:5.3624,map_uint64_erase:2.9625,map_uint64_mem:1401216,umap_int32_find:0.4489,umap_int32_insert:0.8348,umap_int32_erase:0.4389,umap_int32_mem:946424,umap_uint64_find:0.4580,umap_uint64_insert:0.8658,umap_uint64_erase:0.4420,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:1.3637,kntrie_int32_insert:2.6687,kntrie_int32_erase:1.2042,kntrie_int32_mem:594432,kntrie_uint64_find:1.5596,kntrie_uint64_insert:2.8687,kntrie_uint64_erase:1.3739,kntrie_uint64_mem:773120,map_int32_find:3.4986,map_int32_insert:9.4476,map_int32_erase:5.3248,map_int32_mem:2101872,map_uint64_find:3.3699,map_uint64_insert:10.1313,map_uint64_erase:5.7655,map_uint64_mem:2101872,umap_int32_find:0.7719,umap_int32_insert:1.3098,umap_int32_erase:0.7602,umap_int32_mem:1414784,umap_uint64_find:0.7726,umap_uint64_insert:1.3338,umap_uint64_erase:0.7694,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:2.7104,kntrie_int32_insert:4.2957,kntrie_int32_erase:2.1067,kntrie_int32_mem:856576,kntrie_uint64_find:3.0014,kntrie_uint64_insert:4.6345,kntrie_uint64_erase:2.3679,kntrie_uint64_mem:1185792,map_int32_find:6.1952,map_int32_insert:16.8797,map_int32_erase:9.4724,map_int32_mem:3152832,map_uint64_find:6.1879,map_uint64_insert:16.9619,map_uint64_erase:9.5315,map_uint64_mem:3152832,umap_int32_find:1.4057,umap_int32_insert:2.3452,umap_int32_erase:1.4764,umap_int32_mem:2114872,umap_uint64_find:1.3622,umap_uint64_insert:2.3967,umap_uint64_erase:1.4004,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:3.8579,kntrie_int32_insert:7.4748,kntrie_int32_erase:3.3614,kntrie_int32_mem:1315840,map_int32_find:12.8726,map_int32_insert:30.3578,map_int32_erase:18.2550,map_int32_mem:4729104,umap_int32_find:2.5495,umap_int32_insert:5.1265,umap_int32_erase:2.8690,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:4.2729,kntrie_uint64_insert:7.8880,kntrie_uint64_erase:3.4868,kntrie_uint64_mem:1712128,map_uint64_find:10.8281,map_uint64_insert:29.0077,map_uint64_erase:15.8686,map_uint64_mem:4729248,umap_uint64_find:2.3553,umap_uint64_insert:4.5262,umap_uint64_erase:2.5873,umap_uint64_mem:3162488},
  {pattern:"random",N:147785,kntrie_int32_find:6.4632,kntrie_int32_insert:13.1901,kntrie_int32_erase:4.8353,kntrie_int32_mem:1890304,map_int32_find:24.9579,map_int32_insert:66.5945,map_int32_erase:35.6645,map_int32_mem:7093680,umap_int32_find:4.2018,umap_int32_insert:8.7854,umap_int32_erase:4.7700,umap_int32_mem:4729184},
  {pattern:"random",N:147789,kntrie_uint64_find:7.3576,kntrie_uint64_insert:13.8044,kntrie_uint64_erase:5.1668,kntrie_uint64_mem:2623488,map_uint64_find:21.6773,map_uint64_insert:61.4624,map_uint64_erase:32.8579,map_uint64_mem:7093872,umap_uint64_find:3.7862,umap_uint64_insert:7.6017,umap_uint64_erase:4.2413,umap_uint64_mem:4729280},
  {pattern:"random",N:221675,kntrie_int32_find:10.5721,kntrie_int32_insert:21.6888,kntrie_int32_erase:7.7115,kntrie_int32_mem:2985984,map_int32_find:44.3954,map_int32_insert:122.2506,map_int32_erase:65.0307,map_int32_mem:10640400,umap_int32_find:6.6280,umap_int32_insert:15.5164,umap_int32_erase:9.1584,umap_int32_mem:7215376},
  {pattern:"random",N:221683,kntrie_uint64_find:12.4383,kntrie_uint64_insert:23.7990,kntrie_uint64_erase:8.5360,kntrie_uint64_mem:3756032,map_uint64_find:38.3808,map_uint64_insert:94.6128,map_uint64_erase:53.0003,map_uint64_mem:10640784,umap_uint64_find:6.6256,umap_uint64_insert:15.6018,umap_uint64_erase:8.0770,umap_uint64_mem:7215568},
  {pattern:"random",N:332509,kntrie_int32_find:19.2094,kntrie_int32_insert:39.7885,kntrie_int32_erase:13.3592,kntrie_int32_mem:4247552,map_int32_find:77.6005,map_int32_insert:205.1149,map_int32_erase:105.3569,map_int32_mem:15960432,umap_int32_find:10.4507,umap_int32_insert:24.3036,umap_int32_erase:12.5219,umap_int32_mem:10788704},
  {pattern:"random",N:332525,kntrie_uint64_find:23.3412,kntrie_uint64_insert:43.0119,kntrie_uint64_erase:14.7882,kntrie_uint64_mem:5982208,map_uint64_find:75.2479,map_uint64_insert:217.6465,map_uint64_erase:108.5777,map_uint64_mem:15961200,umap_uint64_find:10.7429,umap_uint64_insert:25.6756,umap_uint64_erase:13.8206,umap_uint64_mem:10789088},
  {pattern:"random",N:498753,kntrie_int32_find:31.3854,kntrie_int32_insert:62.0930,kntrie_int32_erase:21.0638,kntrie_int32_mem:6318080,map_int32_find:141.7863,map_int32_insert:367.2656,map_int32_erase:180.6576,map_int32_mem:23940144,umap_int32_find:17.4951,umap_int32_insert:42.3282,umap_int32_erase:21.5180,umap_int32_mem:16132000},
  {pattern:"random",N:498788,kntrie_uint64_find:47.6653,kntrie_uint64_insert:80.4171,kntrie_uint64_erase:28.4888,kntrie_uint64_mem:8423424,map_uint64_find:153.2656,map_uint64_insert:371.9261,map_uint64_erase:189.2685,map_uint64_mem:23941824,umap_uint64_find:16.6232,umap_uint64_insert:39.1337,umap_uint64_erase:20.4259,umap_uint64_mem:16132840},
  {pattern:"random",N:748117,kntrie_int32_find:62.6968,kntrie_int32_insert:111.5098,kntrie_int32_erase:37.3763,kntrie_int32_mem:10487808,map_int32_find:228.5183,map_int32_insert:570.1728,map_int32_erase:292.0764,map_int32_mem:35909616,umap_int32_find:24.8703,umap_int32_insert:56.5758,umap_int32_erase:28.7484,umap_int32_mem:24123200},
  {pattern:"random",N:748182,kntrie_uint64_find:85.5989,kntrie_uint64_insert:140.7166,kntrie_uint64_erase:50.9666,kntrie_uint64_mem:12584960,map_uint64_find:226.1021,map_uint64_insert:610.7998,map_uint64_erase:296.0178,map_uint64_mem:35912736,umap_uint64_find:24.7610,umap_uint64_insert:58.0068,umap_uint64_erase:29.7498,umap_uint64_mem:24124760},
  {pattern:"random",N:1122145,kntrie_int32_find:84.4582,kntrie_int32_insert:204.8539,kntrie_int32_erase:63.4530,kntrie_int32_mem:14016456,umap_int32_find:38.9594,umap_int32_insert:90.2416,umap_int32_erase:45.9607,umap_int32_mem:36074048},
  {pattern:"random",N:1122274,kntrie_uint64_find:95.4638,kntrie_uint64_insert:254.2558,kntrie_uint64_erase:70.9397,kntrie_uint64_mem:20960080,umap_uint64_find:41.4108,umap_uint64_insert:104.2255,umap_uint64_erase:50.9005,umap_uint64_mem:36077144},
  {pattern:"random",N:1683111,kntrie_int32_find:133.3987,kntrie_int32_insert:284.8844,kntrie_int32_erase:109.3137,kntrie_int32_mem:20232320,umap_int32_find:60.8620,umap_int32_insert:142.9698,umap_int32_erase:71.7158,umap_int32_mem:53945536},
  {pattern:"random",N:1683411,kntrie_uint64_find:160.5432,kntrie_uint64_insert:367.6162,kntrie_uint64_erase:132.0388,kntrie_uint64_mem:30630784,umap_uint64_find:65.4411,umap_uint64_insert:157.9049,umap_uint64_erase:81.0624,umap_uint64_mem:53952736},
  {pattern:"random",N:2524384,kntrie_int32_find:233.0099,kntrie_int32_insert:454.6237,kntrie_int32_erase:195.9638,kntrie_int32_mem:29209120,umap_int32_find:101.8213,umap_int32_insert:257.0925,umap_int32_erase:121.5451,umap_int32_mem:82315208},
  {pattern:"random",N:2525116,kntrie_uint64_find:281.4745,kntrie_uint64_insert:543.1493,kntrie_uint64_erase:228.9376,kntrie_uint64_mem:45663616,umap_uint64_find:99.9980,umap_uint64_insert:257.5125,umap_uint64_erase:124.5460,umap_uint64_mem:82332776},
  {pattern:"random",N:3786033,kntrie_int32_find:372.6001,kntrie_int32_insert:665.8686,kntrie_int32_erase:331.9684,kntrie_int32_mem:43641664,umap_int32_find:169.1170,umap_int32_insert:464.7914,umap_int32_erase:212.4437,umap_int32_mem:123073040},
  {pattern:"random",N:3787675,kntrie_uint64_find:473.9505,kntrie_uint64_insert:837.8540,kntrie_uint64_erase:393.6983,kntrie_uint64_mem:67562560,umap_uint64_find:165.0749,umap_uint64_insert:420.6409,umap_uint64_erase:217.1346,umap_uint64_mem:123112448},
  {pattern:"random",N:5677748,kntrie_int32_find:608.1695,kntrie_int32_insert:1048.1451,kntrie_int32_erase:544.1109,kntrie_int32_mem:63047680,umap_int32_find:299.6477,umap_int32_insert:846.6540,umap_int32_erase:405.7268,umap_int32_mem:184004728},
  {pattern:"random",N:5681512,kntrie_uint64_find:803.8996,kntrie_uint64_insert:1249.7746,kntrie_uint64_erase:671.2799,kntrie_uint64_mem:100474112,umap_uint64_find:296.3378,umap_uint64_insert:837.1890,umap_uint64_erase:432.5910,umap_uint64_mem:184095064},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0009,kntrie_int32_insert:0.0042,kntrie_int32_erase:0.0016,kntrie_int32_mem:3328,kntrie_uint64_find:0.0011,kntrie_uint64_insert:0.0052,kntrie_uint64_erase:0.0016,kntrie_uint64_mem:3840,map_int32_find:0.0005,map_int32_insert:0.0039,map_int32_erase:0.0022,map_int32_mem:4800,map_uint64_find:0.0005,map_uint64_insert:0.0038,map_uint64_erase:0.0024,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0012,umap_int32_erase:0.0007,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0012,umap_uint64_erase:0.0008,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0015,kntrie_int32_insert:0.0063,kntrie_int32_erase:0.0025,kntrie_int32_mem:4096,kntrie_uint64_find:0.0017,kntrie_uint64_insert:0.0071,kntrie_uint64_erase:0.0024,kntrie_uint64_mem:4608,map_int32_find:0.0009,map_int32_insert:0.0065,map_int32_erase:0.0029,map_int32_mem:7200,map_uint64_find:0.0009,map_uint64_insert:0.0058,map_uint64_erase:0.0032,map_uint64_mem:7200,umap_int32_find:0.0005,umap_int32_insert:0.0032,umap_int32_erase:0.0010,umap_int32_mem:4856,umap_uint64_find:0.0005,umap_uint64_insert:0.0033,umap_uint64_erase:0.0009,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0025,kntrie_int32_insert:0.0103,kntrie_int32_erase:0.0046,kntrie_int32_mem:5120,kntrie_uint64_find:0.0026,kntrie_uint64_insert:0.0105,kntrie_uint64_erase:0.0042,kntrie_uint64_mem:6144,map_int32_find:0.0016,map_int32_insert:0.0110,map_int32_erase:0.0050,map_int32_mem:10800,map_uint64_find:0.0017,map_uint64_insert:0.0147,map_uint64_erase:0.0072,map_uint64_mem:10800,umap_int32_find:0.0007,umap_int32_insert:0.0048,umap_int32_erase:0.0014,umap_int32_mem:7216,umap_uint64_find:0.0007,umap_uint64_insert:0.0048,umap_uint64_erase:0.0014,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0038,kntrie_int32_insert:0.0213,kntrie_int32_erase:0.0079,kntrie_int32_mem:6144,kntrie_uint64_find:0.0041,kntrie_uint64_insert:0.0198,kntrie_uint64_erase:0.0076,kntrie_uint64_mem:8192,map_int32_find:0.0028,map_int32_insert:0.0222,map_int32_erase:0.0110,map_int32_mem:16176,map_uint64_find:0.0027,map_uint64_insert:0.0235,map_uint64_erase:0.0115,map_uint64_mem:16176,umap_int32_find:0.0010,umap_int32_insert:0.0070,umap_int32_erase:0.0020,umap_int32_mem:10784,umap_uint64_find:0.0010,umap_uint64_insert:0.0070,umap_uint64_erase:0.0019,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0063,kntrie_int32_insert:0.0369,kntrie_int32_erase:0.0137,kntrie_int32_mem:8192,kntrie_uint64_find:0.0068,kntrie_uint64_insert:0.0400,kntrie_uint64_erase:0.0143,kntrie_uint64_mem:10240,map_int32_find:0.0066,map_int32_insert:0.0387,map_int32_erase:0.0213,map_int32_mem:24288,map_uint64_find:0.0065,map_uint64_insert:0.0404,map_uint64_erase:0.0214,map_uint64_mem:24288,umap_int32_find:0.0016,umap_int32_insert:0.0105,umap_int32_erase:0.0029,umap_int32_mem:16472,umap_uint64_find:0.0015,umap_uint64_insert:0.0100,umap_uint64_erase:0.0027,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0098,kntrie_int32_insert:0.0664,kntrie_int32_erase:0.0216,kntrie_int32_mem:12288,kntrie_uint64_find:0.0101,kntrie_uint64_insert:0.0633,kntrie_uint64_erase:0.0205,kntrie_uint64_mem:14336,map_int32_find:0.0117,map_int32_insert:0.0653,map_int32_erase:0.0329,map_int32_mem:36432,map_uint64_find:0.0094,map_uint64_insert:0.0667,map_uint64_erase:0.0349,map_uint64_mem:36432,umap_int32_find:0.0023,umap_int32_insert:0.0143,umap_int32_erase:0.0040,umap_int32_mem:24304,umap_uint64_find:0.0024,umap_uint64_insert:0.0175,umap_uint64_erase:0.0041,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0168,kntrie_int32_insert:0.1004,kntrie_int32_erase:0.0326,kntrie_int32_mem:16384,kntrie_uint64_find:0.0223,kntrie_uint64_insert:0.1030,kntrie_uint64_erase:0.0328,kntrie_uint64_mem:22528,map_int32_find:0.0195,map_int32_insert:0.1065,map_int32_erase:0.0562,map_int32_mem:54672,map_uint64_find:0.0212,map_uint64_insert:0.1078,map_uint64_erase:0.0557,map_uint64_mem:54672,umap_int32_find:0.0037,umap_int32_insert:0.0228,umap_int32_erase:0.0061,umap_int32_mem:36880,umap_uint64_find:0.0035,umap_uint64_insert:0.0222,umap_uint64_erase:0.0060,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0423,kntrie_int32_insert:0.1836,kntrie_int32_erase:0.0509,kntrie_int32_mem:26624,kntrie_uint64_find:0.0474,kntrie_uint64_insert:0.1711,kntrie_uint64_erase:0.0500,kntrie_uint64_mem:30720,map_int32_find:0.0389,map_int32_insert:0.1603,map_int32_erase:0.0827,map_int32_mem:81984,map_uint64_find:0.0371,map_uint64_insert:0.1784,map_uint64_erase:0.0950,map_uint64_mem:81984,umap_int32_find:0.0052,umap_int32_insert:0.0316,umap_int32_erase:0.0089,umap_int32_mem:54920,umap_uint64_find:0.0054,umap_uint64_insert:0.0386,umap_uint64_erase:0.0148,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0839,kntrie_int32_insert:0.2892,kntrie_int32_erase:0.0748,kntrie_int32_mem:34816,kntrie_uint64_find:0.0906,kntrie_uint64_insert:0.3456,kntrie_uint64_erase:0.0787,kntrie_uint64_mem:51200,map_int32_find:0.0696,map_int32_insert:0.2589,map_int32_erase:0.1437,map_int32_mem:122976,map_uint64_find:0.0702,map_uint64_insert:0.2772,map_uint64_erase:0.1443,map_uint64_mem:122976,umap_int32_find:0.0079,umap_int32_insert:0.0438,umap_int32_erase:0.0134,umap_int32_mem:83512,umap_uint64_find:0.0078,umap_uint64_insert:0.0428,umap_uint64_erase:0.0141,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.1523,kntrie_int32_insert:0.4372,kntrie_int32_erase:0.1192,kntrie_int32_mem:51200,kntrie_uint64_find:0.1568,kntrie_uint64_insert:0.4810,kntrie_uint64_erase:0.1223,kntrie_uint64_mem:67584,map_int32_find:0.1113,map_int32_insert:0.4238,map_int32_erase:0.2241,map_int32_mem:184512,map_uint64_find:0.1175,map_uint64_insert:0.4425,map_uint64_erase:0.2381,map_uint64_mem:184512,umap_int32_find:0.0118,umap_int32_insert:0.0640,umap_int32_erase:0.0197,umap_int32_mem:124472,umap_uint64_find:0.0122,umap_uint64_insert:0.0646,umap_uint64_erase:0.0206,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0388,kntrie_int32_insert:0.6432,kntrie_int32_erase:0.0958,kntrie_int32_mem:59904,kntrie_uint64_find:0.0551,kntrie_uint64_insert:0.6809,kntrie_uint64_erase:0.1074,kntrie_uint64_mem:59904,map_int32_find:0.2001,map_int32_insert:0.6919,map_int32_erase:0.3787,map_int32_mem:276768,map_uint64_find:0.2133,map_uint64_insert:0.7651,map_uint64_erase:0.4029,map_uint64_mem:276768,umap_int32_find:0.0177,umap_int32_insert:0.0952,umap_int32_erase:0.0308,umap_int32_mem:186008,umap_uint64_find:0.0192,umap_uint64_insert:0.0921,umap_uint64_erase:0.0335,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.0582,kntrie_int32_insert:0.6921,kntrie_int32_erase:0.1456,kntrie_int32_mem:88704,kntrie_uint64_find:0.0855,kntrie_uint64_insert:0.8014,kntrie_uint64_erase:0.1656,kntrie_uint64_mem:88704,map_int32_find:0.3389,map_int32_insert:1.1176,map_int32_erase:0.6253,map_int32_mem:415152,map_uint64_find:0.3659,map_uint64_insert:1.2860,map_uint64_erase:0.6403,map_uint64_mem:415152,umap_int32_find:0.0269,umap_int32_insert:0.1373,umap_int32_erase:0.0471,umap_int32_mem:277840,umap_uint64_find:0.0271,umap_uint64_insert:0.1512,umap_uint64_erase:0.0482,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.0900,kntrie_int32_insert:0.9337,kntrie_int32_erase:0.2308,kntrie_int32_mem:132096,kntrie_uint64_find:0.1389,kntrie_uint64_insert:0.9620,kntrie_uint64_erase:0.2537,kntrie_uint64_mem:132096,map_int32_find:0.5682,map_int32_insert:1.8352,map_int32_erase:1.0059,map_int32_mem:622752,map_uint64_find:0.5901,map_uint64_insert:2.0145,map_uint64_erase:1.0556,map_uint64_mem:622752,umap_int32_find:0.0399,umap_int32_insert:0.2061,umap_int32_erase:0.0710,umap_int32_mem:415240,umap_uint64_find:0.0402,umap_uint64_insert:0.2047,umap_uint64_erase:0.0723,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.1377,kntrie_int32_insert:1.1417,kntrie_int32_erase:0.3604,kntrie_int32_mem:197472,kntrie_uint64_find:0.1797,kntrie_uint64_insert:1.3303,kntrie_uint64_erase:0.4117,kntrie_uint64_mem:197472,map_int32_find:1.0004,map_int32_insert:3.0554,map_int32_erase:1.6753,map_int32_mem:934128,map_uint64_find:0.9915,map_uint64_insert:3.2717,map_uint64_erase:1.7153,map_uint64_mem:934128,umap_int32_find:0.0612,umap_int32_insert:0.3038,umap_int32_erase:0.1070,umap_int32_mem:633088,umap_uint64_find:0.0690,umap_uint64_insert:0.3192,umap_uint64_erase:0.1075,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.2139,kntrie_int32_insert:1.6276,kntrie_int32_erase:0.5615,kntrie_int32_mem:295024,kntrie_uint64_find:0.3117,kntrie_uint64_insert:1.8716,kntrie_uint64_erase:0.6541,kntrie_uint64_mem:295024,map_int32_find:1.8087,map_int32_insert:5.0022,map_int32_erase:2.7984,map_int32_mem:1401216,map_uint64_find:2.0364,map_uint64_insert:6.1714,map_uint64_erase:3.3006,map_uint64_mem:1401216,umap_int32_find:0.1044,umap_int32_insert:0.4738,umap_int32_erase:0.1634,umap_int32_mem:946424,umap_uint64_find:0.0926,umap_uint64_insert:0.4858,umap_uint64_erase:0.1665,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.3377,kntrie_int32_insert:2.2520,kntrie_int32_erase:0.8776,kntrie_int32_mem:441504,kntrie_uint64_find:0.4873,kntrie_uint64_insert:2.5353,kntrie_uint64_erase:1.0222,kntrie_uint64_mem:441504,map_int32_find:3.5429,map_int32_insert:9.4094,map_int32_erase:5.3152,map_int32_mem:2101872,map_uint64_find:3.5656,map_uint64_insert:11.2488,map_uint64_erase:6.1301,map_uint64_mem:2101872,umap_int32_find:0.2604,umap_int32_insert:0.6744,umap_int32_erase:0.2675,umap_int32_mem:1414784,umap_uint64_find:0.2700,umap_uint64_insert:0.7414,umap_uint64_erase:0.2598,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:0.7778,kntrie_int32_insert:3.8411,kntrie_int32_erase:1.6609,kntrie_int32_mem:661584,kntrie_uint64_find:1.0737,kntrie_uint64_insert:4.1977,kntrie_uint64_erase:1.8121,kntrie_uint64_mem:661584,map_int32_find:6.2164,map_int32_insert:17.2467,map_int32_erase:9.4455,map_int32_mem:3152832,map_uint64_find:6.7128,map_uint64_insert:20.5327,map_uint64_erase:9.9970,map_uint64_mem:3152832,umap_int32_find:0.5369,umap_int32_insert:1.0360,umap_int32_erase:0.4460,umap_int32_mem:2114872,umap_uint64_find:0.4797,umap_uint64_insert:1.0755,umap_uint64_erase:0.4773,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.1904,kntrie_int32_insert:5.9987,kntrie_int32_erase:2.5194,kntrie_int32_mem:991056,kntrie_uint64_find:1.8398,kntrie_uint64_insert:6.7365,kntrie_uint64_erase:2.8279,kntrie_uint64_mem:991056,map_int32_find:11.5261,map_int32_insert:30.0400,map_int32_erase:16.8021,map_int32_mem:4729248,map_uint64_find:13.3574,map_uint64_insert:36.9260,map_uint64_erase:19.9336,map_uint64_mem:4729248,umap_int32_find:0.8696,umap_int32_insert:1.6812,umap_int32_erase:0.7599,umap_int32_mem:3162488,umap_uint64_find:1.1375,umap_uint64_insert:2.2288,umap_uint64_erase:1.0895,umap_uint64_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_int32_find:1.9862,kntrie_int32_insert:9.2196,kntrie_int32_erase:3.8809,kntrie_int32_mem:1485776,kntrie_uint64_find:2.4835,kntrie_uint64_insert:10.1896,kntrie_uint64_erase:4.0796,kntrie_uint64_mem:1485776,map_int32_find:19.5110,map_int32_insert:51.7741,map_int32_erase:28.9257,map_int32_mem:7093872,map_uint64_find:25.0978,map_uint64_insert:71.9794,map_uint64_erase:37.1905,map_uint64_mem:7093872,umap_int32_find:1.5360,umap_int32_insert:3.1598,umap_int32_erase:1.5009,umap_int32_mem:4729280,umap_uint64_find:1.7170,umap_uint64_insert:4.2300,umap_uint64_erase:1.7544,umap_uint64_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_int32_find:3.7761,kntrie_int32_insert:14.0807,kntrie_int32_erase:6.1637,kntrie_int32_mem:2227168,kntrie_uint64_find:5.5187,kntrie_uint64_insert:16.0462,kntrie_uint64_erase:7.1496,kntrie_uint64_mem:2227168,map_int32_find:40.7144,map_int32_insert:106.7071,map_int32_erase:58.5486,map_int32_mem:10640784,map_uint64_find:46.3711,map_uint64_insert:129.2317,map_uint64_erase:65.3583,map_uint64_mem:10640784,umap_int32_find:3.3113,umap_int32_insert:6.8261,umap_int32_erase:3.1699,umap_int32_mem:7215568,umap_uint64_find:3.0256,umap_uint64_insert:7.4175,umap_uint64_erase:3.0184,umap_uint64_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_int32_find:8.6584,kntrie_int32_insert:24.4065,kntrie_int32_erase:11.4276,kntrie_int32_mem:3340112,kntrie_uint64_find:10.7535,kntrie_uint64_insert:27.2025,kntrie_uint64_erase:13.0889,kntrie_uint64_mem:3340112,map_int32_find:74.8583,map_int32_insert:195.7376,map_int32_erase:106.1680,map_int32_mem:15961200,map_uint64_find:80.7231,map_uint64_insert:213.2075,map_uint64_erase:111.5431,map_uint64_mem:15961200,umap_int32_find:5.3016,umap_int32_insert:10.7246,umap_int32_erase:4.9831,umap_int32_mem:10789088,umap_uint64_find:5.1728,umap_uint64_insert:11.5659,umap_uint64_erase:5.1881,umap_uint64_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_int32_find:14.5272,kntrie_int32_insert:40.3604,kntrie_int32_erase:21.1017,kntrie_int32_mem:5009408,kntrie_uint64_find:17.7848,kntrie_uint64_insert:46.2551,kntrie_uint64_erase:24.5285,kntrie_uint64_mem:5009408,map_int32_find:136.7166,map_int32_insert:353.7958,map_int32_erase:182.7986,map_int32_mem:23941824,map_uint64_find:131.9699,map_uint64_insert:371.7274,map_uint64_erase:185.2856,map_uint64_mem:23941824,umap_int32_find:8.6537,umap_int32_insert:22.2929,umap_int32_erase:7.0605,umap_int32_mem:16132840,umap_uint64_find:8.8310,umap_uint64_insert:19.8604,umap_uint64_erase:8.5282,umap_uint64_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_int32_find:21.3735,kntrie_int32_insert:66.1550,kntrie_int32_erase:37.0420,kntrie_int32_mem:7512992,kntrie_uint64_find:30.0518,kntrie_uint64_insert:84.2279,kntrie_uint64_erase:43.4340,kntrie_uint64_mem:7512992,map_int32_find:231.7389,map_int32_insert:591.3659,map_int32_erase:298.8316,map_int32_mem:35912736,map_uint64_find:249.6207,map_uint64_insert:676.9797,map_uint64_erase:339.9021,map_uint64_mem:35912736,umap_int32_find:12.3793,umap_int32_insert:25.3748,umap_int32_erase:11.1637,umap_int32_mem:24124760,umap_uint64_find:12.9390,umap_uint64_insert:29.2763,umap_uint64_erase:12.5169,umap_uint64_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_int32_find:35.2683,kntrie_int32_insert:119.7174,kntrie_int32_erase:66.6378,kntrie_int32_mem:11268640,kntrie_uint64_find:50.1274,kntrie_uint64_insert:131.9872,kntrie_uint64_erase:73.3955,kntrie_uint64_mem:11268640,umap_int32_find:19.1841,umap_int32_insert:41.0358,umap_int32_erase:17.0516,umap_int32_mem:36077144,umap_uint64_find:25.1716,umap_uint64_insert:55.1051,umap_uint64_erase:23.2577,umap_uint64_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_int32_find:58.4023,kntrie_int32_insert:196.1667,kntrie_int32_erase:115.1923,kntrie_int32_mem:16901696,kntrie_uint64_find:99.1316,kntrie_uint64_insert:251.5551,kntrie_uint64_erase:146.8093,kntrie_uint64_mem:16901696,umap_int32_find:31.1838,umap_int32_insert:63.5591,umap_int32_erase:27.8438,umap_int32_mem:53952736,umap_uint64_find:37.0205,umap_uint64_insert:88.7191,umap_uint64_erase:37.8946,umap_uint64_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_int32_find:109.5370,kntrie_int32_insert:339.2402,kntrie_int32_erase:195.2800,kntrie_int32_mem:25352064,kntrie_uint64_find:146.5691,kntrie_uint64_insert:404.9125,kntrie_uint64_erase:218.6630,kntrie_uint64_mem:25352064,umap_int32_find:48.4279,umap_int32_insert:98.5656,umap_int32_erase:42.5978,umap_int32_mem:82332776,umap_uint64_find:62.3712,umap_uint64_insert:135.1356,umap_uint64_erase:50.2831,umap_uint64_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_int32_find:183.8330,kntrie_int32_insert:560.1127,kntrie_int32_erase:324.2869,kntrie_int32_mem:38027136,kntrie_uint64_find:270.2251,kntrie_uint64_insert:734.6670,kntrie_uint64_erase:407.4258,kntrie_uint64_mem:38027136,umap_int32_find:97.4075,umap_int32_insert:166.6418,umap_int32_erase:67.5764,umap_int32_mem:123112448,umap_uint64_find:103.3115,umap_uint64_insert:169.0824,umap_uint64_erase:73.1008,umap_uint64_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_int32_find:325.9512,kntrie_int32_insert:943.3457,kntrie_int32_erase:555.9410,kntrie_int32_mem:57039488,kntrie_uint64_find:388.6973,kntrie_uint64_insert:1025.9957,kntrie_uint64_erase:617.2156,kntrie_uint64_mem:57039488,umap_int32_find:166.5242,umap_int32_insert:251.2621,umap_int32_erase:125.7626,umap_int32_mem:184095064,umap_uint64_find:165.6360,umap_uint64_insert:289.8784,umap_uint64_erase:126.9443,umap_uint64_mem:184095064},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
