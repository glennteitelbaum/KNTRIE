<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark</h2>
  <p class="sub">Log-log · Per-entry · Lower is better · Solid = i32, Dashed = u64</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_int32_find:0.0008,kntrie_int32_insert:0.0057,kntrie_int32_erase:0.0023,kntrie_int32_mem:1560,kntrie_uint64_find:0.0008,kntrie_uint64_insert:0.0054,kntrie_uint64_erase:0.0031,kntrie_uint64_mem:2072,map_int32_find:0.0012,map_int32_insert:0.0089,map_int32_erase:0.0049,map_int32_mem:4800,map_uint64_find:0.0013,map_uint64_insert:0.0078,map_uint64_erase:0.0054,map_uint64_mem:4800,umap_int32_find:0.0010,umap_int32_insert:0.0020,umap_int32_erase:0.0017,umap_int32_mem:3224,umap_uint64_find:0.0011,umap_uint64_insert:0.0024,umap_uint64_erase:0.0018,umap_uint64_mem:3224},
  {pattern:"random",N:150,kntrie_int32_find:0.0013,kntrie_int32_insert:0.0083,kntrie_int32_erase:0.0032,kntrie_int32_mem:3096,kntrie_uint64_find:0.0013,kntrie_uint64_insert:0.0092,kntrie_uint64_erase:0.0037,kntrie_uint64_mem:4120,map_int32_find:0.0022,map_int32_insert:0.0119,map_int32_erase:0.0071,map_int32_mem:7200,map_uint64_find:0.0023,map_uint64_insert:0.0117,map_uint64_erase:0.0079,map_uint64_mem:7200,umap_int32_find:0.0018,umap_int32_insert:0.0061,umap_int32_erase:0.0026,umap_int32_mem:4856,umap_uint64_find:0.0016,umap_uint64_insert:0.0048,umap_uint64_erase:0.0026,umap_uint64_mem:4856},
  {pattern:"random",N:225,kntrie_int32_find:0.0021,kntrie_int32_insert:0.0148,kntrie_int32_erase:0.0050,kntrie_int32_mem:3096,kntrie_uint64_find:0.0019,kntrie_uint64_insert:0.0128,kntrie_uint64_erase:0.0048,kntrie_uint64_mem:4120,map_int32_find:0.0039,map_int32_insert:0.0199,map_int32_erase:0.0107,map_int32_mem:10800,map_uint64_find:0.0038,map_uint64_insert:0.0173,map_uint64_erase:0.0105,map_uint64_mem:10800,umap_int32_find:0.0030,umap_int32_insert:0.0083,umap_int32_erase:0.0032,umap_int32_mem:7216,umap_uint64_find:0.0027,umap_uint64_insert:0.0065,umap_uint64_erase:0.0032,umap_uint64_mem:7216},
  {pattern:"random",N:337,kntrie_int32_find:0.0032,kntrie_int32_insert:0.0183,kntrie_int32_erase:0.0069,kntrie_int32_mem:6168,kntrie_uint64_find:0.0031,kntrie_uint64_insert:0.0189,kntrie_uint64_erase:0.0066,kntrie_uint64_mem:8216,map_int32_find:0.0056,map_int32_insert:0.0279,map_int32_erase:0.0157,map_int32_mem:16176,map_uint64_find:0.0060,map_uint64_insert:0.0272,map_uint64_erase:0.0159,map_uint64_mem:16176,umap_int32_find:0.0039,umap_int32_insert:0.0105,umap_int32_erase:0.0042,umap_int32_mem:10784,umap_uint64_find:0.0036,umap_uint64_insert:0.0093,umap_uint64_erase:0.0042,umap_uint64_mem:10784},
  {pattern:"random",N:506,kntrie_int32_find:0.0050,kntrie_int32_insert:0.0309,kntrie_int32_erase:0.0101,kntrie_int32_mem:6168,kntrie_uint64_find:0.0047,kntrie_uint64_insert:0.0315,kntrie_uint64_erase:0.0104,kntrie_uint64_mem:8216,map_int32_find:0.0091,map_int32_insert:0.0430,map_int32_erase:0.0232,map_int32_mem:24288,map_uint64_find:0.0095,map_uint64_insert:0.0424,map_uint64_erase:0.0248,map_uint64_mem:24288,umap_int32_find:0.0052,umap_int32_insert:0.0141,umap_int32_erase:0.0062,umap_int32_mem:16472,umap_uint64_find:0.0052,umap_uint64_insert:0.0135,umap_uint64_erase:0.0064,umap_uint64_mem:16472},
  {pattern:"random",N:759,kntrie_int32_find:0.0120,kntrie_int32_insert:0.0738,kntrie_int32_erase:0.0291,kntrie_int32_mem:17360,kntrie_uint64_find:0.0120,kntrie_uint64_insert:0.0731,kntrie_uint64_erase:0.0303,kntrie_uint64_mem:20824,map_int32_find:0.0156,map_int32_insert:0.0683,map_int32_erase:0.0375,map_int32_mem:36432,map_uint64_find:0.0159,map_uint64_insert:0.0658,map_uint64_erase:0.0363,map_uint64_mem:36432,umap_int32_find:0.0085,umap_int32_insert:0.0216,umap_int32_erase:0.0097,umap_int32_mem:24304,umap_uint64_find:0.0084,umap_uint64_insert:0.0199,umap_uint64_erase:0.0097,umap_uint64_mem:24304},
  {pattern:"random",N:1139,kntrie_int32_find:0.0167,kntrie_int32_insert:0.0969,kntrie_int32_erase:0.0394,kntrie_int32_mem:24512,kntrie_uint64_find:0.0173,kntrie_uint64_insert:0.0886,kntrie_uint64_erase:0.0402,kntrie_uint64_mem:30424,map_int32_find:0.0254,map_int32_insert:0.1032,map_int32_erase:0.0548,map_int32_mem:54672,map_uint64_find:0.0256,map_uint64_insert:0.0988,map_uint64_erase:0.0568,map_uint64_mem:54672,umap_int32_find:0.0119,umap_int32_insert:0.0290,umap_int32_erase:0.0135,umap_int32_mem:36880,umap_uint64_find:0.0124,umap_uint64_insert:0.0291,umap_uint64_erase:0.0135,umap_uint64_mem:36880},
  {pattern:"random",N:1708,kntrie_int32_find:0.0263,kntrie_int32_insert:0.1349,kntrie_int32_erase:0.0491,kntrie_int32_mem:34680,kntrie_uint64_find:0.0260,kntrie_uint64_insert:0.1187,kntrie_uint64_erase:0.0530,kntrie_uint64_mem:44248,map_int32_find:0.0426,map_int32_insert:0.1652,map_int32_erase:0.0914,map_int32_mem:81984,map_uint64_find:0.0428,map_uint64_insert:0.1554,map_uint64_erase:0.0876,map_uint64_mem:81984,umap_int32_find:0.0214,umap_int32_insert:0.0458,umap_int32_erase:0.0218,umap_int32_mem:54920,umap_uint64_find:0.0203,umap_uint64_insert:0.0430,umap_uint64_erase:0.0214,umap_uint64_mem:54920},
  {pattern:"random",N:2562,kntrie_int32_find:0.0333,kntrie_int32_insert:0.1768,kntrie_int32_erase:0.0676,kntrie_int32_mem:48496,kntrie_uint64_find:0.0354,kntrie_uint64_insert:0.1742,kntrie_uint64_erase:0.0750,kntrie_uint64_mem:63768,map_int32_find:0.0662,map_int32_insert:0.2627,map_int32_erase:0.1392,map_int32_mem:122976,map_uint64_find:0.0710,map_uint64_insert:0.2511,map_uint64_erase:0.1431,map_uint64_mem:122976,umap_int32_find:0.0306,umap_int32_insert:0.0641,umap_int32_erase:0.0317,umap_int32_mem:83512,umap_uint64_find:0.0308,umap_uint64_insert:0.0622,umap_uint64_erase:0.0328,umap_uint64_mem:83512},
  {pattern:"random",N:3844,kntrie_int32_find:0.0625,kntrie_int32_insert:0.2443,kntrie_int32_erase:0.0891,kntrie_int32_mem:70456,kntrie_uint64_find:0.0622,kntrie_uint64_insert:0.2410,kntrie_uint64_erase:0.0977,kntrie_uint64_mem:92824,map_int32_find:0.1126,map_int32_insert:0.4194,map_int32_erase:0.2232,map_int32_mem:184512,map_uint64_find:0.1144,map_uint64_insert:0.4028,map_uint64_erase:0.2213,map_uint64_mem:184512,umap_int32_find:0.0505,umap_int32_insert:0.1071,umap_int32_erase:0.0532,umap_int32_mem:124472,umap_uint64_find:0.0498,umap_uint64_insert:0.0990,umap_uint64_erase:0.0520,umap_uint64_mem:124472},
  {pattern:"random",N:5766,kntrie_int32_find:0.0713,kntrie_int32_insert:0.3443,kntrie_int32_erase:0.1319,kntrie_int32_mem:102616,kntrie_uint64_find:0.0760,kntrie_uint64_insert:0.3493,kntrie_uint64_erase:0.1452,kntrie_uint64_mem:133656,map_int32_find:0.1837,map_int32_insert:0.6747,map_int32_erase:0.3545,map_int32_mem:276768,map_uint64_find:0.1882,map_uint64_insert:0.6751,map_uint64_erase:0.3683,map_uint64_mem:276768,umap_int32_find:0.0743,umap_int32_insert:0.1414,umap_int32_erase:0.0773,umap_int32_mem:186008,umap_uint64_find:0.0786,umap_uint64_insert:0.1526,umap_uint64_erase:0.0794,umap_uint64_mem:186008},
  {pattern:"random",N:8649,kntrie_int32_find:0.1484,kntrie_int32_insert:0.5465,kntrie_int32_erase:0.1901,kntrie_int32_mem:160024,kntrie_uint64_find:0.1528,kntrie_uint64_insert:0.5541,kntrie_uint64_erase:0.2065,kntrie_uint64_mem:216600,map_int32_find:0.3148,map_int32_insert:1.1247,map_int32_erase:0.6008,map_int32_mem:415152,map_uint64_find:0.3200,map_uint64_insert:1.1153,map_uint64_erase:0.5859,map_uint64_mem:415152,umap_int32_find:0.1189,umap_int32_insert:0.2266,umap_int32_erase:0.1214,umap_int32_mem:277840,umap_uint64_find:0.1187,umap_uint64_insert:0.2270,umap_uint64_erase:0.1238,umap_uint64_mem:277840},
  {pattern:"random",N:12974,kntrie_int32_find:0.1766,kntrie_int32_insert:0.7875,kntrie_int32_erase:0.2859,kntrie_int32_mem:209944,kntrie_uint64_find:0.1889,kntrie_uint64_insert:0.7596,kntrie_uint64_erase:0.3117,kntrie_uint64_mem:277016,map_int32_find:0.5605,map_int32_insert:1.7886,map_int32_erase:1.0132,map_int32_mem:622752,map_uint64_find:0.5875,map_uint64_insert:1.7532,map_uint64_erase:0.9566,map_uint64_mem:622752,umap_int32_find:0.1853,umap_int32_insert:0.3346,umap_int32_erase:0.1845,umap_int32_mem:415240,umap_uint64_find:0.1851,umap_uint64_insert:0.3400,umap_uint64_erase:0.1893,umap_uint64_mem:415240},
  {pattern:"random",N:19461,kntrie_int32_find:0.3182,kntrie_int32_insert:1.1838,kntrie_int32_erase:0.4203,kntrie_int32_mem:382744,kntrie_uint64_find:0.3352,kntrie_uint64_insert:1.2038,kntrie_uint64_erase:0.4561,kntrie_uint64_mem:505880,map_int32_find:0.8598,map_int32_insert:2.8690,map_int32_erase:1.5612,map_int32_mem:934128,map_uint64_find:0.8909,map_uint64_insert:2.7420,map_uint64_erase:1.5952,map_uint64_mem:934128,umap_int32_find:0.2729,umap_int32_insert:0.4959,umap_int32_erase:0.2804,umap_int32_mem:633088,umap_uint64_find:0.2780,umap_uint64_insert:0.4989,umap_uint64_erase:0.2811,umap_uint64_mem:633088},
  {pattern:"random",N:29192,kntrie_int32_find:0.4860,kntrie_int32_insert:1.8255,kntrie_int32_erase:0.6198,kntrie_int32_mem:446488,kntrie_uint64_find:0.5125,kntrie_uint64_insert:1.8996,kntrie_uint64_erase:0.6750,kntrie_uint64_mem:570392,map_int32_find:1.5766,map_int32_insert:4.5188,map_int32_erase:2.7130,map_int32_mem:1401216,map_uint64_find:1.6583,map_uint64_insert:5.1564,map_uint64_erase:2.8448,map_uint64_mem:1401216,umap_int32_find:0.4146,umap_int32_insert:0.7443,umap_int32_erase:0.4222,umap_int32_mem:946424,umap_uint64_find:0.4389,umap_uint64_insert:0.8009,umap_uint64_erase:0.4780,umap_uint64_mem:946424},
  {pattern:"random",N:43789,kntrie_int32_find:0.8370,kntrie_int32_insert:2.8312,kntrie_int32_erase:1.0453,kntrie_int32_mem:793624,kntrie_uint64_find:0.8772,kntrie_uint64_insert:2.9122,kntrie_uint64_erase:1.1244,kntrie_uint64_mem:1055768,map_int32_find:2.9339,map_int32_insert:7.8391,map_int32_erase:5.1175,map_int32_mem:2101872,map_uint64_find:3.0480,map_uint64_insert:8.8869,map_uint64_erase:4.8981,map_uint64_mem:2101872,umap_int32_find:0.7311,umap_int32_insert:1.2843,umap_int32_erase:0.7594,umap_int32_mem:1414784,umap_uint64_find:0.7137,umap_uint64_insert:1.2431,umap_uint64_erase:0.8046,umap_uint64_mem:1414784},
  {pattern:"random",N:65684,kntrie_int32_find:1.6417,kntrie_int32_insert:4.8420,kntrie_int32_erase:1.4505,kntrie_int32_mem:1165336,kntrie_uint64_find:1.8539,kntrie_uint64_insert:5.0629,kntrie_uint64_erase:1.6660,kntrie_uint64_mem:1575960,map_int32_find:6.0668,map_int32_insert:14.8147,map_int32_erase:9.3039,map_int32_mem:3152832,map_uint64_find:5.9402,map_uint64_insert:16.7333,map_uint64_erase:9.4107,map_uint64_mem:3152832,umap_int32_find:1.3371,umap_int32_insert:2.4000,umap_int32_erase:1.7838,umap_int32_mem:2114872,umap_uint64_find:1.2859,umap_uint64_insert:2.2904,umap_uint64_erase:1.5800,umap_uint64_mem:2114872},
  {pattern:"random",N:98523,kntrie_int32_find:2.4306,kntrie_int32_insert:7.0903,kntrie_int32_erase:2.5837,kntrie_int32_mem:1580056,map_int32_find:9.9565,map_int32_insert:25.3178,map_int32_erase:15.8179,map_int32_mem:4729104,umap_int32_find:2.1883,umap_int32_insert:4.1111,umap_int32_erase:2.8827,umap_int32_mem:3162416},
  {pattern:"random",N:98526,kntrie_uint64_find:3.7299,kntrie_uint64_insert:7.7272,kntrie_uint64_erase:3.4836,kntrie_uint64_mem:2104344,map_uint64_find:10.3988,map_uint64_insert:30.1902,map_uint64_erase:16.8666,map_uint64_mem:4729248,umap_uint64_find:2.2999,umap_uint64_insert:4.4961,umap_uint64_erase:3.4396,umap_uint64_mem:3162488},
  {pattern:"random",N:147785,kntrie_int32_find:6.9284,kntrie_int32_insert:17.8038,kntrie_int32_erase:9.2564,kntrie_int32_mem:3368536,map_int32_find:22.7667,map_int32_insert:51.0993,map_int32_erase:34.1684,map_int32_mem:7093680,umap_int32_find:3.7690,umap_int32_insert:8.4161,umap_int32_erase:5.4702,umap_int32_mem:4729184},
  {pattern:"random",N:147789,kntrie_uint64_find:7.6045,kntrie_uint64_insert:20.3932,kntrie_uint64_erase:10.8068,kntrie_uint64_mem:4240488,map_uint64_find:20.8688,map_uint64_insert:54.8122,map_uint64_erase:31.7275,map_uint64_mem:7093872,umap_uint64_find:3.7221,umap_uint64_insert:9.2568,umap_uint64_erase:5.1452,umap_uint64_mem:4729280},
  {pattern:"random",N:221675,kntrie_int32_find:11.6697,kntrie_int32_insert:25.9780,kntrie_int32_erase:14.3980,kntrie_int32_mem:4465848,map_int32_find:38.6025,map_int32_insert:85.2060,map_int32_erase:58.0878,map_int32_mem:10640400,umap_int32_find:6.1183,umap_int32_insert:14.3351,umap_int32_erase:9.4478,umap_int32_mem:7215376},
  {pattern:"random",N:221683,kntrie_uint64_find:12.9845,kntrie_uint64_insert:31.3107,kntrie_uint64_erase:16.8130,kntrie_uint64_mem:6003688,map_uint64_find:42.7970,map_uint64_insert:102.9736,map_uint64_erase:61.9533,map_uint64_mem:10640784,umap_uint64_find:6.0773,umap_uint64_insert:14.3222,umap_uint64_erase:9.5090,umap_uint64_mem:7215568},
  {pattern:"random",N:332509,kntrie_int32_find:17.9606,kntrie_int32_insert:39.2606,kntrie_int32_erase:20.8322,kntrie_int32_mem:6196712,map_int32_find:67.5852,map_int32_insert:148.8638,map_int32_erase:98.6229,map_int32_mem:15960432,umap_int32_find:9.4404,umap_int32_insert:23.5029,umap_int32_erase:15.0266,umap_int32_mem:10788704},
  {pattern:"random",N:332525,kntrie_uint64_find:23.1946,kntrie_uint64_insert:41.8087,kntrie_uint64_erase:26.8381,kntrie_uint64_mem:8739656,map_uint64_find:64.5484,map_uint64_insert:163.1613,map_uint64_erase:91.3431,map_uint64_mem:15961200,umap_uint64_find:9.6052,umap_uint64_insert:23.3256,umap_uint64_erase:14.6205,umap_uint64_mem:10789088},
  {pattern:"random",N:498753,kntrie_int32_find:33.5873,kntrie_int32_insert:59.8471,kntrie_int32_erase:36.9392,kntrie_int32_mem:8603248,map_int32_find:124.2189,map_int32_insert:284.9615,map_int32_erase:167.9453,map_int32_mem:23940144,umap_int32_find:14.9622,umap_int32_insert:35.7559,umap_int32_erase:22.3852,umap_int32_mem:16132000},
  {pattern:"random",N:498788,kntrie_uint64_find:37.5660,kntrie_uint64_insert:62.7651,kntrie_uint64_erase:39.7511,kntrie_uint64_mem:12687096,map_uint64_find:113.2958,map_uint64_insert:298.4301,map_uint64_erase:164.9895,map_uint64_mem:23941824,umap_uint64_find:15.2551,umap_uint64_insert:36.6457,umap_uint64_erase:23.0773,umap_uint64_mem:16132840},
  {pattern:"random",N:748117,kntrie_int32_find:50.7616,kntrie_int32_insert:91.2078,kntrie_int32_erase:50.3957,kntrie_int32_mem:12038208,map_int32_find:187.7441,map_int32_insert:417.5990,map_int32_erase:274.9990,map_int32_mem:35909616,umap_int32_find:24.0196,umap_int32_insert:60.4463,umap_int32_erase:37.3073,umap_int32_mem:24123200},
  {pattern:"random",N:748182,kntrie_uint64_find:54.5787,kntrie_uint64_insert:102.5323,kntrie_uint64_erase:56.4471,kntrie_uint64_mem:18133144,map_uint64_find:199.3555,map_uint64_insert:519.4914,map_uint64_erase:281.9366,map_uint64_mem:35912736,umap_uint64_find:23.7043,umap_uint64_insert:57.8704,umap_uint64_erase:35.5533,umap_uint64_mem:24124760},
  {pattern:"random",N:1122145,kntrie_int32_find:102.2479,kntrie_int32_insert:166.0565,kntrie_int32_erase:84.2620,kntrie_int32_mem:17970520,umap_int32_find:39.6198,umap_int32_insert:102.6537,umap_int32_erase:65.1349,umap_int32_mem:36074048},
  {pattern:"random",N:1122274,kntrie_uint64_find:104.1644,kntrie_uint64_insert:171.8661,kntrie_uint64_erase:83.5730,kntrie_uint64_mem:27670296,umap_uint64_find:37.9438,umap_uint64_insert:107.8840,umap_uint64_erase:60.5696,umap_uint64_mem:36077144},
  {pattern:"random",N:1683111,kntrie_int32_find:139.3114,kntrie_int32_insert:225.6803,kntrie_int32_erase:114.5875,kntrie_int32_mem:24467080,umap_int32_find:63.4458,umap_int32_insert:168.6918,umap_int32_erase:107.6525,umap_int32_mem:53945536},
  {pattern:"random",N:1683411,kntrie_uint64_find:167.0767,kntrie_uint64_insert:275.1430,kntrie_uint64_erase:134.6840,kntrie_uint64_mem:38038552,umap_uint64_find:59.9105,umap_uint64_insert:149.9374,umap_uint64_erase:91.1538,umap_uint64_mem:53952736},
  {pattern:"random",N:2524384,kntrie_int32_find:269.8834,kntrie_int32_insert:416.5111,kntrie_int32_erase:199.9850,kntrie_int32_mem:40317400,umap_int32_find:93.9248,umap_int32_insert:235.0818,umap_int32_erase:160.0557,umap_int32_mem:82315208},
  {pattern:"random",N:2525116,kntrie_uint64_find:284.0303,kntrie_uint64_insert:442.8546,kntrie_uint64_erase:226.5511,kntrie_uint64_mem:63405336,umap_uint64_find:95.5304,umap_uint64_insert:241.7662,umap_uint64_erase:157.2937,umap_uint64_mem:82332776},
  {pattern:"random",N:3786033,kntrie_int32_find:381.3554,kntrie_int32_insert:607.1851,kntrie_int32_erase:290.9431,kntrie_int32_mem:51616280,umap_int32_find:149.0410,umap_int32_insert:367.5376,umap_int32_erase:249.0759,umap_int32_mem:123073040},
  {pattern:"random",N:3787675,kntrie_uint64_find:479.3761,kntrie_uint64_insert:839.7235,kntrie_uint64_erase:365.5777,kntrie_uint64_mem:81562648,umap_uint64_find:154.4373,umap_uint64_insert:348.5740,umap_uint64_erase:227.3309,umap_uint64_mem:123112448},
  {pattern:"random",N:5677748,kntrie_int32_find:705.1716,kntrie_int32_insert:1033.3876,kntrie_int32_erase:520.5024,kntrie_int32_mem:85417240,umap_int32_find:269.9763,umap_int32_insert:639.8092,umap_int32_erase:408.5363,umap_int32_mem:184004728},
  {pattern:"random",N:5681512,kntrie_uint64_find:805.9149,kntrie_uint64_insert:1361.7353,kntrie_uint64_erase:693.2713,kntrie_uint64_mem:135633944,umap_uint64_find:274.2009,umap_uint64_insert:631.2999,umap_uint64_erase:408.3324,umap_uint64_mem:184095064},
  {pattern:"sequential",N:100,kntrie_int32_find:0.0009,kntrie_int32_insert:0.0082,kntrie_int32_erase:0.0030,kntrie_int32_mem:1560,kntrie_uint64_find:0.0007,kntrie_uint64_insert:0.0065,kntrie_uint64_erase:0.0033,kntrie_uint64_mem:2072,map_int32_find:0.0012,map_int32_insert:0.0072,map_int32_erase:0.0043,map_int32_mem:4800,map_uint64_find:0.0012,map_uint64_insert:0.0083,map_uint64_erase:0.0057,map_uint64_mem:4800,umap_int32_find:0.0003,umap_int32_insert:0.0011,umap_int32_erase:0.0006,umap_int32_mem:3224,umap_uint64_find:0.0003,umap_uint64_insert:0.0011,umap_uint64_erase:0.0007,umap_uint64_mem:3224},
  {pattern:"sequential",N:150,kntrie_int32_find:0.0013,kntrie_int32_insert:0.0085,kntrie_int32_erase:0.0033,kntrie_int32_mem:3096,kntrie_uint64_find:0.0012,kntrie_uint64_insert:0.0098,kntrie_uint64_erase:0.0050,kntrie_uint64_mem:4120,map_int32_find:0.0021,map_int32_insert:0.0116,map_int32_erase:0.0066,map_int32_mem:7200,map_uint64_find:0.0022,map_uint64_insert:0.0117,map_uint64_erase:0.0076,map_uint64_mem:7200,umap_int32_find:0.0004,umap_int32_insert:0.0035,umap_int32_erase:0.0012,umap_int32_mem:4856,umap_uint64_find:0.0004,umap_uint64_insert:0.0035,umap_uint64_erase:0.0021,umap_uint64_mem:4856},
  {pattern:"sequential",N:225,kntrie_int32_find:0.0019,kntrie_int32_insert:0.0129,kntrie_int32_erase:0.0040,kntrie_int32_mem:3096,kntrie_uint64_find:0.0019,kntrie_uint64_insert:0.0128,kntrie_uint64_erase:0.0040,kntrie_uint64_mem:4120,map_int32_find:0.0032,map_int32_insert:0.0169,map_int32_erase:0.0094,map_int32_mem:10800,map_uint64_find:0.0036,map_uint64_insert:0.0169,map_uint64_erase:0.0097,map_uint64_mem:10800,umap_int32_find:0.0006,umap_int32_insert:0.0043,umap_int32_erase:0.0011,umap_int32_mem:7216,umap_uint64_find:0.0006,umap_uint64_insert:0.0045,umap_uint64_erase:0.0017,umap_uint64_mem:7216},
  {pattern:"sequential",N:337,kntrie_int32_find:0.0031,kntrie_int32_insert:0.0180,kntrie_int32_erase:0.0066,kntrie_int32_mem:6168,kntrie_uint64_find:0.0031,kntrie_uint64_insert:0.0194,kntrie_uint64_erase:0.0073,kntrie_uint64_mem:8216,map_int32_find:0.0057,map_int32_insert:0.0269,map_int32_erase:0.0146,map_int32_mem:16176,map_uint64_find:0.0060,map_uint64_insert:0.0269,map_uint64_erase:0.0151,map_uint64_mem:16176,umap_int32_find:0.0009,umap_int32_insert:0.0065,umap_int32_erase:0.0018,umap_int32_mem:10784,umap_uint64_find:0.0010,umap_uint64_insert:0.0067,umap_uint64_erase:0.0021,umap_uint64_mem:10784},
  {pattern:"sequential",N:506,kntrie_int32_find:0.0047,kntrie_int32_insert:0.0304,kntrie_int32_erase:0.0090,kntrie_int32_mem:6168,kntrie_uint64_find:0.0047,kntrie_uint64_insert:0.0334,kntrie_uint64_erase:0.0110,kntrie_uint64_mem:8216,map_int32_find:0.0092,map_int32_insert:0.0418,map_int32_erase:0.0231,map_int32_mem:24288,map_uint64_find:0.0093,map_uint64_insert:0.0403,map_uint64_erase:0.0240,map_uint64_mem:24288,umap_int32_find:0.0014,umap_int32_insert:0.0102,umap_int32_erase:0.0028,umap_int32_mem:16472,umap_uint64_find:0.0014,umap_uint64_insert:0.0096,umap_uint64_erase:0.0039,umap_uint64_mem:16472},
  {pattern:"sequential",N:759,kntrie_int32_find:0.0086,kntrie_int32_insert:0.0487,kntrie_int32_erase:0.0174,kntrie_int32_mem:10264,kntrie_uint64_find:0.0099,kntrie_uint64_insert:0.0506,kntrie_uint64_erase:0.0189,kntrie_uint64_mem:10264,map_int32_find:0.0153,map_int32_insert:0.0649,map_int32_erase:0.0351,map_int32_mem:36432,map_uint64_find:0.0159,map_uint64_insert:0.0628,map_uint64_erase:0.0368,map_uint64_mem:36432,umap_int32_find:0.0021,umap_int32_insert:0.0135,umap_int32_erase:0.0039,umap_int32_mem:24304,umap_uint64_find:0.0022,umap_uint64_insert:0.0137,umap_uint64_erase:0.0051,umap_uint64_mem:24304},
  {pattern:"sequential",N:1139,kntrie_int32_find:0.0139,kntrie_int32_insert:0.0811,kntrie_int32_erase:0.0188,kntrie_int32_mem:20504,kntrie_uint64_find:0.0174,kntrie_uint64_insert:0.0907,kntrie_uint64_erase:0.0230,kntrie_uint64_mem:20504,map_int32_find:0.0250,map_int32_insert:0.1026,map_int32_erase:0.0543,map_int32_mem:54672,map_uint64_find:0.0269,map_uint64_insert:0.1029,map_uint64_erase:0.0562,map_uint64_mem:54672,umap_int32_find:0.0032,umap_int32_insert:0.0190,umap_int32_erase:0.0057,umap_int32_mem:36880,umap_uint64_find:0.0033,umap_uint64_insert:0.0199,umap_uint64_erase:0.0058,umap_uint64_mem:36880},
  {pattern:"sequential",N:1708,kntrie_int32_find:0.0206,kntrie_int32_insert:0.1027,kntrie_int32_erase:0.0338,kntrie_int32_mem:20504,kntrie_uint64_find:0.0245,kntrie_uint64_insert:0.1117,kntrie_uint64_erase:0.0367,kntrie_uint64_mem:20504,map_int32_find:0.0427,map_int32_insert:0.1583,map_int32_erase:0.0861,map_int32_mem:81984,map_uint64_find:0.0439,map_uint64_insert:0.1621,map_uint64_erase:0.0888,map_uint64_mem:81984,umap_int32_find:0.0047,umap_int32_insert:0.0274,umap_int32_erase:0.0092,umap_int32_mem:54920,umap_uint64_find:0.0049,umap_uint64_insert:0.0286,umap_uint64_erase:0.0093,umap_uint64_mem:54920},
  {pattern:"sequential",N:2562,kntrie_int32_find:0.0347,kntrie_int32_insert:0.1705,kntrie_int32_erase:0.0479,kntrie_int32_mem:40984,kntrie_uint64_find:0.0404,kntrie_uint64_insert:0.1791,kntrie_uint64_erase:0.0527,kntrie_uint64_mem:40984,map_int32_find:0.0684,map_int32_insert:0.2893,map_int32_erase:0.1614,map_int32_mem:122976,map_uint64_find:0.0712,map_uint64_insert:0.2745,map_uint64_erase:0.1436,map_uint64_mem:122976,umap_int32_find:0.0072,umap_int32_insert:0.0391,umap_int32_erase:0.0151,umap_int32_mem:83512,umap_uint64_find:0.0073,umap_uint64_insert:0.0393,umap_uint64_erase:0.0147,umap_uint64_mem:83512},
  {pattern:"sequential",N:3844,kntrie_int32_find:0.0528,kntrie_int32_insert:0.2578,kntrie_int32_erase:0.0726,kntrie_int32_mem:40984,kntrie_uint64_find:0.0605,kntrie_uint64_insert:0.2778,kntrie_uint64_erase:0.0813,kntrie_uint64_mem:40984,map_int32_find:0.1182,map_int32_insert:0.4245,map_int32_erase:0.2214,map_int32_mem:184512,map_uint64_find:0.1216,map_uint64_insert:0.4196,map_uint64_erase:0.2280,map_uint64_mem:184512,umap_int32_find:0.0110,umap_int32_insert:0.0569,umap_int32_erase:0.0228,umap_int32_mem:124472,umap_uint64_find:0.0111,umap_uint64_insert:0.0591,umap_uint64_erase:0.0244,umap_uint64_mem:124472},
  {pattern:"sequential",N:5766,kntrie_int32_find:0.0366,kntrie_int32_insert:0.4230,kntrie_int32_erase:0.0849,kntrie_int32_mem:69752,kntrie_uint64_find:0.0456,kntrie_uint64_insert:0.4429,kntrie_uint64_erase:0.0929,kntrie_uint64_mem:69752,map_int32_find:0.1941,map_int32_insert:0.7032,map_int32_erase:0.3704,map_int32_mem:276768,map_uint64_find:0.1922,map_uint64_insert:0.6525,map_uint64_erase:0.3569,map_uint64_mem:276768,umap_int32_find:0.0163,umap_int32_insert:0.0836,umap_int32_erase:0.0359,umap_int32_mem:186008,umap_uint64_find:0.0164,umap_uint64_insert:0.0841,umap_uint64_erase:0.0364,umap_uint64_mem:186008},
  {pattern:"sequential",N:8649,kntrie_int32_find:0.0554,kntrie_int32_insert:0.5213,kntrie_int32_erase:0.1300,kntrie_int32_mem:104360,kntrie_uint64_find:0.0694,kntrie_uint64_insert:0.5229,kntrie_uint64_erase:0.1470,kntrie_uint64_mem:104360,map_int32_find:0.3149,map_int32_insert:1.1208,map_int32_erase:0.5781,map_int32_mem:415152,map_uint64_find:0.3162,map_uint64_insert:1.0805,map_uint64_erase:0.5815,map_uint64_mem:415152,umap_int32_find:0.0248,umap_int32_insert:0.1240,umap_int32_erase:0.0541,umap_int32_mem:277840,umap_uint64_find:0.0249,umap_uint64_insert:0.1274,umap_uint64_erase:0.0596,umap_uint64_mem:277840},
  {pattern:"sequential",N:12974,kntrie_int32_find:0.0822,kntrie_int32_insert:0.6691,kntrie_int32_erase:0.1953,kntrie_int32_mem:156472,kntrie_uint64_find:0.1038,kntrie_uint64_insert:0.7063,kntrie_uint64_erase:0.2222,kntrie_uint64_mem:156472,map_int32_find:0.5261,map_int32_insert:1.7831,map_int32_erase:0.9468,map_int32_mem:622752,map_uint64_find:0.5331,map_uint64_insert:1.7383,map_uint64_erase:0.9616,map_uint64_mem:622752,umap_int32_find:0.0361,umap_int32_insert:0.1794,umap_int32_erase:0.0828,umap_int32_mem:415240,umap_uint64_find:0.0371,umap_uint64_insert:0.1863,umap_uint64_erase:0.0856,umap_uint64_mem:415240},
  {pattern:"sequential",N:19461,kntrie_int32_find:0.1293,kntrie_int32_insert:0.9329,kntrie_int32_erase:0.3060,kntrie_int32_mem:235576,kntrie_uint64_find:0.1630,kntrie_uint64_insert:0.9852,kntrie_uint64_erase:0.3485,kntrie_uint64_mem:235576,map_int32_find:0.8885,map_int32_insert:2.8606,map_int32_erase:1.5203,map_int32_mem:934128,map_uint64_find:0.8879,map_uint64_insert:2.8067,map_uint64_erase:1.5247,map_uint64_mem:934128,umap_int32_find:0.0545,umap_int32_insert:0.2988,umap_int32_erase:0.1249,umap_int32_mem:633088,umap_uint64_find:0.0565,umap_uint64_insert:0.2746,umap_uint64_erase:0.1315,umap_uint64_mem:633088},
  {pattern:"sequential",N:29192,kntrie_int32_find:0.2000,kntrie_int32_insert:1.3137,kntrie_int32_erase:0.4822,kntrie_int32_mem:353176,kntrie_uint64_find:0.2475,kntrie_uint64_insert:1.3274,kntrie_uint64_erase:0.5416,kntrie_uint64_mem:353176,map_int32_find:1.6750,map_int32_insert:4.7854,map_int32_erase:2.8767,map_int32_mem:1401216,map_uint64_find:1.7594,map_uint64_insert:4.5671,map_uint64_erase:2.8644,map_uint64_mem:1401216,umap_int32_find:0.0927,umap_int32_insert:0.4260,umap_int32_erase:0.2153,umap_int32_mem:946424,umap_uint64_find:0.0884,umap_uint64_insert:0.3969,umap_uint64_erase:0.2042,umap_uint64_mem:946424},
  {pattern:"sequential",N:43789,kntrie_int32_find:0.3490,kntrie_int32_insert:1.9634,kntrie_int32_erase:0.8526,kntrie_int32_mem:529816,kntrie_uint64_find:0.4075,kntrie_uint64_insert:2.0253,kntrie_uint64_erase:0.8659,kntrie_uint64_mem:529816,map_int32_find:3.2022,map_int32_insert:8.4551,map_int32_erase:5.3430,map_int32_mem:2101872,map_uint64_find:3.1238,map_uint64_insert:8.0600,map_uint64_erase:5.2081,map_uint64_mem:2101872,umap_int32_find:0.2168,umap_int32_insert:0.6538,umap_int32_erase:0.4741,umap_int32_mem:1414784,umap_uint64_find:0.2012,umap_uint64_insert:0.6218,umap_uint64_erase:0.4028,umap_uint64_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_int32_find:0.7086,kntrie_int32_insert:3.2164,kntrie_int32_erase:1.4280,kntrie_int32_mem:796296,kntrie_uint64_find:0.8518,kntrie_uint64_insert:3.4484,kntrie_uint64_erase:1.5706,kntrie_uint64_mem:796296,map_int32_find:5.7073,map_int32_insert:14.4517,map_int32_erase:8.9138,map_int32_mem:3152832,map_uint64_find:5.6284,map_uint64_insert:13.5825,map_uint64_erase:8.7095,map_uint64_mem:3152832,umap_int32_find:0.5103,umap_int32_insert:1.0070,umap_int32_erase:1.1891,umap_int32_mem:2114872,umap_uint64_find:0.4683,umap_uint64_insert:1.0092,umap_uint64_erase:1.1159,umap_uint64_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_int32_find:1.1214,kntrie_int32_insert:5.1095,kntrie_int32_erase:2.1974,kntrie_int32_mem:1192584,kntrie_uint64_find:1.3214,kntrie_uint64_insert:5.3452,kntrie_uint64_erase:2.3698,kntrie_uint64_mem:1192584,map_int32_find:10.5468,map_int32_insert:25.7290,map_int32_erase:16.3226,map_int32_mem:4729248,map_uint64_find:11.5377,map_uint64_insert:27.4144,map_uint64_erase:17.6278,map_uint64_mem:4729248,umap_int32_find:0.8932,umap_int32_insert:1.6659,umap_int32_erase:1.9939,umap_int32_mem:3162488,umap_uint64_find:1.0163,umap_uint64_insert:1.6121,umap_uint64_erase:2.3587,umap_uint64_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_int32_find:1.8183,kntrie_int32_insert:7.6904,kntrie_int32_erase:3.3558,kntrie_int32_mem:1789624,kntrie_uint64_find:2.2737,kntrie_uint64_insert:8.1663,kntrie_uint64_erase:3.6758,kntrie_uint64_mem:1789624,map_int32_find:19.5251,map_int32_insert:44.7852,map_int32_erase:30.0409,map_int32_mem:7093872,map_uint64_find:22.6070,map_uint64_insert:47.4339,map_uint64_erase:34.0142,map_uint64_mem:7093872,umap_int32_find:1.4640,umap_int32_insert:3.0276,umap_int32_erase:3.4495,umap_int32_mem:4729280,umap_uint64_find:1.6833,umap_uint64_insert:3.5496,umap_uint64_erase:3.1830,umap_uint64_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_int32_find:3.8435,kntrie_int32_insert:12.3898,kntrie_int32_erase:5.6210,kntrie_int32_mem:2683560,kntrie_uint64_find:4.9514,kntrie_uint64_insert:13.2514,kntrie_uint64_erase:6.1525,kntrie_uint64_mem:2683560,map_int32_find:37.5721,map_int32_insert:84.3316,map_int32_erase:57.9993,map_int32_mem:10640784,map_uint64_find:37.5738,map_uint64_insert:80.9913,map_uint64_erase:53.2079,map_uint64_mem:10640784,umap_int32_find:2.5979,umap_int32_insert:5.9891,umap_int32_erase:5.8467,umap_int32_mem:7215568,umap_uint64_find:2.4520,umap_uint64_insert:5.8897,umap_uint64_erase:5.8396,umap_uint64_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_int32_find:7.1785,kntrie_int32_insert:19.6447,kntrie_int32_erase:9.7413,kntrie_int32_mem:4026040,kntrie_uint64_find:9.1789,kntrie_uint64_insert:21.3739,kntrie_uint64_erase:11.5444,kntrie_uint64_mem:4026040,map_int32_find:64.8862,map_int32_insert:144.2385,map_int32_erase:105.7915,map_int32_mem:15961200,map_uint64_find:77.2967,map_uint64_insert:157.2822,map_uint64_erase:100.2689,map_uint64_mem:15961200,umap_int32_find:4.3116,umap_int32_insert:9.8414,umap_int32_erase:9.9297,umap_int32_mem:10789088,umap_uint64_find:4.9164,umap_uint64_insert:11.4603,umap_uint64_erase:11.4121,umap_uint64_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_int32_find:12.4386,kntrie_int32_insert:33.6200,kntrie_int32_erase:19.7933,kntrie_int32_mem:6039752,kntrie_uint64_find:14.2010,kntrie_uint64_insert:36.9944,kntrie_uint64_erase:21.5966,kntrie_uint64_mem:6039752,map_int32_find:118.2884,map_int32_insert:268.5537,map_int32_erase:168.6770,map_int32_mem:23941824,map_uint64_find:117.0985,map_uint64_insert:261.7656,map_uint64_erase:169.7342,map_uint64_mem:23941824,umap_int32_find:6.8947,umap_int32_insert:15.4405,umap_int32_erase:15.8282,umap_int32_mem:16132840,umap_uint64_find:7.1767,umap_uint64_insert:16.4199,umap_uint64_erase:18.1359,umap_uint64_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_int32_find:21.4713,kntrie_int32_insert:60.1058,kntrie_int32_erase:40.7515,kntrie_int32_mem:9059896,kntrie_uint64_find:25.7431,kntrie_uint64_insert:71.1756,kntrie_uint64_erase:47.0150,kntrie_uint64_mem:9059896,map_int32_find:203.7467,map_int32_insert:457.1385,map_int32_erase:288.8783,map_int32_mem:35912736,map_uint64_find:186.6848,map_uint64_insert:423.5979,map_uint64_erase:268.6814,map_uint64_mem:35912736,umap_int32_find:11.4093,umap_int32_insert:25.7811,umap_int32_erase:26.1420,umap_int32_mem:24124760,umap_uint64_find:10.6610,umap_uint64_insert:24.1260,umap_uint64_erase:25.7154,umap_uint64_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_int32_find:34.9198,kntrie_int32_insert:111.7181,kntrie_int32_erase:75.5204,kntrie_int32_mem:13589864,kntrie_uint64_find:40.1541,kntrie_uint64_insert:115.7077,kntrie_uint64_erase:77.6150,kntrie_uint64_mem:13589864,umap_int32_find:17.4388,umap_int32_insert:40.6630,umap_int32_erase:41.7382,umap_int32_mem:36077144,umap_uint64_find:17.4968,umap_uint64_insert:40.5718,umap_uint64_erase:42.5254,umap_uint64_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_int32_find:62.3709,kntrie_int32_insert:197.9769,kntrie_int32_erase:129.6343,kntrie_int32_mem:20384808,kntrie_uint64_find:66.9402,kntrie_uint64_insert:198.1640,kntrie_uint64_erase:126.2894,kntrie_uint64_mem:20384808,umap_int32_find:29.0166,umap_int32_insert:65.6294,umap_int32_erase:64.9172,umap_int32_mem:53952736,umap_uint64_find:29.1363,umap_uint64_insert:64.3073,umap_uint64_erase:65.9825,umap_uint64_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_int32_find:115.4402,kntrie_int32_insert:331.1044,kntrie_int32_erase:212.6505,kntrie_int32_mem:30577800,kntrie_uint64_find:136.8535,kntrie_uint64_insert:348.7350,kntrie_uint64_erase:229.2643,kntrie_uint64_mem:30577800,umap_int32_find:45.4250,umap_int32_insert:96.2873,umap_int32_erase:101.4848,umap_int32_mem:82332776,umap_uint64_find:48.4734,umap_uint64_insert:102.2758,umap_uint64_erase:107.9418,umap_uint64_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_int32_find:204.6711,kntrie_int32_insert:592.5661,kntrie_int32_erase:379.7081,kntrie_int32_mem:45867368,kntrie_uint64_find:241.2595,kntrie_uint64_insert:604.4517,kntrie_uint64_erase:396.5468,kntrie_uint64_mem:45867368,umap_int32_find:83.5356,umap_int32_insert:165.3923,umap_int32_erase:170.5091,umap_int32_mem:123112448,umap_uint64_find:83.1507,umap_uint64_insert:169.7688,umap_uint64_erase:168.1923,umap_uint64_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_int32_find:320.8482,kntrie_int32_insert:941.8071,kntrie_int32_erase:602.6236,kntrie_int32_mem:68800920,kntrie_uint64_find:382.4266,kntrie_uint64_insert:1001.1864,kntrie_uint64_erase:622.1258,kntrie_uint64_mem:68800920,umap_int32_find:140.5595,umap_int32_insert:284.6078,umap_int32_erase:266.4046,umap_int32_mem:184095064,umap_uint64_find:142.3184,umap_uint64_insert:284.5773,umap_uint64_erase:275.5001,umap_uint64_mem:184095064},
];


const LINES = [
  { key: "kntrie_int32", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie i32" },
  { key: "kntrie_uint64", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie u64" },
  { key: "map_int32", color: "#ef4444", dash: [], width: 2.5, label: "map i32" },
  { key: "map_uint64", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map u64" },
  { key: "umap_int32", color: "#22c55e", dash: [], width: 2.5, label: "umap i32" },
  { key: "umap_uint64", color: "#86efac", dash: [6,3], width: 1.5, label: "umap u64" },
];

const MEM_LINES = [
  ...LINES,
  { key: "raw_int32", color: "#888", dash: [], width: 1, label: "raw i32" },
  { key: "raw_uint64", color: "#555", dash: [3,3], width: 1, label: "raw u64" },
];

const METRICS = [
  { id: "find", suffix: "find", convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", suffix: "insert", convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase", suffix: "erase", convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem", suffix: "mem", convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of lines) {
        if (l.key === "raw_int32") { pt[l.key] = 12; continue; }
        if (l.key === "raw_uint64") { pt[l.key] = 16; continue; }
        const raw = r[l.key + "_" + metric.suffix];
        if (raw != null) pt[l.key] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const lines = metric.id === "mem" ? MEM_LINES : LINES;
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const lines = m.id === "mem" ? MEM_LINES : LINES;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
