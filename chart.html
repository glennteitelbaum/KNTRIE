random N=100...
random N=150...
random N=225...
random N=337...
random N=506...
random N=759...
random N=1139...
random N=1708...
random N=2562...
random N=3844...
random N=5766...
random N=8649...
random N=12974...
random N=19461...
random N=29192...
random N=43789...
random N=65684...
random N=98526...
random N=147789...
random N=221683...
random N=332525...
random N=498788...
random N=748182...
random N=1122274...
random N=1683411...
random N=2525116...
random N=3787675...
random N=5681512...
sequential N=100...
sequential N=150...
sequential N=225...
sequential N=337...
sequential N=506...
sequential N=759...
sequential N=1139...
sequential N=1708...
sequential N=2562...
sequential N=3844...
sequential N=5766...
sequential N=8649...
sequential N=12974...
sequential N=19461...
sequential N=29192...
sequential N=43789...
sequential N=65684...
sequential N=98526...
sequential N=147789...
sequential N=221683...
sequential N=332525...
sequential N=498788...
sequential N=748182...
sequential N=1122274...
sequential N=1683411...
sequential N=2525116...
sequential N=3787675...
sequential N=5681512...
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64 &rarr; i32)</h2>
  <p class="sub">Log-log &middot; Per-entry &middot; Lower is better &middot; FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0008,kntrie_nf:0.0007,kntrie_insert:0.0093,kntrie_erase:0.0056,kntrie_iter:0.0028,kntrie_mem:1544,map_fnd:0.0033,map_nf:0.0023,map_insert:0.0112,map_erase:0.0054,map_iter:0.0011,map_mem:4800,umap_fnd:0.0012,umap_nf:0.0018,umap_insert:0.0039,umap_erase:0.0022,umap_iter:0.0002,umap_mem:3224},
  {pattern:"random",N:150,kntrie_fnd:0.0013,kntrie_nf:0.0011,kntrie_insert:0.0145,kntrie_erase:0.0059,kntrie_iter:0.0043,kntrie_mem:3080,map_fnd:0.0054,map_nf:0.0043,map_insert:0.0163,map_erase:0.0087,map_iter:0.0019,map_mem:7200,umap_fnd:0.0017,umap_nf:0.0021,umap_insert:0.0062,umap_erase:0.0029,umap_iter:0.0003,umap_mem:4856},
  {pattern:"random",N:225,kntrie_fnd:0.0019,kntrie_nf:0.0016,kntrie_insert:0.0176,kntrie_erase:0.0071,kntrie_iter:0.0060,kntrie_mem:3080,map_fnd:0.0089,map_nf:0.0072,map_insert:0.0238,map_erase:0.0118,map_iter:0.0024,map_mem:10800,umap_fnd:0.0029,umap_nf:0.0039,umap_insert:0.0085,umap_erase:0.0039,umap_iter:0.0004,umap_mem:7216},
  {pattern:"random",N:337,kntrie_fnd:0.0031,kntrie_nf:0.0027,kntrie_insert:0.0255,kntrie_erase:0.0093,kntrie_iter:0.0094,kntrie_mem:6152,map_fnd:0.0142,map_nf:0.0126,map_insert:0.0354,map_erase:0.0171,map_iter:0.0032,map_mem:16176,umap_fnd:0.0040,umap_nf:0.0063,umap_insert:0.0117,umap_erase:0.0051,umap_iter:0.0005,umap_mem:10784},
  {pattern:"random",N:506,kntrie_fnd:0.0046,kntrie_nf:0.0041,kntrie_insert:0.0377,kntrie_erase:0.0135,kntrie_iter:0.0137,kntrie_mem:6152,map_fnd:0.0237,map_nf:0.0195,map_insert:0.0528,map_erase:0.0266,map_iter:0.0051,map_mem:24288,umap_fnd:0.0057,umap_nf:0.0087,umap_insert:0.0167,umap_erase:0.0073,umap_iter:0.0008,umap_mem:16472},
  {pattern:"random",N:759,kntrie_fnd:0.0077,kntrie_nf:0.0068,kntrie_insert:0.0659,kntrie_erase:0.0213,kntrie_iter:0.0221,kntrie_mem:12296,map_fnd:0.0389,map_nf:0.0322,map_insert:0.0816,map_erase:0.0408,map_iter:0.0075,map_mem:36432,umap_fnd:0.0092,umap_nf:0.0141,umap_insert:0.0244,umap_erase:0.0116,umap_iter:0.0012,umap_mem:24304},
  {pattern:"random",N:1139,kntrie_fnd:0.0124,kntrie_nf:0.0111,kntrie_insert:0.0869,kntrie_erase:0.0232,kntrie_iter:0.0354,kntrie_mem:24584,map_fnd:0.0657,map_nf:0.0591,map_insert:0.1229,map_erase:0.0629,map_iter:0.0113,map_mem:54672,umap_fnd:0.0135,umap_nf:0.0201,umap_insert:0.0336,umap_erase:0.0162,umap_iter:0.0022,umap_mem:36880},
  {pattern:"random",N:1708,kntrie_fnd:0.0190,kntrie_nf:0.0169,kntrie_insert:0.1219,kntrie_erase:0.0385,kntrie_iter:0.0525,kntrie_mem:24584,map_fnd:0.1087,map_nf:0.0966,map_insert:0.1863,map_erase:0.0952,map_iter:0.0180,map_mem:81984,umap_fnd:0.0220,umap_nf:0.0328,umap_insert:0.0497,umap_erase:0.0253,umap_iter:0.0043,umap_mem:54920},
  {pattern:"random",N:2562,kntrie_fnd:0.0317,kntrie_nf:0.0275,kntrie_insert:0.1965,kntrie_erase:0.0586,kntrie_iter:0.0849,kntrie_mem:49160,map_fnd:0.1808,map_nf:0.1671,map_insert:0.2904,map_erase:0.1559,map_iter:0.0276,map_mem:122976,umap_fnd:0.0328,umap_nf:0.0489,umap_insert:0.0731,umap_erase:0.0378,umap_iter:0.0073,umap_mem:83512},
  {pattern:"random",N:3844,kntrie_fnd:0.0472,kntrie_nf:0.0412,kntrie_insert:0.2872,kntrie_erase:0.0886,kntrie_iter:0.1272,kntrie_mem:49160,map_fnd:0.2969,map_nf:0.2809,map_insert:0.4538,map_erase:0.2490,map_iter:0.0428,map_mem:184512,umap_fnd:0.0527,umap_nf:0.0745,umap_insert:0.1137,umap_erase:0.0602,umap_iter:0.0133,umap_mem:124472},
  {pattern:"random",N:5766,kntrie_fnd:0.0686,kntrie_nf:0.0596,kntrie_insert:0.5417,kntrie_erase:0.1921,kntrie_iter:0.1869,kntrie_mem:100192,map_fnd:0.4938,map_nf:0.4725,map_insert:0.7454,map_erase:0.4011,map_iter:0.0678,map_mem:276768,umap_fnd:0.0838,umap_nf:0.1204,umap_insert:0.1710,umap_erase:0.0916,umap_iter:0.0206,umap_mem:186008},
  {pattern:"random",N:8649,kntrie_fnd:0.1359,kntrie_nf:0.1304,kntrie_insert:0.7445,kntrie_erase:0.2610,kntrie_iter:0.2923,kntrie_mem:162192,map_fnd:0.8225,map_nf:0.7907,map_insert:1.1543,map_erase:0.6309,map_iter:0.1061,map_mem:415152,umap_fnd:0.1311,umap_nf:0.1811,umap_insert:0.2616,umap_erase:0.1454,umap_iter:0.0331,umap_mem:277840},
  {pattern:"random",N:12974,kntrie_fnd:0.1740,kntrie_nf:0.1496,kntrie_insert:1.1991,kntrie_erase:0.4044,kntrie_iter:0.4465,kntrie_mem:207504,map_fnd:1.3868,map_nf:1.3365,map_insert:1.9259,map_erase:1.0376,map_iter:0.1843,map_mem:622752,umap_fnd:0.2006,umap_nf:0.2858,umap_insert:0.4185,umap_erase:0.2239,umap_iter:0.0524,umap_mem:415240},
  {pattern:"random",N:19461,kntrie_fnd:0.3119,kntrie_nf:0.2738,kntrie_insert:1.5442,kntrie_erase:0.5962,kntrie_iter:0.7139,kntrie_mem:379152,map_fnd:2.3965,map_nf:2.2170,map_insert:2.9819,map_erase:1.6617,map_iter:0.3709,map_mem:934128,umap_fnd:0.3023,umap_nf:0.4256,umap_insert:0.5994,umap_erase:0.3617,umap_iter:0.0833,umap_mem:633088},
  {pattern:"random",N:29192,kntrie_fnd:0.4825,kntrie_nf:0.4111,kntrie_insert:2.3314,kntrie_erase:0.8831,kntrie_iter:1.0738,kntrie_mem:427536,map_fnd:4.1427,map_nf:3.9923,map_insert:4.8690,map_erase:2.9760,map_iter:0.6868,map_mem:1401216,umap_fnd:0.4943,umap_nf:0.6748,umap_insert:0.9431,umap_erase:0.6011,umap_iter:0.1361,umap_mem:946424},
  {pattern:"random",N:43789,kntrie_fnd:0.8507,kntrie_nf:0.6859,kntrie_insert:3.5259,kntrie_erase:1.4368,kntrie_iter:1.7168,kntrie_mem:791568,map_fnd:7.4885,map_nf:6.9662,map_insert:8.1081,map_erase:4.8266,map_iter:1.2598,map_mem:2101872,umap_fnd:0.8203,umap_nf:1.1084,umap_insert:1.5262,umap_erase:1.0052,umap_iter:0.2504,umap_mem:1414784},
  {pattern:"random",N:65684,kntrie_fnd:1.7523,kntrie_nf:1.4108,kntrie_insert:6.1372,kntrie_erase:2.2114,kntrie_iter:2.6867,kntrie_mem:1181712,map_fnd:12.4120,map_nf:11.7623,map_insert:13.0817,map_erase:8.2452,map_iter:2.0219,map_mem:3152832,umap_fnd:1.3232,umap_nf:1.7752,umap_insert:2.5454,umap_erase:1.6340,umap_iter:0.4154,umap_mem:2114872},
  {pattern:"random",N:98526,kntrie_fnd:2.7641,kntrie_nf:1.9416,kntrie_insert:8.7125,kntrie_erase:3.7567,kntrie_iter:4.0914,kntrie_mem:1578000,map_fnd:20.4022,map_nf:20.1259,map_insert:21.6064,map_erase:13.3980,map_iter:3.4494,map_mem:4729248,umap_fnd:2.0778,umap_nf:2.7520,umap_insert:4.0623,umap_erase:2.6472,umap_iter:0.7634,umap_mem:3162488},
  {pattern:"random",N:147789,kntrie_fnd:6.3056,kntrie_nf:4.4404,kntrie_insert:15.2699,kntrie_erase:6.0630,kntrie_iter:6.5085,kntrie_mem:3138576,map_fnd:39.0017,map_nf:39.0587,map_insert:39.6220,map_erase:24.6225,map_iter:6.7577,map_mem:7093872,umap_fnd:3.2457,umap_nf:4.2692,umap_insert:6.6121,umap_erase:4.1568,umap_iter:1.3130,umap_mem:4729280},
  {pattern:"random",N:221683,kntrie_fnd:8.9240,kntrie_nf:6.5236,kntrie_insert:23.3655,kntrie_erase:10.6296,kntrie_iter:9.6085,kntrie_mem:3150864,map_fnd:73.3094,map_nf:65.8564,map_insert:67.3999,map_erase:40.9762,map_iter:13.8930,map_mem:10640784,umap_fnd:5.3295,umap_nf:6.5865,umap_insert:10.2037,umap_erase:6.8969,umap_iter:2.1308,umap_mem:7215568},
  {pattern:"random",N:332525,kntrie_fnd:19.1756,kntrie_nf:14.1599,kntrie_insert:43.2279,kntrie_erase:20.0844,kntrie_iter:15.4445,kntrie_mem:6296592,map_fnd:135.0529,map_nf:131.8932,map_insert:113.2415,map_erase:80.6709,map_iter:19.8469,map_mem:15961200,umap_fnd:9.4936,umap_nf:10.7859,umap_insert:18.1465,umap_erase:12.3268,umap_iter:3.9887,umap_mem:10789088},
  {pattern:"random",N:498788,kntrie_fnd:27.4350,kntrie_nf:21.4739,kntrie_insert:73.1576,kntrie_erase:30.1104,kntrie_iter:22.7806,kntrie_mem:6394896,map_fnd:327.9589,map_nf:321.4816,map_insert:237.8447,map_erase:177.2773,map_iter:61.0200,map_mem:23941824,umap_fnd:16.6949,umap_nf:18.2275,umap_insert:32.8213,umap_erase:22.2736,umap_iter:7.9367,umap_mem:16132840},
  {pattern:"random",N:748182,kntrie_fnd:69.8583,kntrie_nf:45.2175,kntrie_insert:140.5734,kntrie_erase:68.2044,kntrie_iter:36.7943,kntrie_mem:12588048,map_fnd:586.8197,map_nf:517.5689,map_insert:429.4738,map_erase:283.6226,map_iter:109.1486,map_mem:35912736,umap_fnd:30.2738,umap_nf:32.4093,umap_insert:57.3670,umap_erase:41.0294,umap_iter:16.1121,umap_mem:24124760},
  {pattern:"random",N:1122274,kntrie_fnd:81.5374,kntrie_nf:60.4003,kntrie_insert:308.3798,kntrie_erase:112.8641,kntrie_iter:46.8477,kntrie_mem:20952504,umap_fnd:53.4689,umap_nf:56.0244,umap_insert:106.5496,umap_erase:83.6358,umap_iter:28.4791,umap_mem:36077144},
  {pattern:"random",N:1683411,kntrie_fnd:138.0557,kntrie_nf:94.2934,kntrie_insert:448.3351,kntrie_erase:247.8727,kntrie_iter:77.7264,kntrie_mem:28480560,umap_fnd:97.5647,umap_nf:97.9004,umap_insert:209.0342,umap_erase:140.0318,umap_iter:60.4907,umap_mem:53952736},
  {pattern:"random",N:2525116,kntrie_fnd:387.8264,kntrie_nf:263.9304,kntrie_insert:765.6981,kntrie_erase:440.7250,kntrie_iter:127.2604,kntrie_mem:47490264,umap_fnd:166.0241,umap_nf:171.8540,umap_insert:345.8661,umap_erase:269.8290,umap_iter:109.0147,umap_mem:82332776},
  {pattern:"random",N:3787675,kntrie_fnd:588.8620,kntrie_nf:467.4907,kntrie_insert:1284.6739,kntrie_erase:889.1994,kntrie_iter:186.5608,kntrie_mem:61108240,umap_fnd:259.2596,umap_nf:256.6904,umap_insert:584.4676,umap_erase:414.4313,umap_iter:170.1419,umap_mem:123112448},
  {pattern:"random",N:5681512,kntrie_fnd:1297.2948,kntrie_nf:1028.4029,kntrie_insert:2309.7590,kntrie_erase:1570.0563,kntrie_iter:296.3954,kntrie_mem:101661712,umap_fnd:436.3040,umap_nf:427.9310,umap_insert:1034.6465,umap_erase:690.0561,umap_iter:294.0180,umap_mem:184095064},
  {pattern:"sequential",N:100,kntrie_fnd:0.0007,kntrie_nf:0.0006,kntrie_insert:0.0136,kntrie_erase:0.0053,kntrie_iter:0.0027,kntrie_mem:1544,map_fnd:0.0033,map_nf:0.0032,map_insert:0.0099,map_erase:0.0063,map_iter:0.0012,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0006,umap_insert:0.0030,umap_erase:0.0013,umap_iter:0.0002,umap_mem:3224},
  {pattern:"sequential",N:150,kntrie_fnd:0.0013,kntrie_nf:0.0011,kntrie_insert:0.0136,kntrie_erase:0.0070,kntrie_iter:0.0040,kntrie_mem:3080,map_fnd:0.0055,map_nf:0.0053,map_insert:0.0184,map_erase:0.0089,map_iter:0.0019,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0010,umap_insert:0.0046,umap_erase:0.0022,umap_iter:0.0003,umap_mem:4856},
  {pattern:"sequential",N:225,kntrie_fnd:0.0019,kntrie_nf:0.0017,kntrie_insert:0.0167,kntrie_erase:0.0070,kntrie_iter:0.0058,kntrie_mem:3080,map_fnd:0.0090,map_nf:0.0086,map_insert:0.0246,map_erase:0.0126,map_iter:0.0023,map_mem:10800,umap_fnd:0.0007,umap_nf:0.0014,umap_insert:0.0061,umap_erase:0.0022,umap_iter:0.0004,umap_mem:7216},
  {pattern:"sequential",N:337,kntrie_fnd:0.0031,kntrie_nf:0.0027,kntrie_insert:0.0289,kntrie_erase:0.0097,kntrie_iter:0.0093,kntrie_mem:6152,map_fnd:0.0146,map_nf:0.0141,map_insert:0.0372,map_erase:0.0176,map_iter:0.0033,map_mem:16176,umap_fnd:0.0010,umap_nf:0.0020,umap_insert:0.0083,umap_erase:0.0029,umap_iter:0.0006,umap_mem:10784},
  {pattern:"sequential",N:506,kntrie_fnd:0.0046,kntrie_nf:0.0040,kntrie_insert:0.0453,kntrie_erase:0.0135,kntrie_iter:0.0138,kntrie_mem:6152,map_fnd:0.0234,map_nf:0.0222,map_insert:0.0552,map_erase:0.0262,map_iter:0.0049,map_mem:24288,umap_fnd:0.0016,umap_nf:0.0033,umap_insert:0.0116,umap_erase:0.0038,umap_iter:0.0008,umap_mem:16472},
  {pattern:"sequential",N:759,kntrie_fnd:0.0077,kntrie_nf:0.0068,kntrie_insert:0.0561,kntrie_erase:0.0210,kntrie_iter:0.0222,kntrie_mem:12296,map_fnd:0.0389,map_nf:0.0363,map_insert:0.0826,map_erase:0.0416,map_iter:0.0073,map_mem:36432,umap_fnd:0.0025,umap_nf:0.0047,umap_insert:0.0168,umap_erase:0.0060,umap_iter:0.0013,umap_mem:24304},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0127,kntrie_nf:0.0111,kntrie_insert:0.0852,kntrie_erase:0.0247,kntrie_iter:0.0351,kntrie_mem:24584,map_fnd:0.0664,map_nf:0.0642,map_insert:0.1237,map_erase:0.0625,map_iter:0.0121,map_mem:54672,umap_fnd:0.0034,umap_nf:0.0074,umap_insert:0.0230,umap_erase:0.0083,umap_iter:0.0019,umap_mem:36880},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0188,kntrie_nf:0.0167,kntrie_insert:0.1175,kntrie_erase:0.0405,kntrie_iter:0.0524,kntrie_mem:24584,map_fnd:0.1093,map_nf:0.1073,map_insert:0.1920,map_erase:0.0981,map_iter:0.0179,map_mem:81984,umap_fnd:0.0051,umap_nf:0.0110,umap_insert:0.0338,umap_erase:0.0128,umap_iter:0.0029,umap_mem:54920},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0316,kntrie_nf:0.0276,kntrie_insert:0.2119,kntrie_erase:0.0636,kntrie_iter:0.0847,kntrie_mem:49160,map_fnd:0.1829,map_nf:0.1775,map_insert:0.2924,map_erase:0.1529,map_iter:0.0274,map_mem:122976,umap_fnd:0.0078,umap_nf:0.0179,umap_insert:0.0483,umap_erase:0.0192,umap_iter:0.0042,umap_mem:83512},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0481,kntrie_nf:0.0420,kntrie_insert:0.2961,kntrie_erase:0.0954,kntrie_iter:0.1269,kntrie_mem:49160,map_fnd:0.3023,map_nf:0.2964,map_insert:0.4791,map_erase:0.2531,map_iter:0.0429,map_mem:184512,umap_fnd:0.0124,umap_nf:0.0262,umap_insert:0.0714,umap_erase:0.0306,umap_iter:0.0061,umap_mem:124472},
  {pattern:"sequential",N:5766,kntrie_fnd:0.2002,kntrie_nf:0.1808,kntrie_insert:0.6288,kntrie_erase:0.2363,kntrie_iter:0.2352,kntrie_mem:36128,map_fnd:0.4998,map_nf:0.5005,map_insert:0.7615,map_erase:0.4042,map_iter:0.0671,map_mem:276768,umap_fnd:0.0184,umap_nf:0.0391,umap_insert:0.1059,umap_erase:0.0482,umap_iter:0.0091,umap_mem:186008},
  {pattern:"sequential",N:8649,kntrie_fnd:0.3072,kntrie_nf:0.2773,kntrie_insert:0.7928,kntrie_erase:0.2879,kntrie_iter:0.3675,kntrie_mem:53952,map_fnd:0.8398,map_nf:0.8402,map_insert:1.2011,map_erase:0.6411,map_iter:0.1050,map_mem:415152,umap_fnd:0.0287,umap_nf:0.0576,umap_insert:0.1570,umap_erase:0.0753,umap_iter:0.0135,umap_mem:277840},
  {pattern:"sequential",N:12974,kntrie_fnd:0.4717,kntrie_nf:0.4206,kntrie_insert:1.0173,kntrie_erase:0.4111,kntrie_iter:0.5445,kntrie_mem:81008,map_fnd:1.3986,map_nf:1.3653,map_insert:1.8649,map_erase:1.0666,map_iter:0.1967,map_mem:622752,umap_fnd:0.0406,umap_nf:0.0843,umap_insert:0.2326,umap_erase:0.1127,umap_iter:0.0203,umap_mem:415240},
  {pattern:"sequential",N:19461,kntrie_fnd:0.6900,kntrie_nf:0.6035,kntrie_insert:1.3684,kntrie_erase:0.5787,kntrie_iter:0.7806,kntrie_mem:121280,map_fnd:2.3594,map_nf:2.3134,map_insert:2.9786,map_erase:1.7017,map_iter:0.3655,map_mem:934128,umap_fnd:0.0733,umap_nf:0.1365,umap_insert:0.3540,umap_erase:0.1947,umap_iter:0.0326,umap_mem:633088},
  {pattern:"sequential",N:29192,kntrie_fnd:1.0465,kntrie_nf:0.9106,kntrie_insert:2.0397,kntrie_erase:0.8985,kntrie_iter:1.1792,kntrie_mem:181936,map_fnd:4.1661,map_nf:4.1252,map_insert:4.9419,map_erase:2.8749,map_iter:0.7785,map_mem:1401216,umap_fnd:0.1679,umap_nf:0.2333,umap_insert:0.5451,umap_erase:0.3502,umap_iter:0.0516,umap_mem:946424},
  {pattern:"sequential",N:43789,kntrie_fnd:1.6208,kntrie_nf:1.3946,kntrie_insert:3.7428,kntrie_erase:1.4757,kntrie_iter:1.9168,kntrie_mem:272496,map_fnd:7.7042,map_nf:7.5349,map_insert:8.0402,map_erase:4.8994,map_iter:1.3694,map_mem:2101872,umap_fnd:0.3016,umap_nf:0.3873,umap_insert:0.8262,umap_erase:0.5861,umap_iter:0.0796,umap_mem:1414784},
  {pattern:"sequential",N:65684,kntrie_fnd:2.4603,kntrie_nf:2.1163,kntrie_insert:5.4313,kntrie_erase:2.3082,kntrie_iter:2.8581,kntrie_mem:409528,map_fnd:15.6206,map_nf:13.9924,map_insert:13.7116,map_erase:8.4489,map_iter:2.8755,map_mem:3152832,umap_fnd:0.5534,umap_nf:0.6458,umap_insert:1.2476,umap_erase:1.0179,umap_iter:0.1273,umap_mem:2114872},
  {pattern:"sequential",N:98526,kntrie_fnd:3.7003,kntrie_nf:3.2175,kntrie_insert:8.0735,kntrie_erase:3.4992,kntrie_iter:4.2580,kntrie_mem:613320,map_fnd:25.9099,map_nf:24.2064,map_insert:22.9672,map_erase:13.5215,map_iter:5.5823,map_mem:4729248,umap_fnd:0.8174,umap_nf:1.0130,umap_insert:2.0959,umap_erase:1.6651,umap_iter:0.1940,umap_mem:3162488},
  {pattern:"sequential",N:147789,kntrie_fnd:5.8260,kntrie_nf:4.9674,kntrie_insert:12.5634,kntrie_erase:5.4034,kntrie_iter:6.4310,kntrie_mem:919440,map_fnd:67.6703,map_nf:70.3582,map_insert:47.7669,map_erase:36.0835,map_iter:14.5041,map_mem:7093872,umap_fnd:1.4573,umap_nf:1.5754,umap_insert:3.6172,umap_erase:2.6782,umap_iter:0.3563,umap_mem:4729280},
  {pattern:"sequential",N:221683,kntrie_fnd:9.4875,kntrie_nf:7.4549,kntrie_insert:19.6904,kntrie_erase:8.1435,kntrie_iter:9.7037,kntrie_mem:1378592,map_fnd:140.9531,map_nf:133.3924,map_insert:84.5612,map_erase:75.7028,map_iter:31.4643,map_mem:10640784,umap_fnd:2.6575,umap_nf:2.6494,umap_insert:6.1881,umap_erase:4.6995,umap_iter:1.0127,umap_mem:7215568},
  {pattern:"sequential",N:332525,kntrie_fnd:15.0812,kntrie_nf:11.6328,kntrie_insert:31.0836,kntrie_erase:15.1804,kntrie_iter:14.5597,kntrie_mem:2068240,map_fnd:265.1685,map_nf:256.1681,map_insert:170.1840,map_erase:137.2682,map_iter:51.5544,map_mem:15961200,umap_fnd:4.7558,umap_nf:4.7443,umap_insert:10.3242,umap_erase:10.2445,umap_iter:1.5758,umap_mem:10789088},
  {pattern:"sequential",N:498788,kntrie_fnd:26.3541,kntrie_nf:17.6523,kntrie_insert:48.7461,kntrie_erase:23.6167,kntrie_iter:21.8660,kntrie_mem:3102320,map_fnd:399.6832,map_nf:414.0530,map_insert:332.5517,map_erase:212.7480,map_iter:72.0224,map_mem:23941824,umap_fnd:11.7444,umap_nf:16.8321,umap_insert:16.9728,umap_erase:22.4791,umap_iter:2.7287,umap_mem:16132840},
  {pattern:"sequential",N:748182,kntrie_fnd:41.5491,kntrie_nf:26.6016,kntrie_insert:78.1450,kntrie_erase:36.8483,kntrie_iter:32.6906,kntrie_mem:4653120,map_fnd:666.5618,map_nf:618.3586,map_insert:502.8236,map_erase:312.3633,map_iter:111.4917,map_mem:35912736,umap_fnd:17.8137,umap_nf:20.4849,umap_insert:24.3925,umap_erase:35.5435,umap_iter:3.7761,umap_mem:24124760},
  {pattern:"sequential",N:1122274,kntrie_fnd:76.3579,kntrie_nf:45.1953,kntrie_insert:133.9325,kntrie_erase:65.5142,kntrie_iter:50.0097,kntrie_mem:6980400,umap_fnd:33.4476,umap_nf:43.2435,umap_insert:44.4320,umap_erase:77.8796,umap_iter:5.6753,umap_mem:36077144},
  {pattern:"sequential",N:1683411,kntrie_fnd:141.1882,kntrie_nf:78.0201,kntrie_insert:207.1306,kntrie_erase:113.9237,kntrie_iter:74.9315,kntrie_mem:10470080,umap_fnd:58.0789,umap_nf:73.7634,umap_insert:71.9244,umap_erase:136.4252,umap_iter:8.3425,umap_mem:53952736},
  {pattern:"sequential",N:2525116,kntrie_fnd:215.1978,kntrie_nf:133.8689,kntrie_insert:363.3691,kntrie_erase:182.0940,kntrie_iter:120.5552,kntrie_mem:15705304,umap_fnd:93.6297,umap_nf:113.5199,umap_insert:135.7995,umap_erase:195.2282,umap_iter:12.0921,umap_mem:82332776},
  {pattern:"sequential",N:3787675,kntrie_fnd:371.2672,kntrie_nf:217.1329,kntrie_insert:608.2066,kntrie_erase:317.1084,kntrie_iter:167.1626,kntrie_mem:23557776,umap_fnd:152.4340,umap_nf:182.0083,umap_insert:239.8605,umap_erase:302.0335,umap_iter:17.5209,umap_mem:123112448},
  {pattern:"sequential",N:5681512,kntrie_fnd:716.2136,kntrie_nf:366.6747,kntrie_insert:1050.7377,kntrie_erase:619.4322,kntrie_iter:251.8762,kntrie_mem:35336432,umap_fnd:245.6837,umap_nf:285.8170,umap_insert:396.9978,umap_erase:465.2547,umap_iter:26.0265,umap_mem:184095064},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
