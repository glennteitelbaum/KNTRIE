<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kntrie Benchmark</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
  body { margin:0; background:#0f0f1a; color:#ddd; font-family:system-ui,sans-serif; }
  .wrap { max-width:700px; margin:0 auto; padding:16px 12px; }
  h2 { margin:0 0 4px; font-size:18px; font-weight:700; text-align:center; }
  .sub { text-align:center; color:#777; font-size:12px; margin:0 0 12px; }
  .btns { display:flex; justify-content:center; gap:8px; margin-bottom:16px; }
  .btns button { padding:6px 16px; border-radius:6px; border:1px solid #444;
    background:#1a1a2e; color:#aaa; cursor:pointer; font-size:13px; font-weight:600; }
  .btns button.active { background:#3b82f6; color:#fff; }
  .chart-box { margin-bottom:24px; }
  .chart-box h3 { margin:0 0 6px; font-size:14px; font-weight:600; text-align:center; }
  canvas { background:#12122a; border-radius:8px; }
</style>
</head>
<body>
<div class="wrap">
  <h2>kntrie Benchmark (u64 &rarr; i32)</h2>
  <p class="sub">Log-log &middot; Per-entry &middot; Lower is better &middot; FND=100% hit, NF=100% miss</p>
  <div class="btns">
    <button class="active" onclick="show('random')">random</button>
    <button onclick="show('sequential')">sequential</button>
  </div>
  <div class="chart-box"><h3>Find (ns/entry)</h3><canvas id="c_find"></canvas></div>
  <div class="chart-box"><h3>Iteration (ns/entry)</h3><canvas id="c_iter"></canvas></div>
  <div class="chart-box"><h3>Insert (ns/entry)</h3><canvas id="c_insert"></canvas></div>
  <div class="chart-box"><h3>Erase N/2 (ns/entry)</h3><canvas id="c_erase"></canvas></div>
  <div class="chart-box"><h3>Memory (B/entry)</h3><canvas id="c_mem"></canvas></div>
</div>
<script>
const RAW_DATA = [
  {pattern:"random",N:100,kntrie_fnd:0.0004,kntrie_nf:0.0003,kntrie_insert:0.0086,kntrie_erase:0.0062,kntrie_iter:0.0044,kntrie_mem:4112,map_fnd:0.0025,map_nf:0.0018,map_insert:0.0098,map_erase:0.0062,map_iter:0.0010,map_mem:4800,umap_fnd:0.0010,umap_nf:0.0014,umap_insert:0.0032,umap_erase:0.0021,umap_iter:0.0002,umap_mem:3224,kntrie_memneeded:2472},
  {pattern:"random",N:150,kntrie_fnd:0.0006,kntrie_nf:0.0005,kntrie_insert:0.0083,kntrie_erase:0.0056,kntrie_iter:0.0052,kntrie_mem:8224,map_fnd:0.0042,map_nf:0.0032,map_insert:0.0139,map_erase:0.0079,map_iter:0.0014,map_mem:7200,umap_fnd:0.0015,umap_nf:0.0017,umap_insert:0.0049,umap_erase:0.0029,umap_iter:0.0002,umap_mem:4856,kntrie_memneeded:3456},
  {pattern:"random",N:225,kntrie_fnd:0.0011,kntrie_nf:0.0008,kntrie_insert:0.0087,kntrie_erase:0.0079,kntrie_iter:0.0056,kntrie_mem:8224,map_fnd:0.0068,map_nf:0.0054,map_insert:0.0193,map_erase:0.0095,map_iter:0.0018,map_mem:10800,umap_fnd:0.0024,umap_nf:0.0032,umap_insert:0.0064,umap_erase:0.0035,umap_iter:0.0003,umap_mem:7216,kntrie_memneeded:4824},
  {pattern:"random",N:337,kntrie_fnd:0.0022,kntrie_nf:0.0014,kntrie_insert:0.0118,kntrie_erase:0.0107,kntrie_iter:0.0070,kntrie_mem:12336,map_fnd:0.0109,map_nf:0.0088,map_insert:0.0290,map_erase:0.0149,map_iter:0.0027,map_mem:16176,umap_fnd:0.0034,umap_nf:0.0050,umap_insert:0.0093,umap_erase:0.0044,umap_iter:0.0005,umap_mem:10784,kntrie_memneeded:6752},
  {pattern:"random",N:506,kntrie_fnd:0.0038,kntrie_nf:0.0029,kntrie_insert:0.0234,kntrie_erase:0.0173,kntrie_iter:0.0099,kntrie_mem:16448,map_fnd:0.0203,map_nf:0.0187,map_insert:0.0438,map_erase:0.0287,map_iter:0.0040,map_mem:24288,umap_fnd:0.0062,umap_nf:0.0089,umap_insert:0.0160,umap_erase:0.0075,umap_iter:0.0008,umap_mem:16472,kntrie_memneeded:9536},
  {pattern:"random",N:759,kntrie_fnd:0.0073,kntrie_nf:0.0077,kntrie_insert:0.0363,kntrie_erase:0.0271,kntrie_iter:0.0162,kntrie_mem:24656,map_fnd:0.0378,map_nf:0.0314,map_insert:0.0816,map_erase:0.0428,map_iter:0.0082,map_mem:36432,umap_fnd:0.0096,umap_nf:0.0144,umap_insert:0.0234,umap_erase:0.0110,umap_iter:0.0013,umap_mem:24304,kntrie_memneeded:13664},
  {pattern:"random",N:1139,kntrie_fnd:0.0103,kntrie_nf:0.0114,kntrie_insert:0.0493,kntrie_erase:0.0384,kntrie_iter:0.0237,kntrie_mem:36960,map_fnd:0.0650,map_nf:0.0608,map_insert:0.1205,map_erase:0.0618,map_iter:0.0126,map_mem:54672,umap_fnd:0.0147,umap_nf:0.0201,umap_insert:0.0315,umap_erase:0.0145,umap_iter:0.0022,umap_mem:36880,kntrie_memneeded:19976},
  {pattern:"random",N:1708,kntrie_fnd:0.0158,kntrie_nf:0.0159,kntrie_insert:0.0753,kntrie_erase:0.0528,kntrie_iter:0.0370,kntrie_mem:49264,map_fnd:0.1083,map_nf:0.0963,map_insert:0.1890,map_erase:0.0997,map_iter:0.0192,map_mem:81984,umap_fnd:0.0236,umap_nf:0.0334,umap_insert:0.0453,umap_erase:0.0233,umap_iter:0.0043,umap_mem:54920,kntrie_memneeded:30272},
  {pattern:"random",N:2562,kntrie_fnd:0.0212,kntrie_nf:0.0235,kntrie_insert:0.1177,kntrie_erase:0.0736,kntrie_iter:0.0586,kntrie_mem:86160,map_fnd:0.1785,map_nf:0.1629,map_insert:0.2861,map_erase:0.1443,map_iter:0.0287,map_mem:122976,umap_fnd:0.0356,umap_nf:0.0493,umap_insert:0.0680,umap_erase:0.0349,umap_iter:0.0075,umap_mem:83512,kntrie_memneeded:45160},
  {pattern:"random",N:3844,kntrie_fnd:0.0402,kntrie_nf:0.0371,kntrie_insert:0.1861,kntrie_erase:0.0959,kntrie_iter:0.0929,kntrie_mem:151728,map_fnd:0.2950,map_nf:0.2749,map_insert:0.4523,map_erase:0.2398,map_iter:0.0432,map_mem:184512,umap_fnd:0.0570,umap_nf:0.0762,umap_insert:0.1037,umap_erase:0.0556,umap_iter:0.0127,umap_mem:124472,kntrie_memneeded:66936},
  {pattern:"random",N:5766,kntrie_fnd:0.0474,kntrie_nf:0.0447,kntrie_insert:0.3019,kntrie_erase:0.1392,kntrie_iter:0.1466,kntrie_mem:254160,map_fnd:0.4908,map_nf:0.4717,map_insert:0.7246,map_erase:0.3704,map_iter:0.0683,map_mem:276768,umap_fnd:0.0886,umap_nf:0.1223,umap_insert:0.1738,umap_erase:0.0845,umap_iter:0.0205,umap_mem:186008,kntrie_memneeded:97688},
  {pattern:"random",N:8649,kntrie_fnd:0.0968,kntrie_nf:0.1020,kntrie_insert:0.4908,kntrie_erase:0.1974,kntrie_iter:0.2378,kntrie_mem:327904,map_fnd:0.7892,map_nf:0.6962,map_insert:1.1370,map_erase:0.5197,map_iter:0.1024,map_mem:415152,umap_fnd:0.1175,umap_nf:0.1585,umap_insert:0.2157,umap_erase:0.1269,umap_iter:0.0279,umap_mem:277840,kntrie_memneeded:159848},
  {pattern:"random",N:12974,kntrie_fnd:0.1030,kntrie_nf:0.0886,kntrie_insert:0.6052,kntrie_erase:0.2709,kntrie_iter:0.3291,kntrie_mem:430384,map_fnd:1.1963,map_nf:1.1574,map_insert:1.5754,map_erase:0.8580,map_iter:0.1570,map_mem:622752,umap_fnd:0.1812,umap_nf:0.2473,umap_insert:0.3127,umap_erase:0.1725,umap_iter:0.0435,umap_mem:415240,kntrie_memneeded:205656},
  {pattern:"random",N:19461,kntrie_fnd:0.1767,kntrie_nf:0.1504,kntrie_insert:0.9237,kntrie_erase:0.3688,kntrie_iter:0.4586,kntrie_mem:773152,map_fnd:1.7553,map_nf:1.7240,map_insert:2.2527,map_erase:1.2325,map_iter:0.1970,map_mem:934128,umap_fnd:0.2441,umap_nf:0.3339,umap_insert:0.4209,umap_erase:0.2333,umap_iter:0.0629,umap_mem:633088,kntrie_memneeded:376904},
  {pattern:"random",N:29192,kntrie_fnd:0.2719,kntrie_nf:0.2223,kntrie_insert:1.4267,kntrie_erase:0.5313,kntrie_iter:0.6929,kntrie_mem:840936,map_fnd:3.5713,map_nf:3.3408,map_insert:3.6700,map_erase:2.1689,map_iter:0.5257,map_mem:1401216,umap_fnd:0.3847,umap_nf:0.5141,umap_insert:0.6629,umap_erase:0.3712,umap_iter:0.1053,umap_mem:946424,kntrie_memneeded:426304},
  {pattern:"random",N:43789,kntrie_fnd:0.4954,kntrie_nf:0.4132,kntrie_insert:2.2738,kntrie_erase:0.9553,kntrie_iter:1.1360,kntrie_mem:1204984,map_fnd:8.4150,map_nf:7.4682,map_insert:6.8727,map_erase:4.6751,map_iter:1.7524,map_mem:2101872,umap_fnd:0.7182,umap_nf:0.9408,umap_insert:1.2487,umap_erase:0.7812,umap_iter:0.1979,umap_mem:1414784,kntrie_memneeded:790680},
  {pattern:"random",N:65684,kntrie_fnd:0.9790,kntrie_nf:0.8497,kntrie_insert:4.0129,kntrie_erase:1.3690,kntrie_iter:1.7882,kntrie_mem:1592056,map_fnd:14.8432,map_nf:13.6265,map_insert:12.1534,map_erase:8.6967,map_iter:2.9758,map_mem:3152832,umap_fnd:1.2625,umap_nf:1.5961,umap_insert:2.1788,umap_erase:1.6587,umap_iter:0.4445,umap_mem:2114872,kntrie_memneeded:1179656},
  {pattern:"random",N:98526,kntrie_fnd:1.6901,kntrie_nf:1.1458,kntrie_insert:5.8162,kntrie_erase:2.5546,kntrie_iter:2.7835,kntrie_mem:1988840,map_fnd:29.6723,map_nf:26.9603,map_insert:22.2471,map_erase:15.7730,map_iter:5.1725,map_mem:4729248,umap_fnd:2.3073,umap_nf:2.6710,umap_insert:4.5046,umap_erase:2.9283,umap_iter:1.0490,umap_mem:3162488,kntrie_memneeded:1578184},
  {pattern:"random",N:147789,kntrie_fnd:6.2447,kntrie_nf:3.8010,kntrie_insert:13.4953,kntrie_erase:5.1316,kntrie_iter:5.8140,kntrie_mem:3543272,map_fnd:53.5529,map_nf:53.2046,map_insert:45.9033,map_erase:32.4780,map_iter:8.6769,map_mem:7093872,umap_fnd:4.0347,umap_nf:5.0302,umap_insert:8.1143,umap_erase:5.1802,umap_iter:2.1816,umap_mem:4729280,kntrie_memneeded:3136672},
  {pattern:"random",N:221683,kntrie_fnd:9.2741,kntrie_nf:5.6016,kntrie_insert:21.8796,kntrie_erase:9.9231,kntrie_iter:8.6284,kntrie_mem:3555560,map_fnd:93.3434,map_nf:91.3159,map_insert:78.3088,map_erase:52.7328,map_iter:14.2133,map_mem:10640784,umap_fnd:6.3871,umap_nf:8.0575,umap_insert:13.7705,umap_erase:8.5886,umap_iter:3.8724,umap_mem:7215568,kntrie_memneeded:3152584},
  {pattern:"random",N:332525,kntrie_fnd:21.2550,kntrie_nf:14.8315,kntrie_insert:42.5290,kntrie_erase:18.4623,kntrie_iter:14.0557,kntrie_mem:6690040,umap_fnd:10.5838,umap_nf:12.9915,umap_insert:23.0478,umap_erase:14.2039,umap_iter:6.8531,umap_mem:10789088,kntrie_memneeded:6295720},
  {pattern:"random",N:498788,kntrie_fnd:33.2152,kntrie_nf:23.5815,kntrie_insert:81.4855,kntrie_erase:32.3716,kntrie_iter:20.9525,kntrie_mem:6788344,umap_fnd:16.6755,umap_nf:19.9759,umap_insert:37.0219,umap_erase:22.8694,umap_iter:11.6679,umap_mem:16132840,kntrie_memneeded:6405992},
  {pattern:"random",N:748182,kntrie_fnd:68.0314,kntrie_nf:51.1269,kntrie_insert:137.3452,kntrie_erase:60.1150,kntrie_iter:33.1744,kntrie_mem:12956920,umap_fnd:26.2098,umap_nf:31.4602,umap_insert:61.2135,umap_erase:37.2446,umap_iter:19.6436,umap_mem:24124760,kntrie_memneeded:12589048},
  {pattern:"random",N:1122274,kntrie_fnd:73.1684,kntrie_nf:65.7125,kntrie_insert:307.2522,kntrie_erase:103.4864,kntrie_iter:39.2892,kntrie_mem:33010208,umap_fnd:41.8852,umap_nf:49.3456,umap_insert:98.9179,umap_erase:58.1289,umap_iter:31.7621,umap_mem:36077144,kntrie_memneeded:20686616},
  {pattern:"random",N:1683411,kntrie_fnd:118.9223,kntrie_nf:97.2708,kntrie_insert:409.5740,kntrie_erase:163.9981,kntrie_iter:62.9780,kntrie_mem:51184192,umap_fnd:67.7789,umap_nf:79.7396,umap_insert:165.2508,umap_erase:97.8580,umap_iter:54.9153,umap_mem:53952736,kntrie_memneeded:28463016},
  {pattern:"random",N:2525116,kntrie_fnd:212.5783,kntrie_nf:179.7532,kntrie_insert:613.9575,kntrie_erase:246.8406,kntrie_iter:99.2211,kntrie_mem:99300488,umap_fnd:107.8644,umap_nf:114.2211,umap_insert:242.3382,umap_erase:146.6805,umap_iter:82.0559,umap_mem:82332776,kntrie_memneeded:47488096},
  {pattern:"random",N:3787675,kntrie_fnd:339.6670,kntrie_nf:279.9635,kntrie_insert:921.8329,kntrie_erase:364.4046,kntrie_iter:131.4251,kntrie_mem:118322568,umap_fnd:177.0269,umap_nf:174.1680,umap_insert:384.1246,umap_erase:246.6818,umap_iter:134.4767,umap_mem:123112448,kntrie_memneeded:61106600},
  {pattern:"random",N:5681512,kntrie_fnd:538.0510,kntrie_nf:497.8750,kntrie_insert:1465.3285,kntrie_erase:653.0473,kntrie_iter:231.4955,kntrie_mem:199839592,umap_fnd:294.8279,umap_nf:296.4668,umap_insert:650.7795,umap_erase:400.0367,umap_iter:226.2471,umap_mem:184095064,kntrie_memneeded:101659992},
  {pattern:"sequential",N:100,kntrie_fnd:0.0003,kntrie_nf:0.0004,kntrie_insert:0.0067,kntrie_erase:0.0021,kntrie_iter:0.0036,kntrie_mem:4112,map_fnd:0.0031,map_nf:0.0031,map_insert:0.0101,map_erase:0.0061,map_iter:0.0013,map_mem:4800,umap_fnd:0.0003,umap_nf:0.0006,umap_insert:0.0021,umap_erase:0.0018,umap_iter:0.0002,umap_mem:3224,kntrie_memneeded:552},
  {pattern:"sequential",N:150,kntrie_fnd:0.0005,kntrie_nf:0.0005,kntrie_insert:0.0071,kntrie_erase:0.0034,kntrie_iter:0.0044,kntrie_mem:4112,map_fnd:0.0052,map_nf:0.0052,map_insert:0.0171,map_erase:0.0089,map_iter:0.0015,map_mem:7200,umap_fnd:0.0005,umap_nf:0.0010,umap_insert:0.0042,umap_erase:0.0022,umap_iter:0.0003,umap_mem:4856,kntrie_memneeded:696},
  {pattern:"sequential",N:225,kntrie_fnd:0.0007,kntrie_nf:0.0008,kntrie_insert:0.0083,kntrie_erase:0.0041,kntrie_iter:0.0057,kntrie_mem:4112,map_fnd:0.0086,map_nf:0.0084,map_insert:0.0244,map_erase:0.0117,map_iter:0.0022,map_mem:10800,umap_fnd:0.0007,umap_nf:0.0014,umap_insert:0.0054,umap_erase:0.0025,umap_iter:0.0004,umap_mem:7216,kntrie_memneeded:1104},
  {pattern:"sequential",N:337,kntrie_fnd:0.0010,kntrie_nf:0.0011,kntrie_insert:0.0113,kntrie_erase:0.0061,kntrie_iter:0.0077,kntrie_mem:4112,map_fnd:0.0141,map_nf:0.0135,map_insert:0.0355,map_erase:0.0176,map_iter:0.0033,map_mem:16176,umap_fnd:0.0010,umap_nf:0.0021,umap_insert:0.0072,umap_erase:0.0030,umap_iter:0.0006,umap_mem:10784,kntrie_memneeded:1488},
  {pattern:"sequential",N:506,kntrie_fnd:0.0015,kntrie_nf:0.0017,kntrie_insert:0.0167,kntrie_erase:0.0080,kntrie_iter:0.0108,kntrie_mem:8224,map_fnd:0.0226,map_nf:0.0221,map_insert:0.0532,map_erase:0.0266,map_iter:0.0049,map_mem:24288,umap_fnd:0.0016,umap_nf:0.0034,umap_insert:0.0105,umap_erase:0.0039,umap_iter:0.0008,umap_mem:16472,kntrie_memneeded:2208},
  {pattern:"sequential",N:759,kntrie_fnd:0.0023,kntrie_nf:0.0026,kntrie_insert:0.0238,kntrie_erase:0.0114,kntrie_iter:0.0157,kntrie_mem:12336,map_fnd:0.0381,map_nf:0.0368,map_insert:0.0807,map_erase:0.0410,map_iter:0.0078,map_mem:36432,umap_fnd:0.0024,umap_nf:0.0047,umap_insert:0.0141,umap_erase:0.0051,umap_iter:0.0013,umap_mem:24304,kntrie_memneeded:3312},
  {pattern:"sequential",N:1139,kntrie_fnd:0.0033,kntrie_nf:0.0035,kntrie_insert:0.0329,kntrie_erase:0.0158,kntrie_iter:0.0225,kntrie_mem:16448,map_fnd:0.0653,map_nf:0.0635,map_insert:0.1188,map_erase:0.0603,map_iter:0.0117,map_mem:54672,umap_fnd:0.0035,umap_nf:0.0075,umap_insert:0.0203,umap_erase:0.0065,umap_iter:0.0019,umap_mem:36880,kntrie_memneeded:4968},
  {pattern:"sequential",N:1708,kntrie_fnd:0.0049,kntrie_nf:0.0057,kntrie_insert:0.0487,kntrie_erase:0.0230,kntrie_iter:0.0331,kntrie_mem:24656,map_fnd:0.1082,map_nf:0.1082,map_insert:0.1855,map_erase:0.0948,map_iter:0.0188,map_mem:81984,umap_fnd:0.0052,umap_nf:0.0113,umap_insert:0.0277,umap_erase:0.0102,umap_iter:0.0029,umap_mem:54920,kntrie_memneeded:7448},
  {pattern:"sequential",N:2562,kntrie_fnd:0.0075,kntrie_nf:0.0086,kntrie_insert:0.0711,kntrie_erase:0.0343,kntrie_iter:0.0492,kntrie_mem:36960,map_fnd:0.1814,map_nf:0.1810,map_insert:0.2885,map_erase:0.1472,map_iter:0.0303,map_mem:122976,umap_fnd:0.0078,umap_nf:0.0185,umap_insert:0.0411,umap_erase:0.0165,umap_iter:0.0042,umap_mem:83512,kntrie_memneeded:11088},
  {pattern:"sequential",N:3844,kntrie_fnd:0.0112,kntrie_nf:0.0124,kntrie_insert:0.1051,kntrie_erase:0.0516,kntrie_iter:0.0729,kntrie_mem:65664,map_fnd:0.2996,map_nf:0.3025,map_insert:0.4472,map_erase:0.2322,map_iter:0.0426,map_mem:184512,umap_fnd:0.0119,umap_nf:0.0271,umap_insert:0.0616,umap_erase:0.0250,umap_iter:0.0062,umap_mem:124472,kntrie_memneeded:16624},
  {pattern:"sequential",N:5766,kntrie_fnd:0.0172,kntrie_nf:0.0191,kntrie_insert:0.1561,kntrie_erase:0.0768,kntrie_iter:0.1089,kntrie_mem:86160,map_fnd:0.4992,map_nf:0.4926,map_insert:0.7235,map_erase:0.3730,map_iter:0.0684,map_mem:276768,umap_fnd:0.0182,umap_nf:0.0400,umap_insert:0.0895,umap_erase:0.0375,umap_iter:0.0092,umap_mem:186008,kntrie_memneeded:24904},
  {pattern:"sequential",N:8649,kntrie_fnd:0.0265,kntrie_nf:0.0293,kntrie_insert:0.2431,kntrie_erase:0.1156,kntrie_iter:0.1639,kntrie_mem:114848,map_fnd:0.8223,map_nf:0.8257,map_insert:1.1520,map_erase:0.6052,map_iter:0.1015,map_mem:415152,umap_fnd:0.0273,umap_nf:0.0595,umap_insert:0.1343,umap_erase:0.0592,umap_iter:0.0136,umap_mem:277840,kntrie_memneeded:37368},
  {pattern:"sequential",N:12974,kntrie_fnd:0.0387,kntrie_nf:0.0433,kntrie_insert:0.3447,kntrie_erase:0.1721,kntrie_iter:0.2422,kntrie_mem:196800,map_fnd:1.3670,map_nf:1.3585,map_insert:1.8132,map_erase:1.0002,map_iter:0.1604,map_mem:622752,umap_fnd:0.0395,umap_nf:0.0866,umap_insert:0.1884,umap_erase:0.0872,umap_iter:0.0201,umap_mem:415240,kntrie_memneeded:56024},
  {pattern:"sequential",N:19461,kntrie_fnd:0.0598,kntrie_nf:0.0668,kntrie_insert:0.5463,kntrie_erase:0.2627,kntrie_iter:0.3622,kntrie_mem:254160,map_fnd:2.4167,map_nf:2.3754,map_insert:2.9282,map_erase:1.5917,map_iter:0.3089,map_mem:934128,umap_fnd:0.0595,umap_nf:0.1385,umap_insert:0.2955,umap_erase:0.1356,umap_iter:0.0303,umap_mem:633088,kntrie_memneeded:83968},
  {pattern:"sequential",N:29192,kntrie_fnd:0.0943,kntrie_nf:0.1008,kntrie_insert:0.8237,kntrie_erase:0.4069,kntrie_iter:0.5474,kntrie_mem:418032,map_fnd:4.3625,map_nf:4.5430,map_insert:4.7090,map_erase:2.8701,map_iter:0.6520,map_mem:1401216,umap_fnd:0.1084,umap_nf:0.2164,umap_insert:0.4525,umap_erase:0.2206,umap_iter:0.0475,umap_mem:946424,kntrie_memneeded:125952},
  {pattern:"sequential",N:43789,kntrie_fnd:0.2933,kntrie_nf:0.2189,kntrie_insert:2.0202,kntrie_erase:0.8853,kntrie_iter:1.0920,kntrie_mem:535824,map_fnd:8.6973,map_nf:8.6408,map_insert:8.1898,map_erase:5.0220,map_iter:1.6499,map_mem:2101872,umap_fnd:0.2639,umap_nf:0.4003,umap_insert:0.6472,umap_erase:0.5106,umap_iter:0.0745,umap_mem:1414784,kntrie_memneeded:192752},
  {pattern:"sequential",N:65684,kntrie_fnd:0.4638,kntrie_nf:0.3378,kntrie_insert:2.9349,kntrie_erase:1.3533,kntrie_iter:1.6492,kntrie_mem:864072,map_fnd:16.1791,map_nf:16.0753,map_insert:14.3171,map_erase:9.0281,map_iter:2.8985,map_mem:3152832,umap_fnd:0.5559,umap_nf:0.7654,umap_insert:1.0440,umap_erase:1.0693,umap_iter:0.1176,umap_mem:2114872,kntrie_memneeded:290344},
  {pattern:"sequential",N:98526,kntrie_fnd:0.7284,kntrie_nf:0.4800,kntrie_insert:4.5398,kntrie_erase:2.0935,kntrie_iter:2.4481,kntrie_mem:1375096,map_fnd:28.2948,map_nf:28.8495,map_insert:25.8952,map_erase:16.6213,map_iter:4.8587,map_mem:4729248,umap_fnd:1.0737,umap_nf:1.4308,umap_insert:1.7766,umap_erase:1.8874,umap_iter:0.1805,umap_mem:3162488,kntrie_memneeded:434744},
  {pattern:"sequential",N:147789,kntrie_fnd:1.1616,kntrie_nf:0.7218,kntrie_insert:7.2713,kntrie_erase:3.2303,kntrie_iter:3.6786,kntrie_mem:2172848,map_fnd:53.7089,map_nf:53.9059,map_insert:45.7416,map_erase:30.6937,map_iter:8.5595,map_mem:7093872,umap_fnd:1.7467,umap_nf:2.4720,umap_insert:3.4710,umap_erase:3.4020,umap_iter:0.2778,umap_mem:4729280,kntrie_memneeded:651296},
  {pattern:"sequential",N:221683,kntrie_fnd:1.8965,kntrie_nf:1.1476,kntrie_insert:11.0488,kntrie_erase:4.9812,kntrie_iter:5.5269,kntrie_mem:2732496,map_fnd:92.7080,map_nf:96.0612,map_insert:82.8308,map_erase:54.0350,map_iter:14.5997,map_mem:10640784,umap_fnd:2.9215,umap_nf:3.7099,umap_insert:5.9580,umap_erase:5.0669,umap_iter:0.4153,umap_mem:7215568,kntrie_memneeded:976640},
  {pattern:"sequential",N:332525,kntrie_fnd:3.4098,kntrie_nf:1.6102,kntrie_insert:17.1708,kntrie_erase:7.6303,kntrie_iter:8.2774,kntrie_mem:4299312,umap_fnd:4.6008,umap_nf:6.0585,umap_insert:9.7209,umap_erase:9.4932,umap_iter:0.6322,umap_mem:10789088,kntrie_memneeded:1465360},
  {pattern:"sequential",N:498788,kntrie_fnd:6.9771,kntrie_nf:2.4273,kntrie_insert:27.4789,kntrie_erase:12.7185,kntrie_iter:12.4503,kntrie_mem:6747808,umap_fnd:7.3100,umap_nf:9.4164,umap_insert:15.4684,umap_erase:15.0857,umap_iter:0.9905,umap_mem:16132840,kntrie_memneeded:2198016},
  {pattern:"sequential",N:748182,kntrie_fnd:12.6445,kntrie_nf:3.3428,kntrie_insert:46.7297,kntrie_erase:23.7267,kntrie_iter:15.7135,kntrie_mem:10576688,umap_fnd:12.0684,umap_nf:15.5422,umap_insert:27.5634,umap_erase:28.4765,umap_iter:1.6733,umap_mem:24124760,kntrie_memneeded:3296568},
  {pattern:"sequential",N:1122274,kntrie_fnd:22.2877,kntrie_nf:6.2691,kntrie_insert:80.6435,kntrie_erase:42.9787,kntrie_iter:28.2937,kntrie_mem:16563216,umap_fnd:20.3694,umap_nf:24.5772,umap_insert:42.3764,umap_erase:38.1600,umap_iter:2.7412,umap_mem:36077144,kntrie_memneeded:4945712},
  {pattern:"sequential",N:1683411,kntrie_fnd:39.7619,kntrie_nf:11.8128,kntrie_insert:134.5859,kntrie_erase:73.7725,kntrie_iter:37.0043,kntrie_mem:20748592,umap_fnd:34.0705,umap_nf:39.3771,umap_insert:70.9050,umap_erase:62.5873,umap_iter:5.2142,umap_mem:53952736,kntrie_memneeded:7418248},
  {pattern:"sequential",N:2525116,kntrie_fnd:72.4236,kntrie_nf:28.3633,kntrie_insert:238.2215,kntrie_erase:127.2947,kntrie_iter:64.2378,kntrie_mem:32469752,umap_fnd:59.5927,umap_nf:62.7652,umap_insert:123.6986,umap_erase:101.0270,umap_iter:9.4194,umap_mem:82332776,kntrie_memneeded:11131096},
  {pattern:"sequential",N:3787675,kntrie_fnd:118.7991,kntrie_nf:53.1320,kntrie_insert:409.9109,kntrie_erase:212.6741,kntrie_iter:96.5268,kntrie_mem:50750336,umap_fnd:102.1972,umap_nf:103.7011,umap_insert:196.6468,umap_erase:157.1750,umap_iter:16.5518,umap_mem:123112448,kntrie_memneeded:16691112},
  {pattern:"sequential",N:5681512,kntrie_fnd:212.0727,kntrie_nf:106.0678,kntrie_insert:658.9420,kntrie_erase:346.8585,kntrie_iter:126.6290,kntrie_mem:79321392,umap_fnd:167.1847,umap_nf:162.1508,umap_insert:288.3633,umap_erase:265.2510,umap_iter:25.4565,umap_mem:184095064,kntrie_memneeded:25036872},
];


const LINES_FIND = [
  { key: "kntrie", suffix: "fnd", color: "#3b82f6", dash: [],    width: 2.5, label: "kntrie FND" },
  { key: "kntrie", suffix: "nf", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie NF" },
  { key: "map",    suffix: "fnd", color: "#ef4444", dash: [],    width: 2.5, label: "map FND" },
  { key: "map",    suffix: "nf", color: "#fca5a5", dash: [6,3], width: 1.5, label: "map NF" },
  { key: "umap",   suffix: "fnd", color: "#22c55e", dash: [],    width: 2.5, label: "umap FND" },
  { key: "umap",   suffix: "nf", color: "#86efac", dash: [6,3], width: 1.5, label: "umap NF" },
];

const LINES_OP = [
  { key: "kntrie", suffix: "insert", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "insert", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "insert", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_ERASE = [
  { key: "kntrie", suffix: "erase", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "erase", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "erase", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const LINES_MEM = [
  { key: "kntrie", suffix: "mem", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "kntrie", suffix: "memneeded", color: "#93c5fd", dash: [6,3], width: 1.5, label: "kntrie needed" },
  { key: "map",    suffix: "mem", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "mem", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
  { key: "raw",    suffix: "mem", color: "#888",    dash: [3,3], width: 1, label: "raw (16B)" },
];

const LINES_ITER = [
  { key: "kntrie", suffix: "iter", color: "#3b82f6", dash: [], width: 2.5, label: "kntrie" },
  { key: "map",    suffix: "iter", color: "#ef4444", dash: [], width: 2.5, label: "map" },
  { key: "umap",   suffix: "iter", color: "#22c55e", dash: [], width: 2.5, label: "umap" },
];

const METRICS = [
  { id: "find",   lines: LINES_FIND,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "iter",   lines: LINES_ITER,  convert: (ms, n) => (ms * 1e6) / n },
  { id: "insert", lines: LINES_OP,    convert: (ms, n) => (ms * 1e6) / n },
  { id: "erase",  lines: LINES_ERASE, convert: (ms, n) => (ms * 1e6) / (n / 2) },
  { id: "mem",    lines: LINES_MEM,   convert: (b, n) => b / n },
];

function buildData(pattern, metric) {
  return RAW_DATA
    .filter(r => r.pattern === pattern)
    .map(r => {
      const pt = { N: r.N };
      for (const l of metric.lines) {
        if (l.key === "raw") { pt["raw_mem"] = 16; continue; }
        const raw = r[l.key + "_" + l.suffix];
        if (raw != null) pt[l.key + "_" + l.suffix] = metric.convert(raw, r.N);
      }
      return pt;
    });
}

const charts = {};

function makeChart(canvasId, metric) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  const data = buildData("random", metric);

  charts[canvasId] = new Chart(ctx, {
    type: "line",
    data: {
      labels: data.map(d => d.N),
      datasets: metric.lines.map(l => ({
        label: l.label,
        data: data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null),
        borderColor: l.color,
        backgroundColor: l.color + "33",
        borderWidth: l.width,
        borderDash: l.dash,
        pointRadius: 0,
        pointHitRadius: 8,
        tension: 0.2,
        spanGaps: true,
      })),
    },
    options: {
      responsive: true,
      interaction: { mode: "index", intersect: false },
      plugins: {
        legend: { display: true, labels: { color: "#bbb", font: { size: 11 }, boxWidth: 20, padding: 10 } },
        tooltip: {
          backgroundColor: "#1a1a2e",
          borderColor: "#444",
          borderWidth: 1,
          titleColor: "#aaa",
          bodyColor: "#ddd",
          callbacks: {
            title: (items) => {
              const v = items[0].parsed.x;
              if (v >= 1e6) return "N = " + (v/1e6).toFixed(1) + "M";
              if (v >= 1e3) return "N = " + (v/1e3).toFixed(1) + "K";
              return "N = " + v;
            },
            label: (item) => {
              const v = item.parsed.y;
              if (v == null) return null;
              const s = v < 0.1 ? v.toFixed(3) : v < 10 ? v.toFixed(2) : v < 1000 ? v.toFixed(1) : v.toFixed(0);
              return " " + item.dataset.label + ": " + s;
            },
          },
        },
      },
      scales: {
        x: {
          type: "logarithmic",
          title: { display: false },
          ticks: { color: "#888", font: { size: 11 },
            callback: (v) => v >= 1e6 ? (v/1e6)+"M" : v >= 1e3 ? (v/1e3)+"K" : v },
          grid: { color: "#2a2a3e" },
        },
        y: {
          type: "logarithmic",
          ticks: { color: "#888", font: { size: 10 },
            callback: (v) => v < 0.1 ? v.toFixed(2) : v < 10 ? v.toFixed(1) : v >= 1000 ? v.toFixed(0) : v.toFixed(1) },
          grid: { color: "#2a2a3e" },
        },
      },
    },
  });
  charts[canvasId]._metric = metric;
}

METRICS.forEach(m => makeChart("c_" + m.id, m));

function show(pattern) {
  document.querySelectorAll(".btns button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  for (const [id, chart] of Object.entries(charts)) {
    const m = chart._metric;
    const data = buildData(pattern, m);
    chart.data.labels = data.map(d => d.N);
    m.lines.forEach((l, i) => {
      chart.data.datasets[i].data = data.map(d => d[l.key === "raw" ? "raw_mem" : l.key + "_" + l.suffix] ?? null);
    });
    chart.update("none");
  }
}
</script>
</body>
</html>
