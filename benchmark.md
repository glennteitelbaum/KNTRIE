# kntrie3 Benchmark Results

Compiler: `g++ -std=c++23 -O2 -march=x86-64-v3`

Workload: insert N, find N (all hit), erase N/2, churn N/4 old + N/4 new, find N (25% miss)

Best of 3 runs per configuration.

- N = number of entries
- F = Find all N keys in ms (all hits)
- I = Insert N keys in ms
- M = Memory after insert in KB
- B = Bytes per entry after insert
- E = Erase N/2 keys in ms
- C2 = Churn insert N/4 old + N/4 new in ms
- F2 = Find all N original keys in ms (25% misses)
- M2 = Memory after churn in KB
- B2 = Bytes per entry after churn

In _vs_ rows, >1x means kntrie is better. **Bold** = kntrie wins.

## uint64_t — random

| N | | F | I | M | B | E | C2 | F2 | M2 | B2 |
|---|-|---|---|---|---|---|----|----|----|----|
| 1K | kntrie | 0.00 | 0.08 | 20.8 | 21.3 | 0.03 | 0.04 | 0.01 | 21.1 | 21.6 |
|  | map | 0.02 | 0.11 | 70.3 | 72.0 | 0.06 | 0.05 | 0.01 | 70.3 | 72.0 |
| | _map vs_ | _**3.86x**_ | _**1.33x**_ | _**3.38x**_ | _**3.38x**_ | _**1.98x**_ | _**1.18x**_ | _**2.17x**_ | _**3.34x**_ | _**3.34x**_ |
|  | umap | 0.00 | 0.03 | 70.6 | 72.2 | 0.01 | 0.01 | 0.01 | 70.6 | 72.2 |
| | _umap vs_ | _0.96x_ | _0.37x_ | _**3.39x**_ | _**3.39x**_ | _0.47x_ | _0.32x_ | _**1.03x**_ | _**3.35x**_ | _**3.35x**_ |
| 10K | kntrie | 0.24 | 0.88 | 175.7 | 18.0 | 0.26 | 0.38 | 0.27 | 174.9 | 17.9 |
|  | map | 0.37 | 1.37 | 703.1 | 72.0 | 0.74 | 0.74 | 0.43 | 703.1 | 72.0 |
| | _map vs_ | _**1.54x**_ | _**1.55x**_ | _**4.00x**_ | _**4.00x**_ | _**2.84x**_ | _**1.97x**_ | _**1.62x**_ | _**4.02x**_ | _**4.02x**_ |
|  | umap | 0.10 | 0.28 | 705.3 | 72.2 | 0.14 | 0.15 | 0.18 | 705.3 | 72.2 |
| | _umap vs_ | _0.41x_ | _0.32x_ | _**4.01x**_ | _**4.01x**_ | _0.54x_ | _0.39x_ | _0.68x_ | _**4.03x**_ | _**4.03x**_ |
| 100K | kntrie | 4.33 | 9.66 | 1701.0 | 17.4 | 3.17 | 5.08 | 4.50 | 1703.0 | 17.4 |
|  | map | 11.46 | 25.27 | 7031.2 | 72.0 | 15.57 | 17.34 | 12.78 | 7031.2 | 72.0 |
| | _map vs_ | _**2.65x**_ | _**2.62x**_ | _**4.13x**_ | _**4.13x**_ | _**4.91x**_ | _**3.41x**_ | _**2.84x**_ | _**4.13x**_ | _**4.13x**_ |
|  | umap | 2.48 | 5.04 | 7092.9 | 72.6 | 2.65 | 3.25 | 4.41 | 7092.9 | 72.6 |
| | _umap vs_ | _0.57x_ | _0.52x_ | _**4.17x**_ | _**4.17x**_ | _0.83x_ | _0.64x_ | _0.98x_ | _**4.16x**_ | _**4.16x**_ |

## int32_t — random

| N | | F | I | M | B | E | C2 | F2 | M2 | B2 |
|---|-|---|---|---|---|---|----|----|----|----|
| 1K | kntrie | 0.00 | 0.09 | 16.6 | 17.0 | 0.03 | 0.04 | 0.00 | 16.8 | 17.2 |
|  | map | 0.04 | 0.11 | 70.3 | 72.0 | 0.05 | 0.05 | 0.03 | 70.3 | 72.0 |
| | _map vs_ | _**8.55x**_ | _**1.25x**_ | _**4.25x**_ | _**4.25x**_ | _**1.90x**_ | _**1.30x**_ | _**6.08x**_ | _**4.19x**_ | _**4.19x**_ |
|  | umap | 0.00 | 0.03 | 70.6 | 72.2 | 0.01 | 0.01 | 0.01 | 70.6 | 72.2 |
| | _umap vs_ | _0.98x_ | _0.37x_ | _**4.26x**_ | _**4.26x**_ | _0.45x_ | _0.36x_ | _**1.12x**_ | _**4.20x**_ | _**4.20x**_ |
| 10K | kntrie | 0.25 | 0.90 | 131.4 | 13.5 | 0.26 | 0.39 | 0.27 | 130.9 | 13.4 |
|  | map | 0.95 | 1.39 | 703.1 | 72.0 | 0.67 | 0.69 | 1.04 | 703.1 | 72.0 |
| | _map vs_ | _**3.83x**_ | _**1.55x**_ | _**5.35x**_ | _**5.35x**_ | _**2.61x**_ | _**1.77x**_ | _**3.83x**_ | _**5.37x**_ | _**5.37x**_ |
|  | umap | 0.10 | 0.31 | 705.3 | 72.2 | 0.14 | 0.15 | 0.18 | 705.3 | 72.2 |
| | _umap vs_ | _0.42x_ | _0.34x_ | _**5.37x**_ | _**5.37x**_ | _0.57x_ | _0.37x_ | _0.66x_ | _**5.39x**_ | _**5.39x**_ |
| 100.0K | kntrie | 4.02 | 9.13 | 1290.0 | 13.2 | 2.92 | 4.64 | 4.32 | 1290.0 | 13.2 |
|  | map | 30.41 | 25.69 | 7031.0 | 72.0 | 15.10 | 16.81 | 32.57 | 7031.0 | 72.0 |
| | _map vs_ | _**7.57x**_ | _**2.81x**_ | _**5.45x**_ | _**5.45x**_ | _**5.17x**_ | _**3.62x**_ | _**7.53x**_ | _**5.45x**_ | _**5.45x**_ |
|  | umap | 2.46 | 5.22 | 7092.8 | 72.6 | 2.71 | 3.13 | 4.30 | 7092.8 | 72.6 |
| | _umap vs_ | _0.61x_ | _0.57x_ | _**5.50x**_ | _**5.50x**_ | _0.93x_ | _0.67x_ | _1.00x_ | _**5.50x**_ | _**5.50x**_ |

## uint64_t — sequential

| N | | F | I | M | B | E | C2 | F2 | M2 | B2 |
|---|-|---|---|---|---|---|----|----|----|----|
| 1K | kntrie | 0.01 | 0.12 | 18.0 | 18.4 | 0.03 | 0.04 | 0.01 | 19.2 | 19.6 |
|  | map | 0.02 | 0.11 | 70.3 | 72.0 | 0.06 | 0.05 | 0.01 | 70.3 | 72.0 |
| | _map vs_ | _**1.73x**_ | _0.93x_ | _**3.91x**_ | _**3.91x**_ | _**2.02x**_ | _**1.15x**_ | _0.96x_ | _**3.66x**_ | _**3.66x**_ |
|  | umap | 0.00 | 0.02 | 70.6 | 72.2 | 0.01 | 0.01 | 0.00 | 70.6 | 72.2 |
| | _umap vs_ | _0.28x_ | _0.18x_ | _**3.92x**_ | _**3.92x**_ | _0.18x_ | _0.27x_ | _0.35x_ | _**3.68x**_ | _**3.68x**_ |
| 10K | kntrie | 0.17 | 1.06 | 100.3 | 10.3 | 0.28 | 0.42 | 0.21 | 113.9 | 11.7 |
|  | map | 0.39 | 1.37 | 703.1 | 72.0 | 0.75 | 0.68 | 0.44 | 703.1 | 72.0 |
| | _map vs_ | _**2.31x**_ | _**1.30x**_ | _**7.01x**_ | _**7.01x**_ | _**2.66x**_ | _**1.64x**_ | _**2.06x**_ | _**6.17x**_ | _**6.17x**_ |
|  | umap | 0.03 | 0.17 | 705.3 | 72.2 | 0.06 | 0.11 | 0.08 | 705.3 | 72.2 |
| | _umap vs_ | _0.18x_ | _0.16x_ | _**7.03x**_ | _**7.03x**_ | _0.20x_ | _0.27x_ | _0.36x_ | _**6.19x**_ | _**6.19x**_ |
| 100K | kntrie | 1.84 | 6.65 | 982.5 | 10.1 | 3.03 | 3.84 | 2.26 | 1089.9 | 11.2 |
|  | map | 11.31 | 25.91 | 7031.2 | 72.0 | 13.82 | 14.66 | 10.72 | 7031.2 | 72.0 |
| | _map vs_ | _**6.15x**_ | _**3.89x**_ | _**7.16x**_ | _**7.16x**_ | _**4.56x**_ | _**3.82x**_ | _**4.75x**_ | _**6.45x**_ | _**6.45x**_ |
|  | umap | 1.05 | 1.97 | 7092.9 | 72.6 | 0.81 | 2.18 | 1.89 | 7092.9 | 72.6 |
| | _umap vs_ | _0.57x_ | _0.30x_ | _**7.22x**_ | _**7.22x**_ | _0.27x_ | _0.57x_ | _0.84x_ | _**6.51x**_ | _**6.51x**_ |

## int32_t — sequential

| N | | F | I | M | B | E | C2 | F2 | M2 | B2 |
|---|-|---|---|---|---|---|----|----|----|----|
| 1K | kntrie | 0.01 | 0.11 | 14.0 | 14.3 | 0.03 | 0.06 | 0.01 | 16.7 | 17.1 |
|  | map | 0.04 | 0.11 | 70.3 | 72.0 | 0.05 | 0.05 | 0.03 | 70.3 | 72.0 |
| | _map vs_ | _**3.42x**_ | _0.96x_ | _**5.02x**_ | _**5.02x**_ | _**1.76x**_ | _0.86x_ | _**2.46x**_ | _**4.22x**_ | _**4.22x**_ |
|  | umap | 0.00 | 0.02 | 70.6 | 72.2 | 0.01 | 0.01 | 0.00 | 70.6 | 72.2 |
| | _umap vs_ | _0.28x_ | _0.19x_ | _**5.04x**_ | _**5.04x**_ | _0.19x_ | _0.20x_ | _0.34x_ | _**4.23x**_ | _**4.23x**_ |
| 10K | kntrie | 0.09 | 0.91 | 100.1 | 10.3 | 0.20 | 0.39 | 0.11 | 103.9 | 10.6 |
|  | map | 0.92 | 1.40 | 703.1 | 72.0 | 0.68 | 0.67 | 0.94 | 703.1 | 72.0 |
| | _map vs_ | _**10.46x**_ | _**1.54x**_ | _**7.02x**_ | _**7.02x**_ | _**3.34x**_ | _**1.70x**_ | _**8.62x**_ | _**6.77x**_ | _**6.77x**_ |
|  | umap | 0.03 | 0.16 | 705.3 | 72.2 | 0.06 | 0.10 | 0.09 | 705.3 | 72.2 |
| | _umap vs_ | _0.32x_ | _0.17x_ | _**7.04x**_ | _**7.04x**_ | _0.27x_ | _0.26x_ | _0.80x_ | _**6.79x**_ | _**6.79x**_ |
| 100K | kntrie | 1.00 | 5.01 | 982.3 | 10.1 | 2.15 | 3.35 | 1.35 | 998.6 | 10.2 |
|  | map | 28.76 | 24.85 | 7031.2 | 72.0 | 15.03 | 15.00 | 28.44 | 7031.2 | 72.0 |
| | _map vs_ | _**28.83x**_ | _**4.96x**_ | _**7.16x**_ | _**7.16x**_ | _**6.99x**_ | _**4.48x**_ | _**21.11x**_ | _**7.04x**_ | _**7.04x**_ |
|  | umap | 1.04 | 2.01 | 7092.9 | 72.6 | 0.78 | 2.35 | 1.88 | 7092.9 | 72.6 |
| | _umap vs_ | _**1.05x**_ | _0.40x_ | _**7.22x**_ | _**7.22x**_ | _0.36x_ | _0.70x_ | _**1.40x**_ | _**7.10x**_ | _**7.10x**_ |

## Summary: uint64_t vs std::map

| N | Find | Insert | Erase | B/entry |
|---|------|--------|-------|--------|
| 1K | 1.5x–3x | SAME–1.25x | 1.75x–2x | 3x |
| 10K | 1.5x–2x | SAME–1.5x | 2x | 4x–7x |
| 100K | 2x–6x | 2x–3x | 4x | 4x–7x |

## Summary: int32_t vs std::map

| N | Find | Insert | Erase | B/entry |
|---|------|--------|-------|--------|
| 1K | 3x–8x | SAME | 1.75x | 4x–5x |
| 10K | 3x–10x | 1.5x | 2x–3x | 5x–7x |
| 100.0K | 7x–25x | 2x–4x | 5x–6x | 5x–7x |

